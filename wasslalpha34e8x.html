<!DOCTYPE html>
<html lang="ar" dir="rtl">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wassl - بوابتك الموثوقة في تركيا</title>
    <meta name="description"
        content="يقدم وصل خدمات شاملة تشمل العقارات، السياحة، التعليم، الرعاية الصحية، وحلول الأعمال في تركيا">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link
        href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;600;700&family=Inter:wght@300;400;500;600;700&display=swap"
        rel="stylesheet">

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-storage-compat.js"></script>

    <style>
        :root {
            --primary: #0f4c81;
            --primary-dark: #0a3a6b;
            --primary-light: #1a6bb3;
            --secondary: #d4af37;
            --secondary-dark: #b8941f;
            --accent: #e11d48;
            --dark: #1e293b;
            --dark-alt: #334155;
            --light: #f8fafc;
            --light-alt: #f1f5f9;
            --white: #ffffff;
            --text: #374151;
            --text-light: #64748b;
            --border: #e2e8f0;
            --shadow: 0 10px 25px rgba(0, 0, 0, 0.05);
            --shadow-lg: 0 20px 40px rgba(0, 0, 0, 0.1);
            --radius: 12px;
            --transition: all 0.3s ease;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Cairo', 'Arial', sans-serif;
            line-height: 1.7;
            color: var(--text);
            background-color: var(--light);
            overflow-x: hidden;
        }

        [dir="ltr"] body {
            font-family: 'Inter', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        /* Header */
        header {
            background: var(--white);
            box-shadow: var(--shadow);
            position: sticky;
            top: 0;
            z-index: 1000;
            transition: var(--transition);
        }

        header.scrolled {
            padding: 5px 0;
        }

        nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1.2rem 0;
            position: relative;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--primary);
            text-decoration: none;
            cursor: pointer;
            margin-left: 1rem;
        }

        [dir="ltr"] .logo {
            margin-left: 0;
            margin-right: 1rem;
        }

        .logo-icon {
            color: var(--secondary);
        }

        .nav-links {
            display: flex;
            gap: 2rem;
            list-style: none;
            align-items: center;
            margin-left: 2rem;
        }

        [dir="ltr"] .nav-links {
            margin-right: 0;
            margin-left: 2rem;
        }

        .nav-links a {
            color: var(--dark);
            text-decoration: none;
            font-weight: 500;
            transition: var(--transition);
            cursor: pointer;
            position: relative;
            padding: 5px 0;
        }

        .nav-links a:after {
            content: '';
            position: absolute;
            width: 0;
            height: 2px;
            bottom: 0;
            right: 0;
            background-color: var(--secondary);
            transition: var(--transition);
        }

        .nav-links a:hover {
            color: var(--primary);
        }

        .nav-links a:hover:after {
            width: 100%;
        }

        /* Active navigation item */
        .nav-links a.active {
            color: var(--primary);
            font-weight: 600;
        }

        .nav-links a.active:after {
            width: 100%;
        }

        /* Language Switch */
        .lang-switch {
            background: var(--primary);
            color: var(--white);
            border: none;
            padding: 0.6rem 1.2rem;
            border-radius: 30px;
            cursor: pointer;
            font-weight: 600;
            transition: var(--transition);
            min-width: 100px;
            text-align: center;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .lang-switch:hover {
            background: var(--primary-dark);
            transform: translateY(-2px);
        }

        .lang-switch-desktop {
            position: static;
            margin-right: 1rem;
        }

        [dir="ltr"] .lang-switch-desktop {
            margin-right: 0;
            margin-left: 1rem;
        }

        .lang-switch-li-mobile {
            display: none;
        }

        /* Updated Auth Buttons */
        .auth-buttons {
            display: flex;
            gap: 1rem;
            align-items: center;
        }

        .auth-btn {
            background: var(--primary);
            color: var(--white);
            border: none;
            padding: 0.6rem 1.2rem;
            border-radius: 30px;
            cursor: pointer;
            font-weight: 600;
            transition: var(--transition);
            font-size: 0.95rem;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .auth-btn:hover {
            background: var(--primary-dark);
            transform: translateY(-2px);
        }

        .auth-btn.secondary {
            background: transparent;
            color: var(--primary);
            border: 2px solid var(--primary);
        }

        .auth-btn.secondary:hover {
            background: var(--primary);
            color: var(--white);
        }

        .user-menu {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .user-greeting {
            font-weight: 500;
            color: var(--dark);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .user-role-badge {
            background: var(--secondary);
            color: var(--dark);
            padding: 0.2rem 0.8rem;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
        }

        /* Mobile Auth - Hidden by default */
        .mobile-auth {
            display: none;
        }

        /* Modals */
        .modal-overlay {
            position: fixed;
            top: 0;
            right: 0;
            left: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 2000;
            opacity: 0;
            visibility: hidden;
            transition: var(--transition);
        }

        .modal-overlay.active {
            opacity: 1;
            visibility: visible;
        }

        .modal {
            background: var(--white);
            border-radius: var(--radius);
            width: 90%;
            max-width: 500px;
            max-height: 90vh;
            overflow-y: auto;
            transform: translateY(20px);
            transition: var(--transition);
            box-shadow: var(--shadow-lg);
        }

        .modal-overlay.active .modal {
            transform: translateY(0);
        }

        .modal-header {
            padding: 1.5rem;
            border-bottom: 1px solid var(--border);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-header h2 {
            color: var(--dark);
            font-size: 1.5rem;
            font-weight: 600;
        }

        .modal-close {
            background: none;
            border: none;
            font-size: 1.2rem;
            color: var(--text-light);
            cursor: pointer;
            transition: var(--transition);
        }

        .modal-close:hover {
            color: var(--accent);
        }

        .modal-content {
            padding: 1.5rem;
        }

        .modal-footer {
            padding: 1rem 1.5rem;
            border-top: 1px solid var(--border);
            text-align: center;
        }

        .modal-footer a {
            color: var(--primary);
            text-decoration: none;
            font-weight: 500;
            cursor: pointer;
        }

        .modal-footer a:hover {
            text-decoration: underline;
        }

        /* Role Selection */
        .role-selection {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
            margin: 1.5rem 0;
        }

        .role-option {
            padding: 1.5rem;
            border: 2px solid var(--border);
            border-radius: var(--radius);
            text-align: center;
            cursor: pointer;
            transition: var(--transition);
        }

        .role-option:hover {
            border-color: var(--primary);
            transform: translateY(-2px);
        }

        .role-option.selected {
            border-color: var(--primary);
            background: var(--light);
        }

        .role-option i {
            font-size: 2rem;
            color: var(--primary);
            margin-bottom: 0.8rem;
        }

        .role-option h3 {
            font-size: 1.1rem;
            margin-bottom: 0.5rem;
            color: var(--dark);
        }

        .role-option p {
            font-size: 0.9rem;
            color: var(--text-light);
        }

        /* Product Grid */
        .products-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 2rem;
            margin-top: 3rem;
        }

        .product-card {
            background: var(--white);
            border-radius: var(--radius);
            overflow: hidden;
            box-shadow: var(--shadow);
            transition: var(--transition);
            border: 1px solid var(--border);
        }

        .product-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-lg);
        }

        .product-image {
            height: 200px;
            background: var(--light-alt);
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
        }

        .product-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .product-content {
            padding: 1.5rem;
        }

        .product-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 1rem;
        }

        .product-title {
            font-size: 1.3rem;
            font-weight: 600;
            color: var(--dark);
            margin-bottom: 0.5rem;
        }

        .product-category {
            display: inline-block;
            background: var(--light);
            color: var(--primary);
            padding: 0.3rem 0.8rem;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 500;
            margin-bottom: 1rem;
        }

        .product-description {
            color: var(--text);
            margin-bottom: 1.5rem;
            line-height: 1.6;
        }

        .product-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-top: 1px solid var(--border);
            padding-top: 1rem;
        }

        .product-price {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary);
        }

        .product-actions {
            display: flex;
            gap: 0.5rem;
        }

        .favorite-btn {
            background: none;
            border: none;
            font-size: 1.2rem;
            color: var(--text-light);
            cursor: pointer;
            transition: var(--transition);
        }

        .favorite-btn:hover {
            color: var(--accent);
        }

        .favorite-btn.favorited {
            color: var(--accent);
        }

        .delete-btn {
            background: var(--accent);
            color: var(--white);
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: var(--transition);
        }

        .delete-btn:hover {
            background: #c10e38;
        }

        /* Dashboard */
        .dashboard-section {
            display: none;
            padding: 2rem 0 6rem;
            min-height: 80vh;
        }

        .dashboard-section.active {
            display: block;
            animation: fadeInUp 0.5s ease;
        }

        .dashboard-header {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            color: var(--white);
            padding: 4rem 0;
            text-align: center;
            margin-bottom: 3rem;
        }

        .dashboard-header h1 {
            font-size: 2.5rem;
            margin-bottom: 1rem;
            font-weight: 700;
        }

        .dashboard-content {
            display: grid;
            grid-template-columns: 1fr 2fr;
            gap: 3rem;
        }

        .dashboard-sidebar {
            background: var(--white);
            padding: 2rem;
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            border: 1px solid var(--border);
        }

        .dashboard-stats {
            display: grid;
            gap: 1.5rem;
        }

        .stat-card {
            background: var(--light);
            padding: 1.5rem;
            border-radius: var(--radius);
            text-align: center;
        }

        .stat-number {
            font-size: 2rem;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 0.5rem;
        }

        .stat-label {
            color: var(--text-light);
            font-size: 0.9rem;
        }

        .dashboard-main {
            background: var(--white);
            padding: 2rem;
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            border: 1px solid var(--border);
        }

        .section-title {
            text-align: center;
            font-size: 2.8rem;
            color: var(--dark);
            margin-bottom: 1rem;
            font-weight: 700;
        }

        .section-subtitle {
            text-align: center;
            font-size: 1.2rem;
            color: var(--text-light);
            margin-bottom: 4rem;
            max-width: 600px;
            margin-right: auto;
            margin-left: auto;
        }

        /* File Upload */
        .file-upload {
            position: relative;
            margin-bottom: 1.8rem;
        }

        .file-upload input[type="file"] {
            display: none;
        }

        .file-upload-label {
            display: block;
            padding: 1rem;
            border: 2px dashed var(--border);
            border-radius: 8px;
            text-align: center;
            cursor: pointer;
            transition: var(--transition);
        }

        .file-upload-label:hover {
            border-color: var(--primary);
            background: var(--light);
        }

        .file-upload-label i {
            font-size: 2rem;
            color: var(--primary);
            margin-bottom: 0.5rem;
            display: block;
        }

        .file-preview {
            margin-top: 1rem;
            text-align: center;
        }

        .file-preview img {
            max-width: 100%;
            max-height: 150px;
            border-radius: 8px;
        }

        /* Hero Section - Keep original styles */
        .hero {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            color: var(--white);
            padding: 8rem 0 6rem;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .hero:before {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            left: 0;
            bottom: 0;
            background: url("data:image/svg+xml,%3Csvg width='100' height='100' viewBox='0 0 100 100' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M11 18c3.866 0 7-3.134 7-7s-3.134-7-7-7-7 3.134-7 7 3.134 7 7 7zm48 25c3.866 0 7-3.134 7-7s-3.134-7-7-7-7 3.134-7 7 3.134 7 7 7zm-43-7c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zm63 31c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zM34 90c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zm56-76c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zM12 86c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm28-65c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm23-11c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm-6 60c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm29 22c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zM32 63c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm57-13c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm-9-21c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM60 91c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM35 41c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM12 60c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2z' fill='%23ffffff' fill-opacity='0.05' fill-rule='evenodd'/%3E%3C/svg%3E");
        }

        .hero-content {
            position: relative;
            z-index: 1;
            max-width: 800px;
            margin: 0 auto;
        }

        .hero h1 {
            font-size: 3.5rem;
            margin-bottom: 1.5rem;
            font-weight: 700;
            line-height: 1.2;
        }

        .hero p {
            font-size: 1.3rem;
            margin-bottom: 2.5rem;
            opacity: 0.95;
            line-height: 1.6;
        }

        .cta-button {
            display: inline-flex;
            align-items: center;
            gap: 10px;
            background: var(--secondary);
            color: var(--dark);
            padding: 1.2rem 2.5rem;
            text-decoration: none;
            border-radius: 50px;
            font-weight: 600;
            font-size: 1.1rem;
            transition: var(--transition);
            box-shadow: 0 4px 15px rgba(212, 175, 55, 0.3);
            border: none;
            cursor: pointer;
        }

        .cta-button:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(212, 175, 55, 0.4);
            background: var(--secondary-dark);
        }

        /* Services Section */
        .services {
            padding: 6rem 0;
            background: var(--white);
        }

        .services-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 2.5rem;
        }

        .service-card {
            background: var(--white);
            padding: 2.5rem;
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            transition: var(--transition);
            text-align: center;
            cursor: pointer;
            display: flex;
            flex-direction: column;
            height: 100%;
            position: relative;
            overflow: hidden;
            border: 1px solid var(--border);
        }

        .service-card:before {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            left: 0;
            height: 4px;
            background: linear-gradient(90deg, var(--primary), var(--secondary));
        }

        .service-card:hover {
            transform: translateY(-10px);
            box-shadow: var(--shadow-lg);
        }

        .service-icon {
            font-size: 3.5rem;
            color: var(--primary);
            margin-bottom: 1.5rem;
            background: var(--light);
            width: 90px;
            height: 90px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            margin-right: auto;
            margin-left: auto;
            transition: var(--transition);
        }

        .service-card:hover .service-icon {
            transform: scale(1.1);
            background: var(--primary);
            color: var(--white);
        }

        .service-card h3 {
            color: var(--dark);
            margin-bottom: 1.2rem;
            font-size: 1.6rem;
            font-weight: 600;
        }

        .service-card p {
            color: var(--text);
            line-height: 1.7;
            flex-grow: 1;
            margin-bottom: 1.8rem;
        }

        .service-link {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            background: var(--primary);
            color: var(--white);
            padding: 0.9rem 1.8rem;
            text-decoration: none;
            border-radius: 30px;
            font-weight: 500;
            transition: var(--transition);
            margin-top: auto;
            cursor: pointer;
            border: 2px solid var(--primary);
        }

        .service-link:hover {
            background: transparent;
            color: var(--primary);
        }

        /* About Section */
        .about {
            padding: 6rem 0;
            background: var(--light-alt);
        }

        .about-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 4rem;
            align-items: center;
        }

        .about-text h2 {
            font-size: 2.8rem;
            color: var(--dark);
            margin-bottom: 1.5rem;
            font-weight: 700;
        }

        .about-text p {
            font-size: 1.1rem;
            line-height: 1.8;
            margin-bottom: 1.5rem;
            color: var(--text);
        }

        .about-image {
            text-align: center;
            position: relative;
        }

        .about-image img {
            max-width: 100%;
            border-radius: var(--radius);
            box-shadow: var(--shadow-lg);
        }

        .stats {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 2rem;
            margin-top: 3rem;
        }

        .stat-item {
            text-align: center;
            padding: 1.5rem;
            background: var(--white);
            border-radius: var(--radius);
            box-shadow: var(--shadow);
        }

        .stat-number {
            font-size: 2.5rem;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 0.5rem;
        }

        .stat-text {
            font-size: 1rem;
            color: var(--text-light);
            font-weight: 500;
        }

        /* Appointments Section */
        .appointments {
            padding: 6rem 0;
            background: var(--white);
        }

        .appointment-form {
            max-width: 700px;
            margin: 0 auto;
            background: var(--white);
            padding: 3rem;
            border-radius: var(--radius);
            box-shadow: var(--shadow-lg);
            border: 1px solid var(--border);
        }

        .form-group {
            margin-bottom: 1.8rem;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.6rem;
            color: var(--dark);
            font-weight: 600;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 1rem;
            border: 2px solid var(--border);
            border-radius: 8px;
            font-size: 1rem;
            transition: var(--transition);
            font-family: inherit;
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(15, 76, 129, 0.1);
        }

        .form-group textarea {
            resize: vertical;
            min-height: 120px;
        }

        .submit-btn {
            width: 100%;
            background: var(--primary);
            color: var(--white);
            padding: 1.2rem;
            border: none;
            border-radius: 8px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .submit-btn:hover {
            background: var(--primary-dark);
            transform: translateY(-2px);
        }

        .submit-btn:disabled {
            background: var(--text-light);
            cursor: not-allowed;
        }

        .success-message {
            display: none;
            background: #10b981;
            color: var(--white);
            padding: 1.2rem;
            border-radius: 8px;
            margin-top: 1.5rem;
            text-align: center;
        }

        .error-message {
            display: none;
            background: #ef4444;
            color: var(--white);
            padding: 1.2rem;
            border-radius: 8px;
            margin-top: 1.5rem;
            text-align: center;
        }

        /* Contact Section */
        .contact {
            padding: 6rem 0;
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            color: var(--white);
        }

        .contact-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 3rem;
            text-align: center;
        }

        .contact-item {
            padding: 2.5rem 1.5rem;
            background: rgba(255, 255, 255, 0.1);
            border-radius: var(--radius);
            backdrop-filter: blur(10px);
            transition: var(--transition);
        }

        .contact-item:hover {
            transform: translateY(-5px);
            background: rgba(255, 255, 255, 0.15);
        }

        .contact-icon {
            font-size: 3rem;
            color: var(--secondary);
            margin-bottom: 1.5rem;
        }

        .contact-item h3 {
            margin-bottom: 1rem;
            font-size: 1.4rem;
        }

        .contact-item p {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        /* Footer */
        footer {
            background: var(--dark);
            color: var(--white);
            padding: 4rem 0 2rem;
        }

        .footer-content {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 3rem;
            margin-bottom: 3rem;
        }

        .footer-logo {
            font-size: 2rem;
            font-weight: 700;
            color: var(--white);
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .footer-about p {
            margin-bottom: 1.5rem;
            opacity: 0.8;
            line-height: 1.7;
        }

        .footer-links h3,
        .footer-services h3 {
            font-size: 1.3rem;
            margin-bottom: 1.5rem;
            color: var(--white);
        }

        .footer-links ul,
        .footer-services ul {
            list-style: none;
        }

        .footer-links li,
        .footer-services li {
            margin-bottom: 0.8rem;
        }

        .footer-links a,
        .footer-services a {
            color: rgba(255, 255, 255, 0.7);
            text-decoration: none;
            transition: var(--transition);
        }

        .footer-links a:hover,
        .footer-services a:hover {
            color: var(--secondary);
            padding-right: 5px;
        }

        .footer-bottom {
            text-align: center;
            padding-top: 2rem;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }

        .footer-text {
            opacity: 0.7;
        }

        /* Animations */
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Mobile Menu */
        .mobile-menu-btn {
            display: none;
            background: none;
            border: none;
            font-size: 1.5rem;
            color: var(--dark);
            cursor: pointer;
            z-index: 1002;
        }

        /* WhatsApp FAB */
        .whatsapp-fab {
            position: fixed;
            bottom: 30px;
            left: 30px;
            background-color: #25D366;
            color: var(--white);
            width: 65px;
            height: 65px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2.8rem;
            text-decoration: none;
            box-shadow: 0 6px 20px rgba(37, 211, 102, 0.4);
            z-index: 1001;
            transition: var(--transition);
        }

        .whatsapp-fab:hover {
            transform: scale(1.1);
            box-shadow: 0 8px 25px rgba(37, 211, 102, 0.5);
        }

        /* Service Pages */
        .service-page {
            display: none;
            padding: 2rem 0 6rem;
            min-height: 80vh;
        }

        .service-page.active {
            display: block;
            animation: fadeInUp 0.5s ease;
        }

        .service-header {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            color: var(--white);
            padding: 4rem 0;
            text-align: center;
            margin-bottom: 4rem;
        }

        .service-header h1 {
            font-size: 3rem;
            margin-bottom: 1rem;
            font-weight: 700;
        }

        .service-header p {
            font-size: 1.3rem;
            max-width: 700px;
            margin: 0 auto;
            opacity: 0.9;
        }

        .service-content {
            background: var(--white);
            padding: 3rem;
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            margin-bottom: 3rem;
            border: 1px solid var(--border);
        }

        .service-content h2 {
            color: var(--primary);
            margin-bottom: 1.5rem;
            font-size: 2rem;
            font-weight: 600;
            padding-bottom: 0.5rem;
            border-bottom: 2px solid var(--secondary);
            display: inline-block;
        }

        .service-content p {
            margin-bottom: 1.5rem;
            line-height: 1.8;
        }

        .service-content ul {
            margin-bottom: 1.5rem;
            padding-right: 1.5rem;
        }

        .service-content li {
            margin-bottom: 0.8rem;
            position: relative;
        }

        .service-content li:before {
            content: '✓';
            color: var(--secondary);
            font-weight: bold;
            position: absolute;
            right: -1.5rem;
        }

        .service-form {
            background: var(--white);
            padding: 2.5rem;
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            border: 1px solid var(--border);
        }

        .service-form h2 {
            color: var(--primary);
            margin-bottom: 1.5rem;
            font-size: 1.8rem;
            font-weight: 600;
        }

        /* Remove back button */
        .back-button {
            display: none;
        }

        /* Service Tabs Navigation */
        .service-tabs {
            display: flex;
            justify-content: center;
            gap: 1rem;
            margin-bottom: 3rem;
            flex-wrap: wrap;
            border-bottom: 2px solid var(--border);
            padding-bottom: 1rem;
        }

        .service-tab {
            background: var(--white);
            color: var(--text);
            border: 2px solid var(--border);
            padding: 0.8rem 1.5rem;
            border-radius: 30px;
            font-weight: 500;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .service-tab:hover {
            border-color: var(--primary);
            color: var(--primary);
        }

        .service-tab.active {
            background: var(--primary);
            color: var(--white);
            border-color: var(--primary);
        }

        .service-tab i {
            font-size: 1.1rem;
        }

        /* Service Navigation Links */
        .service-nav-links {
            display: flex;
            gap: 1rem;
            margin: 2rem 0;
            flex-wrap: wrap;
        }

        .service-nav-link {
            background: var(--light);
            color: var(--primary);
            padding: 0.6rem 1.2rem;
            border-radius: 30px;
            text-decoration: none;
            font-weight: 500;
            transition: var(--transition);
            border: 2px solid transparent;
        }

        .service-nav-link:hover {
            background: var(--primary);
            color: var(--white);
            transform: translateY(-2px);
        }

        /* Empty State */
        .empty-state {
            text-align: center;
            padding: 4rem 2rem;
            color: var(--text-light);
        }

        .empty-state i {
            font-size: 4rem;
            margin-bottom: 1.5rem;
            opacity: 0.5;
        }

        .empty-state h3 {
            font-size: 1.5rem;
            margin-bottom: 1rem;
            color: var(--dark);
        }

        /* Toast Notification */
        .toast {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: var(--primary);
            color: white;
            padding: 1rem 2rem;
            border-radius: var(--radius);
            box-shadow: var(--shadow-lg);
            z-index: 3000;
            animation: slideDown 0.3s ease;
        }

        .toast.error {
            background: var(--accent);
        }

        .toast.success {
            background: #10b981;
        }

        @keyframes slideDown {
            from {
                transform: translateX(-50%) translateY(-20px);
                opacity: 0;
            }

            to {
                transform: translateX(-50%) translateY(0);
                opacity: 1;
            }
        }

        @keyframes slideUp {
            from {
                transform: translateX(-50%) translateY(0);
                opacity: 1;
            }

            to {
                transform: translateX(-50%) translateY(-20px);
                opacity: 0;
            }
        }

        /* Responsive */
        @media (max-width: 1024px) {
            .hero h1 {
                font-size: 3rem;
            }

            .about-content {
                gap: 3rem;
            }

            .dashboard-content {
                grid-template-columns: 1fr;
            }
        }

        /* Tablet-specific styles (768px - 1024px) */
        @media (min-width: 768px) and (max-width: 1024px) {
            .container {
                padding: 0 1.5rem;
            }

            /* Header & Navigation - Two-row layout for tablets */
            nav {
                display: grid;
                grid-template-columns: auto 1fr auto auto;
                grid-template-rows: auto auto;
                gap: 0.5rem 1rem;
                align-items: center;
                padding: 0.8rem 0;
            }

            .logo {
                font-size: 1.6rem;
                grid-column: 1;
                grid-row: 1;
            }

            /* Nav links on second row, centered */
            .nav-links {
                grid-column: 1 / -1;
                grid-row: 2;
                justify-content: center;
                gap: 0.3rem;
                padding-top: 0.5rem;
                border-top: 1px solid var(--border);
                margin-top: 0.3rem;
            }

            .nav-links a {
                font-size: 0.85rem;
                padding: 0.4rem 0.8rem;
                border-radius: 20px;
                transition: var(--transition);
            }

            .nav-links a:hover,
            .nav-links a.active {
                background: var(--light);
            }

            /* Hide mobile menu button on tablet */
            .mobile-menu-btn {
                display: none;
            }

            /* Language Switch - positioned on first row */
            .lang-switch {
                padding: 0.5rem 1rem;
                font-size: 0.85rem;
                min-width: auto;
            }

            .lang-switch-desktop {
                grid-column: 4;
                grid-row: 1;
                margin: 0;
            }

            [dir="ltr"] .lang-switch-desktop {
                margin: 0;
            }

            /* Auth Buttons - positioned on first row */
            .auth-buttons {
                grid-column: 3;
                grid-row: 1;
                gap: 0.5rem;
                justify-content: flex-end;
            }

            .auth-buttons .auth-btn {
                padding: 0.5rem 1rem;
                font-size: 0.85rem;
                gap: 6px;
            }

            .auth-btn i {
                font-size: 0.9rem;
            }

            /* User Menu - positioned on first row */
            .user-menu {
                grid-column: 3;
                grid-row: 1;
                gap: 0.8rem;
                flex-wrap: nowrap;
            }

            .user-greeting {
                font-size: 0.9rem;
                gap: 6px;
            }

            .user-role-badge {
                font-size: 0.75rem;
                padding: 0.2rem 0.6rem;
            }

            .user-menu .auth-btn {
                padding: 0.5rem 1rem;
                font-size: 0.85rem;
            }

            /* Hero Section */
            .hero {
                padding: 7rem 0 5rem;
            }

            .hero h1 {
                font-size: 2.8rem;
            }

            .hero p {
                font-size: 1.1rem;
                max-width: 90%;
            }

            /* Services Grid - 2 columns on tablet */
            .services-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 1.5rem;
            }

            .service-card {
                padding: 2rem;
            }

            .service-card i {
                font-size: 2.5rem;
            }

            .service-card h3 {
                font-size: 1.3rem;
            }

            /* Service Tabs - horizontal scroll on tablet */
            .service-tabs {
                flex-wrap: nowrap;
                overflow-x: auto;
                -webkit-overflow-scrolling: touch;
                scrollbar-width: none;
                padding-bottom: 0.5rem;
            }

            .service-tabs::-webkit-scrollbar {
                display: none;
            }

            .service-tab {
                min-width: auto;
                padding: 0.8rem 1.2rem;
                font-size: 0.9rem;
            }

            /* About Section */
            .about-content {
                grid-template-columns: 1fr;
                text-align: center;
            }

            .about-image {
                max-width: 400px;
                margin: 0 auto;
            }

            .stats {
                grid-template-columns: repeat(3, 1fr);
                gap: 1rem;
            }

            .stat-item {
                padding: 1rem;
            }

            /* Products Grid - 2 columns on tablet */
            .products-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 1.5rem;
            }

            .product-card {
                padding: 1rem;
            }

            /* Forms */
            .service-form {
                padding: 2rem;
            }

            .appointment-form {
                padding: 2.5rem;
            }

            .form-group {
                margin-bottom: 1.2rem;
            }

            /* Dashboard */
            .dashboard-content {
                gap: 1.5rem;
            }

            .dashboard-sidebar {
                padding: 1.5rem;
            }

            .dashboard-main {
                padding: 1.5rem;
            }

            /* Role Selection - side by side on tablet */
            .role-selection {
                grid-template-columns: repeat(2, 1fr);
                gap: 1rem;
            }

            .role-option {
                padding: 1.5rem;
            }

            /* Modal adjustments */
            .modal {
                max-width: 500px;
                margin: 1rem;
            }

            /* Section titles */
            .section-title {
                font-size: 2.2rem;
            }

            .section-subtitle {
                font-size: 1rem;
            }

            /* Contact info */
            .contact-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (max-width: 768px) {
            .nav-links {
                display: none;
                position: fixed;
                top: 0;
                right: 0;
                left: 0;
                bottom: 0;
                background: var(--white);
                flex-direction: column;
                padding: 5rem 2rem;
                box-shadow: var(--shadow-lg);
                z-index: 1000;
                overflow-y: auto;
                margin: 0 !important;
            }

            .nav-links.active {
                display: flex;
            }

            .mobile-menu-btn {
                display: block;
            }

            .auth-buttons {
                display: none;
            }

            .mobile-auth {
                display: flex;
                flex-direction: column;
                gap: 1rem;
                margin-top: 2rem;
            }

            .lang-switch-desktop {
                display: none;
            }

            .lang-switch-li-mobile {
                display: list-item;
            }

            .hero {
                padding: 6rem 0 4rem;
            }

            .hero h1 {
                font-size: 2.5rem;
            }

            .hero p {
                font-size: 1.1rem;
            }

            .section-title {
                font-size: 2.2rem;
            }

            .about-content {
                grid-template-columns: 1fr;
            }

            .services-grid {
                grid-template-columns: 1fr;
            }

            .whatsapp-fab {
                width: 55px;
                height: 55px;
                font-size: 2.2rem;
                bottom: 20px;
                left: 20px;
            }

            .service-content,
            .service-form {
                padding: 2rem;
            }

            .service-header h1 {
                font-size: 2.5rem;
            }

            .stats {
                grid-template-columns: 1fr;
            }

            .products-grid {
                grid-template-columns: 1fr;
            }

            .role-selection {
                grid-template-columns: 1fr;
            }

            .service-tabs {
                flex-direction: column;
                align-items: center;
            }

            .service-tab {
                width: 100%;
                max-width: 300px;
                justify-content: center;
            }
        }

        @media (max-width: 480px) {
            .hero h1 {
                font-size: 2rem;
            }

            .service-header h1 {
                font-size: 2rem;
            }

            .section-title {
                font-size: 1.8rem;
            }

            .service-content,
            .service-form {
                padding: 1.5rem;
            }

            .appointment-form {
                padding: 2rem;
            }

            /* ============================================ */
            /* NEW DASHBOARD CSS */
            /* ============================================ */

            .service-categories {
                display: flex;
                flex-direction: column;
                gap: 0.5rem;
                margin-top: 1rem;
            }

            .service-categories .service-nav-link {
                display: flex;
                align-items: center;
                gap: 8px;
                text-align: right;
                justify-content: flex-start;
                background: var(--light);
                color: var(--primary);
                padding: 0.6rem 1.2rem;
                border-radius: 30px;
                text-decoration: none;
                font-weight: 500;
                transition: var(--transition);
                border: 2px solid transparent;
                cursor: pointer;
                width: 100%;
            }

            .service-categories .service-nav-link:hover {
                background: var(--primary);
                color: var(--white);
                transform: translateY(-2px);
            }

            .service-categories .service-nav-link.active {
                background: var(--primary);
                color: var(--white);
                border-color: var(--primary);
            }

            .dashboard-sidebar .auth-btn.secondary {
                background: transparent;
                color: var(--primary);
                border: 2px solid var(--primary);
            }

            .dashboard-sidebar .auth-btn.secondary:hover {
                background: var(--primary);
                color: var(--white);
            }

            /* User role badge colors */
            .user-role-badge {
                background: var(--secondary);
                color: var(--dark);
                padding: 0.2rem 0.8rem;
                border-radius: 20px;
                font-size: 0.8rem;
                font-weight: 600;
            }

            #user-role-badge-business {
                background: #10b981;
                /* Green for business */
            }

            #user-role-badge-customer {
                background: #3b82f6;
                /* Blue for customer */
            }
        }
    </style>
</head>

<body>
    <!-- Main Navigation -->
    <header id="main-header">
        <div class="container">
            <nav>
                <a class="logo" onclick="navigateTo('home')">
                    <i class="fas fa-handshake logo-icon"></i>
                    <span data-key="logo">وصل</span>
                </a>
                <button class="mobile-menu-btn" onclick="toggleMenu()">
                    <i class="fas fa-bars"></i>
                </button>
                <ul class="nav-links" id="navLinks">
                    <li><a onclick="navigateTo('home')" class="nav-home active" data-key="navHome">الرئيسية</a></li>
                    <li><a onclick="navigateTo('services')" class="nav-services" data-key="navServices">الخدمات</a></li>
                    <li><a onclick="navigateTo('home#about')" class="nav-about" data-key="navAbout">من نحن</a></li>
                    <li><a onclick="navigateTo('home#appointments')" class="nav-appointments"
                            data-key="navAppointments">المواعيد</a></li>
                    <li><a onclick="navigateTo('home#contact')" class="nav-contact" data-key="navContact">اتصل بنا</a>
                    </li>

                    <!-- Dynamic Auth Links (Mobile) -->
                    <div class="mobile-auth" id="mobileAuth">
                        <!-- Will be populated by JavaScript -->
                    </div>

                    <li class="lang-switch-li-mobile">
                        <button class="lang-switch" onclick="toggleLanguage()">
                            <i class="fas fa-globe"></i>
                            <span data-key="langBtn">English</span>
                        </button>
                    </li>
                </ul>

                <!-- Dynamic Auth Buttons (Desktop) -->
                <div class="auth-buttons" id="authButtons">
                    <!-- Will be populated by JavaScript -->
                </div>

                <button class="lang-switch lang-switch-desktop" onclick="toggleLanguage()">
                    <i class="fas fa-globe"></i>
                    <span data-key="langBtn">English</span>
                </button>
            </nav>
        </div>
    </header>

    <!-- Home Page -->
    <section id="home-page" class="service-page active">
        <div class="hero" id="home">
            <div class="container">
                <div class="hero-content">
                    <h1 class="hero-title" data-key="heroTitle">بوابتك الموثوقة في تركيا</h1>
                    <p class="hero-subtitle" data-key="heroSubtitle">خدمات شاملة للعقارات، السياحة، التعليم، الرعاية
                        الصحية، وحلول الأعمال. متمركزون في بولو، نخدم جميع أنحاء تركيا بتميز وموثوقية.</p>
                    <button onclick="navigateTo('services')" class="cta-button cta-text">
                        <span data-key="ctaText">ابدأ رحلتك</span>
                        <i class="fas fa-arrow-left"></i>
                    </button>
                </div>
            </div>
        </div>

        <!-- Latest Opportunities Section (New) -->
        <section id="latest-opportunities" style="padding: 4rem 0; background: #f8fafc;">
            <div class="container">
                <div style="display: flex; justify-content: space-between; align-items: flex-end; margin-bottom: 2rem;">
                    <div>
                        <h2 class="section-title" data-key="latestOppTitle"
                            style="margin-bottom: 0.5rem; text-align: right;">Latest Opportunities</h2>
                        <p class="section-subtitle" data-key="latestOppSubtitle" style="text-align: right;">Fresh
                            listings just for you</p>
                    </div>
                    <button onclick="navigateTo('real-estate')" class="auth-btn secondary"
                        style="border-radius: 30px; padding: 0.5rem 1.5rem;">
                        <span data-key="seeAllBtn">See All</span>
                        <i class="fas fa-arrow-left"></i>
                    </button>
                </div>

                <div class="products-grid" id="latest-opportunities-grid"
                    style="grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));">
                    <!-- Loaded via JS -->
                    <div class="loading-spinner"><i class="fas fa-spinner fa-spin"></i> Loading...</div>
                </div>
            </div>
        </section>

        <section class="services" id="services">
            <div class="container">
                <h2 class="section-title services-title" data-key="servicesTitle">خدماتنا المتميزة</h2>
                <p class="section-subtitle services-subtitle" data-key="servicesSubtitle">حلول شاملة مصممة خصيصاً
                    لاحتياجاتك في تركيا، مقدمة بخبرة وتفانٍ</p>
                <div class="services-grid">
                    <div class="service-card" data-service="real-estate">
                        <div class="service-icon"><i class="fas fa-building"></i></div>
                        <h3 class="service1-title" data-key="service1Title">الخدمات العقارية</h3>
                        <p class="service1-desc" data-key="service1Desc">اعثر على عقار أحلامك في أكثر المواقع المرغوبة
                            في تركيا. نقدم عقارات سكنية وتجارية حصرية للبيع والإيجار مع خدمة متميزة.</p>
                        <button onclick="navigateTo('real-estate')" class="service-link service1-link">
                            <span data-key="service1Link">اكتشف العقارات</span>
                            <i class="fas fa-arrow-left"></i>
                        </button>
                    </div>
                    <div class="service-card" data-service="tourism">
                        <div class="service-icon"><i class="fas fa-plane"></i></div>
                        <h3 class="service2-title" data-key="service2Title">الخدمات السياحية</h3>
                        <p class="service2-desc" data-key="service2Desc">اختبر جمال تركيا الأخاذ مع باقاتنا السياحية
                            المختارة بعناية. خطط سفر مخصصة وإقامات فاخرة لرحلات لا تُنسى.</p>
                        <button onclick="navigateTo('tourism')" class="service-link service2-link">
                            <span data-key="service2Link">استكشف تركيا</span>
                            <i class="fas fa-arrow-left"></i>
                        </button>
                    </div>
                    <div class="service-card" data-service="student">
                        <div class="service-icon"><i class="fas fa-graduation-cap"></i></div>
                        <h3 class="service3-title" data-key="service3Title">الخدمات الطلابية</h3>
                        <p class="service3-desc" data-key="service3Desc">تنقل في نظام التعليم التركي بإرشاد خبرائنا. من
                            تقديم طلبات الجامعة إلى ترتيب السكن، نضمن رحلتك الأكاديمية سلسة وبلا متاعب.</p>
                        <button onclick="navigateTo('student')" class="service-link service3-link">
                            <span data-key="service3Link">ابدأ رحلتك</span>
                            <i class="fas fa-arrow-left"></i>
                        </button>
                    </div>
                    <div class="service-card" data-service="medical">
                        <div class="service-icon"><i class="fas fa-heartbeat"></i></div>
                        <h3 class="service4-title" data-key="service4Title">الخدمات العلاجية</h3>
                        <p class="service4-desc" data-key="service4Desc">الوصول إلى نظام الرعاية الصحية العالمي في تركيا
                            مع خدمات السياحة العلاجية المتميزة لدينا. أفضل المستشفيات، علاجات متخصصة، ورعاية شاملة.</p>
                        <button onclick="navigateTo('medical')" class="service-link service4-link">
                            <span data-key="service4Link">ابحث عن العلاج</span>
                            <i class="fas fa-arrow-left"></i>
                        </button>
                    </div>
                    <div class="service-card" data-service="business">
                        <div class="service-icon"><i class="fas fa-briefcase"></i></div>
                        <h3 class="service5-title" data-key="service5Title">خدمات الأعمال</h3>
                        <p class="service5-desc" data-key="service5Desc">أطلق أو وسع عملك في تركيا مع استشاراتنا
                            المهنية. تسجيل الشركات، تحليل الأسواق، والتخطيط الاستراتيجي للنجاح.</p>
                        <button onclick="navigateTo('business')" class="service-link service5-link">
                            <span data-key="service5Link">نَمِ بأعمالك</span>
                            <i class="fas fa-arrow-left"></i>
                        </button>
                    </div>
                    <div class="service-card" data-service="other">
                        <div class="service-icon"><i class="fas fa-hands-helping"></i></div>
                        <h3 class="service6-title" data-key="service6Title">خدمات إضافية</h3>
                        <p class="service6-desc" data-key="service6Desc">دعم شامل يشمل الخدمات القانونية، الترجمة،
                            تصاريح الإقامة، التأمين، والنقل لجعل حياتك في تركيا خالية من المتاعب.</p>
                        <button onclick="navigateTo('other')" class="service-link service6-link">
                            <span data-key="service6Link">عرض جميع الخدمات</span>
                            <i class="fas fa-arrow-left"></i>
                        </button>
                    </div>
                </div>
            </div>
        </section>

        <section class="about" id="about">
            <div class="container">
                <div class="about-content">
                    <div class="about-text">
                        <h2 class="about-title" data-key="aboutTitle">شريكك الموثوق في تركيا</h2>
                        <p class="about-p1" data-key="aboutP1">وصل هو مزود الخدمات المتميز الخاص بك، بمقر رئيسي في بولو
                            ووصول على مستوى تركيا. مع سنوات من الخبرة المتخصصة، نتفوق في ربط الأفراد والشركات بالخدمات
                            المتميزة التي يحتاجونها عبر تركيا.</p>
                        <p class="about-p2" data-key="aboutP2">سواء كنت تبحث عن استثمارات عقارية، تخطط لعطلة تركية لا
                            تُنسى، تتطلع إلى فرص تعليمية، تحتاج إلى علاجات طبية، أو توسيع مشاريعك التجارية، نقدم تجارب
                            سلسة وخالية من المتاعب.</p>
                        <p class="about-p3" data-key="aboutP3">فريقنا المتفاني من محترفي الصناعة ملتزم بتقديم خدمة
                            استثنائية، وبناء علاقات دائمة، وضمان رضاك التام مع كل تفاعل.</p>

                        <div class="stats">
                            <div class="stat-item">
                                <div class="stat-number">500+</div>
                                <div class="stat-text" data-key="statText1">عملاء سعداء</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-number">7+</div>
                                <div class="stat-text" data-key="statText2">سنوات خبرة</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-number">24/7</div>
                                <div class="stat-text" data-key="statText3">دعم عملاء</div>
                            </div>
                        </div>
                    </div>
                    <div class="about-image">
                        <div
                            style="width: 100%; height: 400px; background: linear-gradient(135deg, var(--primary-light) 0%, var(--primary) 100%); border-radius: var(--radius); display: flex; align-items: center; justify-content: center; color: white; font-size: 1.2rem;">
                            <i class="fas fa-users" style="font-size: 5rem; opacity: 0.7;"></i>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section class="appointments" id="appointments">
            <div class="container">
                <h2 class="section-title appointments-title" data-key="appointmentsTitle">جدول استشارتك</h2>
                <p class="section-subtitle appointments-subtitle" data-key="appointmentsSubtitle">دعنا نناقش كيف يمكننا
                    مساعدتك في تحقيق أهدافك في تركيا</p>
                <form class="appointment-form" id="appointmentForm">
                    <div class="form-group">
                        <label for="name" class="label-name" data-key="labelName">الاسم الكامل</label>
                        <input type="text" id="name" name="name" required>
                    </div>
                    <div class="form-group">
                        <label for="email" class="label-email" data-key="labelEmail">البريد الإلكتروني</label>
                        <input type="email" id="email" name="email" required>
                    </div>
                    <div class="form-group">
                        <label for="phone" class="label-phone" data-key="labelPhone">رقم الهاتف</label>
                        <input type="tel" id="phone" name="phone" required>
                    </div>
                    <div class="form-group">
                        <label for="service" class="label-service" data-key="labelService">الخدمة المطلوبة</label>
                        <select id="service" name="service" required>
                            <option value="" class="option-select" data-key="optionSelect">اختر خدمة...</option>
                            <option value="real-estate" class="option1" data-key="option1">الخدمات العقارية</option>
                            <option value="tourism" class="option2" data-key="option2">الخدمات السياحية</option>
                            <option value="student" class="option3" data-key="option3">الخدمات الطلابية</option>
                            <option value="medical" class="option4" data-key="option4">الخدمات العلاجية</option>
                            <option value="business" class="option5" data-key="option5">خدمات الأعمال</option>
                            <option value="other" class="option6" data-key="option6">خدمات أخرى</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="date" class="label-date" data-key="labelDate">التاريخ المفضل</label>
                        <input type="date" id="date" name="date" required>
                    </div>
                    <div class="form-group">
                        <label for="message" class="label-message" data-key="labelMessage">متطلباتك</label>
                        <textarea id="message" name="message" data-key="requirementsPlaceholder"></textarea>
                    </div>
                    <button type="submit" class="submit-btn btn-text">
                        <span id="submit-text" data-key="btnText">طلب استشارة</span>
                        <i class="fas fa-paper-plane"></i>
                    </button>
                    <div class="success-message" id="successMessage">
                        <span class="success-text" data-key="successText">شكراً لك! تم استلام طلب استشارتك. سنتصل بك
                            قريباً لتأكيد موعدك.</span>
                    </div>
                    <div class="error-message" id="errorMessage">
                        <span class="error-text" data-key="errorText">حدث خطأ أثناء إرسال الطلب. يرجى المحاولة مرة
                            أخرى.</span>
                    </div>
                </form>
            </div>
        </section>

        <section class="contact" id="contact">
            <div class="container">
                <h2 class="section-title contact-title" data-key="contactTitle">تواصل معنا</h2>
                <p class="section-subtitle contact-subtitle" data-key="contactSubtitle">نحن هنا للإجابة على أسئلتك
                    ومساعدتك في البدء</p>
                <div class="contact-grid">
                    <div class="contact-item">
                        <div class="contact-icon"><i class="fas fa-map-marker-alt"></i></div>
                        <h3 class="contact1-title" data-key="contact1Title">موقعنا</h3>
                        <p class="contact1-info" data-key="contact1Info">بولو، تركيا</p>
                    </div>
                    <div class="contact-item">
                        <div class="contact-icon"><i class="fas fa-phone"></i></div>
                        <h3 class="contact2-title" data-key="contact2Title">اتصل بنا</h3>
                        <p class="contact2-info" data-key="contact2Info">+90 538 213 6214</p>
                    </div>
                    <div class="contact-item">
                        <div class="contact-icon"><i class="fas fa-envelope"></i></div>
                        <h3 class="contact3-title" data-key="contact3Title">راسلنا</h3>
                        <p class="contact3-info" data-key="contact3Info">wasslservices@gmail.com</p>
                    </div>
                </div>
            </div>
        </section>
    </section>

    <!-- Dashboard Page -->
    <!-- Business Dashboard Page -->
    <section id="business-dashboard-page" class="dashboard-section">
        <div class="dashboard-header">
            <div class="container">
                <h1 id="business-dashboard-title" data-key="businessDashboardTitle">لوحة تحكم مقدم الخدمة</h1>
                <p id="business-dashboard-subtitle" data-key="businessDashboardSubtitle">إدارة خدماتك وعرض إحصائياتك</p>
            </div>
        </div>
        <div class="container">
            <div class="dashboard-content">
                <div class="dashboard-sidebar">
                    <div class="user-info">
                        <h3 id="welcome-business-user" data-key="welcomeUser">مرحباً،</h3>
                        <div class="user-role-badge" id="user-role-badge-business">مقدم خدمة</div>
                    </div>

                    <div class="dashboard-stats">
                        <div class="stat-card">
                            <div class="stat-number" id="business-products-count">0</div>
                            <div class="stat-label" data-key="productsCount">الخدمات المنشورة</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" id="business-total-views">0</div>
                            <div class="stat-label" data-key="totalViews">إجمالي المشاهدات</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" id="business-favorites-count">0</div>
                            <div class="stat-label" data-key="totalFavorites">إجمالي المفضلة</div>
                        </div>
                    </div>

                    <button onclick="showAddProductModal()" class="auth-btn" id="add-product-btn"
                        style="width: 100%; margin-top: 2rem;">
                        <i class="fas fa-plus"></i>
                        <span data-key="addProductBtn">إضافة خدمة جديدة</span>
                    </button>

                    <button onclick="showMyProducts()" class="auth-btn secondary" id="my-products-btn"
                        style="width: 100%; margin-top: 1rem;">
                        <i class="fas fa-list"></i>
                        <span data-key="myProductsBtn">خدماتي المنشورة</span>
                    </button>

                    <button onclick="showBusinessStats()" class="auth-btn secondary" id="business-stats-btn"
                        style="width: 100%; margin-top: 1rem;">
                        <i class="fas fa-chart-bar"></i>
                        <span data-key="businessStatsBtn">الإحصائيات</span>
                    </button>
                </div>

                <div class="dashboard-main">
                    <h2 id="business-dashboard-section-title" data-key="myProducts">خدماتك المنشورة</h2>
                    <div class="products-grid" id="business-dashboard-products">
                        <!-- Business products will be loaded here -->
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Customer Dashboard Page -->
    <section id="customer-dashboard-page" class="dashboard-section">
        <div class="dashboard-header">
            <div class="container">
                <h1 id="customer-dashboard-title" data-key="customerDashboardTitle">لوحة تحكم العميل</h1>
                <p id="customer-dashboard-subtitle" data-key="customerDashboardSubtitle">استعرض الخدمات وأضفها للمفضلة
                </p>
            </div>
        </div>
        <div class="container">
            <div class="dashboard-content">
                <div class="dashboard-sidebar">
                    <div class="user-info">
                        <h3 id="welcome-customer-user" data-key="welcomeUser">مرحباً،</h3>
                        <div class="user-role-badge" id="user-role-badge-customer">عميل</div>
                    </div>

                    <div class="dashboard-stats">
                        <div class="stat-card">
                            <div class="stat-number" id="customer-favorites-count">0</div>
                            <div class="stat-label" data-key="favoritesCount">المفضلة</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" id="customer-viewed-count">0</div>
                            <div class="stat-label" data-key="viewedCount">الخدمات المستعرضة</div>
                        </div>
                    </div>

                    <div class="service-nav-links" style="margin-top: 2rem;">
                        <button onclick="showAllServicesForCustomer()" class="service-nav-link active"
                            id="all-services-customer-btn">
                            <i class="fas fa-th"></i>
                            <span data-key="allServices">جميع الخدمات</span>
                        </button>
                    </div>

                    <div class="service-categories" style="margin-top: 1rem;">
                        <button onclick="showCategoryForCustomer('real-estate')" class="service-nav-link">
                            <i class="fas fa-building"></i>
                            <span>العقارات</span>
                        </button>
                        <button onclick="showCategoryForCustomer('tourism')" class="service-nav-link">
                            <i class="fas fa-plane"></i>
                            <span>السياحة</span>
                        </button>
                        <button onclick="showCategoryForCustomer('student')" class="service-nav-link">
                            <i class="fas fa-graduation-cap"></i>
                            <span>الطلابية</span>
                        </button>
                        <button onclick="showCategoryForCustomer('medical')" class="service-nav-link">
                            <i class="fas fa-heartbeat"></i>
                            <span>الطبية</span>
                        </button>
                        <button onclick="showCategoryForCustomer('business')" class="service-nav-link">
                            <i class="fas fa-briefcase"></i>
                            <span>الأعمال</span>
                        </button>
                    </div>

                    <button onclick="showMyFavorites()" class="auth-btn" id="my-favorites-customer-btn"
                        style="width: 100%; margin-top: 2rem;">
                        <i class="fas fa-heart"></i>
                        <span data-key="myFavoritesBtn">قائمة المفضلة</span>
                    </button>
                </div>

                <div class="dashboard-main">
                    <h2 id="customer-dashboard-section-title" data-key="availableServices">الخدمات المتاحة</h2>
                    <div class="products-grid" id="customer-dashboard-products">
                        <!-- Customer view of all services will be loaded here -->
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Services Hub Page -->
    <section id="services-hub-page" class="service-page">
        <div class="service-header">
            <div class="container">
                <h1 data-key="servicesTitle">خدماتنا المتميزة</h1>
                <p data-key="servicesSubtitle">اختر الخدمة التي تريد استكشافها</p>
            </div>
        </div>
        <div class="container">
            <!-- Service Tabs Navigation -->
            <div class="service-tabs" id="serviceTabs">
                <button class="service-tab active" onclick="navigateTo('real-estate')">
                    <i class="fas fa-building"></i>
                    <span data-key="service1Title">العقارات</span>
                </button>
                <button class="service-tab" onclick="navigateTo('tourism')">
                    <i class="fas fa-plane"></i>
                    <span data-key="service2Title">السياحة</span>
                </button>
                <button class="service-tab" onclick="navigateTo('student')">
                    <i class="fas fa-graduation-cap"></i>
                    <span data-key="service3Title">الطلابية</span>
                </button>
                <button class="service-tab" onclick="navigateTo('medical')">
                    <i class="fas fa-heartbeat"></i>
                    <span data-key="service4Title">العلاجية</span>
                </button>
                <button class="service-tab" onclick="navigateTo('business')">
                    <i class="fas fa-briefcase"></i>
                    <span data-key="service5Title">الأعمال</span>
                </button>
                <button class="service-tab" onclick="navigateTo('other')">
                    <i class="fas fa-hands-helping"></i>
                    <span data-key="service6Title">إضافية</span>
                </button>
            </div>

            <!-- Service Pages Container -->
            <div id="services-container">
                <!-- Real Estate Service Page -->
                <div id="real-estate-page" class="service-content" style="display: block;">
                    <h2 class="service1-title" data-key="service1Title">الخدمات العقارية</h2>
                    <p class="service1-desc" data-key="service1Desc">اعثر على عقار أحلامك في أكثر المواقع المرغوبة في
                        تركيا. نقدم عقارات سكنية وتجارية حصرية للبيع والإيجار مع خدمة متميزة.</p>

                    <h3 class="real-estate-content-title1" data-key="realEstateContentTitle1">شراء العقارات</h3>
                    <p class="real-estate-content-p1" data-key="realEstateContentP1">نقدم خدمات شراء منازل شاملة تساعد
                        العملاء في العثور على عقاراتهم المثالية، بدءاً من تقييم متطلباتهم المحددة وصولاً إلى إتمام
                        الصفقة. يقدم فريقنا دعماً كاملاً خلال جميع مراحل العملية لضمان تجربة ناجحة وسلسة.</p>

                    <!-- Real Estate Form from Code B -->
                    <div class="service-form">
                        <h2 class="real-estate-form-title" data-key="realEstateFormTitle">طلب استشارة عقارية</h2>
                        <form id="realEstateForm">
                            <div class="form-group">
                                <label class="label-name" data-key="labelName">الاسم الكامل</label>
                                <input type="text" name="name" required>
                            </div>
                            <div class="form-group">
                                <label class="label-email" data-key="labelEmail">البريد الإلكتروني</label>
                                <input type="email" name="email" required>
                            </div>
                            <div class="form-group">
                                <label class="label-phone" data-key="labelPhone">رقم الهاتف</label>
                                <input type="tel" name="phone" required>
                            </div>
                            <div class="form-group">
                                <label for="property-type" class="real-estate-label1" data-key="realEstateLabel1">نوع
                                    العقار</label>
                                <select id="property-type" name="property-type" required>
                                    <option value="" class="real-estate-option-select"
                                        data-key="realEstateOptionSelect">اختر نوع العقار</option>
                                    <option value="apartment" class="real-estate-option1" data-key="realEstateOption1">
                                        شقة</option>
                                    <option value="villa" class="real-estate-option2" data-key="realEstateOption2">فيلا
                                    </option>
                                    <option value="commercial" class="real-estate-option3" data-key="realEstateOption3">
                                        عقار تجاري</option>
                                    <option value="land" class="real-estate-option4" data-key="realEstateOption4">أرض
                                    </option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="transaction-type" class="real-estate-label2" data-key="realEstateLabel2">نوع
                                    المعاملة</label>
                                <select id="transaction-type" name="transaction-type" required>
                                    <option value="" class="real-estate-option-select2"
                                        data-key="realEstateOptionSelect2">اختر نوع المعاملة</option>
                                    <option value="buy" class="real-estate-option5" data-key="realEstateOption5">شراء
                                    </option>
                                    <option value="rent" class="real-estate-option6" data-key="realEstateOption6">إيجار
                                    </option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="location" class="real-estate-label3" data-key="realEstateLabel3">الموقع
                                    المفضل</label>
                                <select id="location" name="location" class="city-select" required>
                                    <option value="" data-key="selectCityPlaceholder">اختر المدينة</option>
                                    <!-- Populated by JS -->
                                </select>
                            </div>
                            <div class="form-group">
                                <label class="real-estate-label4" data-key="realEstateLabel4">نطاق الميزانية ($)</label>
                                <div style="display: flex; gap: 10px;">
                                    <input type="number" id="budget-min" name="budget-min" data-key="budgetMin"
                                        required>
                                    <input type="number" id="budget-max" name="budget-max" data-key="budgetMax"
                                        required>
                                </div>
                            </div>
                            <div class="form-group">
                                <label for="additional-requirements" class="real-estate-label5"
                                    data-key="realEstateLabel5">متطلبات محددة</label>
                                <textarea id="additional-requirements" name="additional-requirements"
                                    data-key="additionalRq"></textarea>
                            </div>
                            <button type="submit" class="submit-btn real-estate-submit"
                                data-key="realEstateSubmit">إرسال الطلب</button>
                        </form>
                    </div>
                </div>
                <!-- Latest Real Estate Posts -->
                <div id="latest-real-estate-posts" class="service-latest-posts"></div>
            </div>

            <!-- Tourism Service Page -->
            <div id="tourism-page" class="service-content" style="display: none;">
                <h2 class="service2-title" data-key="service2Title">الخدمات السياحية</h2>
                <p class="service2-desc" data-key="service2Desc">اختبر جمال تركيا الأخاذ مع باقاتنا السياحية
                    المختارة بعناية. خطط سفر مخصصة وإقامات فاخرة لرحلات لا تُنسى.</p>

                <!-- Tourism Form from Code B -->
                <div class="service-form">
                    <h2 class="tourism-form-title" data-key="tourismFormTitle">استفسار عن باقة سياحية</h2>
                    <form id="tourismForm">
                        <div class="form-group">
                            <label class="label-name" data-key="labelName">الاسم الكامل</label>
                            <input type="text" name="name" required>
                        </div>
                        <div class="form-group">
                            <label class="label-email" data-key="labelEmail">البريد الإلكتروني</label>
                            <input type="email" name="email" required>
                        </div>
                        <div class="form-group">
                            <label class="label-phone" data-key="labelPhone">رقم الهاتف</label>
                            <input type="tel" name="phone" required>
                        </div>
                        <div class="form-group">
                            <label for="package-type" class="tourism-label1" data-key="tourismLabel1">تفضيل
                                الباقة</label>
                            <select id="package-type" name="package-type" required>
                                <option value="" class="tourism-option-select" data-key="tourismOptionSelect">اختر
                                    نوع الباقة</option>
                                <option value="special" class="tourism-option1" data-key="tourismOption1">باقة خاصة
                                </option>
                                <option value="custom" class="tourism-option2" data-key="tourismOption2">باقة مخصصة
                                </option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="city" class="tourism-label2" data-key="tourismLabel2">مدينة الوجهة</label>
                            <select id="city" name="city" class="city-select" required>
                                <option value="" data-key="selectCityPlaceholder">اختر المدينة</option>
                                <!-- Populated by JS -->
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="days" class="tourism-label3" data-key="tourismLabel3">مدة الإقامة</label>
                            <input type="number" id="days" name="days" min="1" data-key="tourismDays" required>
                        </div>
                        <div class="form-group">
                            <label for="travelers" class="tourism-label4" data-key="tourismLabel4">عدد
                                المسافرين</label>
                            <input type="number" id="travelers" name="travelers" min="1" required>
                        </div>
                        <div class="form-group">
                            <label for="transportation" class="tourism-label5" data-key="tourismLabel5">تفضيل
                                النقل</label>
                            <select id="transportation" name="transportation" required>
                                <option value="" class="tourism-option-select2" data-key="tourismOptionSelect2">اختر
                                    وسيلة النقل</option>
                                <option value="with-driver" class="tourism-option3" data-key="tourismOption3">سيارة
                                    مع سائق</option>
                                <option value="without-driver" class="tourism-option4" data-key="tourismOption4">
                                    سيارة ذاتية القيادة</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="hotel" class="tourism-label6" data-key="tourismLabel6">احتياجات
                                الإقامة</label>
                            <select id="hotel" name="hotel" required>
                                <option value="" class="tourism-option-select3" data-key="tourismOptionSelect3">اختر
                                    خيار الإقامة</option>
                                <option value="need" class="tourism-option5" data-key="tourismOption5">بحاجة لحجز
                                    فندق</option>
                                <option value="have" class="tourism-option6" data-key="tourismOption6">لدي سكن
                                    مسبقاً</option>
                            </select>
                        </div>
                        <button type="submit" class="submit-btn tourism-submit" data-key="tourismSubmit">إرسال
                            الاستفسار</button>
                    </form>
                </div>
            </div>
            <!-- Latest Tourism Posts -->
            <div id="latest-tourism-posts" class="service-latest-posts"></div>
        </div>

        <!-- Student Service Page -->
        <div id="student-page" class="service-content" style="display: none;">
            <!-- ... existing content ... -->
            <h2 class="service3-title" data-key="service3Title">الخدمات الطلابية</h2>
            <p class="service3-desc" data-key="service3Desc">تنقل في نظام التعليم التركي بإرشاد خبرائنا. من
                تقديم طلبات الجامعة إلى ترتيب السكن، نضمن رحلتك الأكاديمية سلسة وبلا متاعب.</p>

            <!-- Student Form from Code B -->
            <div class="service-form">
                <h2 class="student-form-title" data-key="studentFormTitle">طلب خدمة طلابية</h2>
                <form id="studentForm">
                    <div class="form-group">
                        <label for="student-name" class="student-label1" data-key="studentLabel1">الاسم
                            الكامل</label>
                        <input type="text" id="student-name" name="student-name" required>
                    </div>
                    <div class="form-group">
                        <label for="student-email" class="label-email" data-key="labelEmail">البريد
                            الإلكتروني</label>
                        <input type="email" id="student-email" name="email" required>
                    </div>
                    <div class="form-group">
                        <label for="student-phone" class="label-phone" data-key="labelPhone">رقم الهاتف</label>
                        <input type="tel" id="student-phone" name="phone" required>
                    </div>
                    <div class="form-group">
                        <label for="student-age" class="student-label2" data-key="studentLabel2">العمر</label>
                        <input type="number" id="student-age" name="student-age" min="16" required>
                    </div>
                    <div class="form-group">
                        <label for="student-gender" class="student-label3" data-key="studentLabel3">الجنس</label>
                        <select id="student-gender" name="student-gender" required>
                            <option value="" class="student-option-select" data-key="studentOptionSelect">اختر
                                الجنس</option>
                            <option value="male" class="student-option1" data-key="studentOption1">ذكر</option>
                            <option value="female" class="student-option2" data-key="studentOption2">أنثى
                            </option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="student-city" class="student-label4" data-key="studentLabel4">المدينة
                            المفضلة</label>
                        <select id="student-city" name="student-city" class="city-select" required>
                            <option value="" data-key="selectCityPlaceholder">اختر المدينة</option>
                            <!-- Populated by JS -->
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="university-type" class="student-label5" data-key="studentLabel5">تفضيل نوع
                            الجامعة</label>
                        <select id="university-type" name="university-type" required>
                            <option value="" class="student-option-select2" data-key="studentOptionSelect2">اختر
                                نوع الجامعة</option>
                            <option value="public" class="student-option3" data-key="studentOption3">جامعة
                                حكومية</option>
                            <option value="private" class="student-option4" data-key="studentOption4">جامعة خاصة
                            </option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="degree-type" class="student-label6" data-key="studentLabel6">المستوى الدراسي
                            المطلوب</label>
                        <select id="degree-type" name="degree-type" required>
                            <option value="" class="student-option-select3" data-key="studentOptionSelect3">اختر
                                المستوى الدراسي</option>
                            <option value="institute" class="student-option5" data-key="studentOption5">معهد
                                مهني</option>
                            <option value="bachelor" class="student-option6" data-key="studentOption6">بكالوريوس
                            </option>
                            <option value="master" class="student-option7" data-key="studentOption7">ماجستير
                            </option>
                            <option value="phd" class="student-option8" data-key="studentOption8">دكتوراه
                            </option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="major" class="student-label7" data-key="studentLabel7">المجال الدراسي
                            المقصود</label>
                        <input type="text" id="major" name="major" data-key="studentMajor" required>
                    </div>
                    <button type="submit" class="submit-btn student-submit" data-key="studentSubmit">إرسال
                        الطلب</button>
                </form>
            </div>
        </div>
        <!-- Latest Student Posts -->
        <div id="latest-student-posts" class="service-latest-posts"></div>
        </div>

        <!-- NEW: All Opportunities Feed Page -->
        <div id="opportunities-page" class="service-content" style="display: none;">
            <h2 class="section-title" data-key="allOppTitle" style="text-align: right; margin-bottom: 2rem;">All
                Opportunities</h2>
            <p class="section-subtitle" data-key="allOppSubtitle" style="text-align: right; margin-bottom: 2rem;">
                Explore all our latest listings and offers.</p>

            <div class="products-grid" id="all-opportunities-grid">
                <!-- Loaded via JS -->
                <div class="loading-spinner"><i class="fas fa-spinner fa-spin"></i> Loading...</div>
            </div>
        </div>

        <!-- Medical Service Page -->
        <div id="medical-page" class="service-content" style="display: none;">
            <h2 class="service4-title" data-key="service4Title">الخدمات العلاجية</h2>
            <p class="service4-desc" data-key="service4Desc">الوصول إلى نظام الرعاية الصحية العالمي في تركيا مع
                خدمات السياحة العلاجية المتميزة لدينا. أفضل المستشفيات، علاجات متخصصة، ورعاية شاملة.</p>

            <!-- Medical Form from Code B -->
            <div class="service-form">
                <h2 class="medical-form-title" data-key="medicalFormTitle">استشارة الخدمة الطبية</h2>
                <form id="medicalForm">
                    <div class="form-group">
                        <label class="label-name" data-key="labelName">الاسم الكامل</label>
                        <input type="text" name="name" required>
                    </div>
                    <div class="form-group">
                        <label class="label-email" data-key="labelEmail">البريد الإلكتروني</label>
                        <input type="email" name="email" required>
                    </div>
                    <div class="form-group">
                        <label class="label-phone" data-key="labelPhone">رقم الهاتف</label>
                        <input type="tel" name="phone" required>
                    </div>

                    <div class="form-group">
                        <label for="patient-gender" class="medical-label1" data-key="medicalLabel1">الجنس</label>
                        <select id="patient-gender" name="patient-gender" required>
                            <option value="" class="medical-option-select" data-key="medicalOptionSelect">اختر
                                الجنس</option>
                            <option value="male" class="medical-option1" data-key="medicalOption1">ذكر</option>
                            <option value="female" class="medical-option2" data-key="medicalOption2">أنثى
                            </option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="patient-nationality" class="medical-label2" data-key="medicalLabel2">الجنسية</label>
                        <input type="text" id="patient-nationality" name="patient-nationality" required>
                    </div>
                    <div class="form-group">
                        <label for="medical-condition" class="medical-label3" data-key="medicalLabel3">وصف
                            الحالة الطبية</label>
                        <textarea id="medical-condition" name="medical-condition" data-key="medicalConditionDesc"
                            required></textarea>
                    </div>
                    <div class="form-group">
                        <label for="medical-services" class="medical-label4" data-key="medicalLabel4">الخدمات
                            الطبية المطلوبة</label>
                        <select id="medical-services" name="medical-services" required>
                            <option value="" class="medical-option-select2" data-key="medicalOptionSelect2">اختر
                                الخدمة الطبية</option>
                            <option value="womens-health" class="medical-option3" data-key="medicalOption3">صحة
                                المرأة والتوليد</option>
                            <option value="surgery" class="medical-option4" data-key="medicalOption4">الإجراءات
                                الجراحية</option>
                            <option value="hair-transplant" class="medical-option5" data-key="medicalOption5">
                                زراعة الشعر</option>
                            <option value="dental" class="medical-option6" data-key="medicalOption6">الإجراءات
                                السنية</option>
                            <option value="other" class="medical-option7" data-key="medicalOption7">خدمة طبية
                                أخرى</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="accommodation" class="medical-label5" data-key="medicalLabel5">متطلبات
                            الإقامة</label>
                        <select id="accommodation" name="accommodation" required>
                            <option value="" class="medical-option-select3" data-key="medicalOptionSelect3">اختر
                                خيار الإقامة</option>
                            <option value="hotel-room" class="medical-option8" data-key="medicalOption8">غرفة
                                فندق</option>
                            <option value="apartment" class="medical-option9" data-key="medicalOption9">شقة
                                مفروشة</option>
                            <option value="not-needed" class="medical-option10" data-key="medicalOption10">لا
                                حاجة للإقامة</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="medical-transportation" class="medical-label6" data-key="medicalLabel6">احتياجات
                            النقل</label>
                        <select id="medical-transportation" name="medical-transportation" required>
                            <option value="" class="medical-option-select4" data-key="medicalOptionSelect4">اختر
                                وسيلة النقل</option>
                            <option value="with-driver" class="medical-option11" data-key="medicalOption11">
                                سيارة مع سائق</option>
                            <option value="without-driver" class="medical-option12" data-key="medicalOption12">
                                سيارة ذاتية القيادة</option>
                            <option value="not-needed" class="medical-option13" data-key="medicalOption13">لا
                                حاجة للنقل</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="translator" class="medical-label7" data-key="medicalLabel7">خدمات
                            الترجمة</label>
                        <select id="translator" name="translator" required>
                            <option value="" class="medical-option-select5" data-key="medicalOptionSelect5">اختر
                                خيار الترجمة</option>
                            <option value="male-translator" class="medical-option14" data-key="medicalOption14">
                                مترجم ذكر مطلوب</option>
                            <option value="female-translator" class="medical-option15" data-key="medicalOption15">مترجمة
                                أنثى مطلوبة</option>
                            <option value="not-needed" class="medical-option16" data-key="medicalOption16">لا
                                حاجة للترجمة</option>
                        </select>
                    </div>
                    <button type="submit" class="submit-btn medical-submit" data-key="medicalSubmit">إرسال طلب
                        الاستشارة</button>
                </form>
            </div>
        </div>
        <!-- Latest Medical Posts -->
        <div id="latest-medical-posts" class="service-latest-posts"></div>
        </div>

        <!-- Business Service Page -->
        <div id="business-page" class="service-content" style="display: none;">
            <h2 class="service5-title" data-key="service5Title">خدمات الأعمال</h2>
            <p class="service5-desc" data-key="service5Desc">أطلق أو وسع عملك في تركيا مع استشاراتنا المهنية.
                تسجيل الشركات، تحليل الأسواق، والتخطيط الاستراتيجي للنجاح.</p>

            <!-- Business Form from Code B -->
            <div class="service-form">
                <h2 class="business-form-title" data-key="businessFormTitle">استشارة الخدمة التجارية</h2>
                <form id="businessForm">
                    <div class="form-group">
                        <label class="label-name" data-key="labelName">الاسم الكامل</label>
                        <input type="text" name="name" required>
                    </div>
                    <div class="form-group">
                        <label class="label-email" data-key="labelEmail">البريد الإلكتروني للعمل</label>
                        <input type="email" name="email" required>
                    </div>
                    <div class="form-group">
                        <label class="label-phone" data-key="labelPhone">رقم الاتصال</label>
                        <input type="tel" name="phone" required>
                    </div>

                    <div class="form-group">
                        <label for="company-name" class="business-label1" data-key="businessLabel1">اسم الشركة
                            (إن وجد)</label>
                        <input type="text" id="company-name" name="company-name">
                    </div>
                    <div class="form-group">
                        <label for="service-type" class="business-label2" data-key="businessLabel2">نوع الخدمة
                            المطلوبة</label>
                        <input type="text" id="service-type" name="service-type" data-key="businessServiceType"
                            required>
                    </div>
                    <div class="form-group">
                        <label for="additional-info" class="business-label3" data-key="businessLabel3">معلومات
                            إضافية</label>
                        <textarea id="additional-info" name="additional-info"
                            data-key="businessAdditionalInfo"></textarea>
                    </div>

                    <button type="submit" class="submit-btn business-submit" data-key="businessSubmit">إرسال
                        استفسار العمل</button>
                </form>
            </div>
        </div>
        <!-- Latest Business Posts -->
        <div id="latest-business-posts" class="service-latest-posts"></div>
        </div>

        <!-- Other Services Page -->
        <div id="other-page" class="service-content" style="display: none;">
            <h2 class="service6-title" data-key="service6Title">خدمات إضافية</h2>
            <p class="service6-desc" data-key="service6Desc">دعم شامل يشمل الخدمات القانونية، الترجمة، تصاريح
                الإقامة، التأمين، والنقل لجعل حياتك في تركيا خالية من المتاعب.</p>

            <!-- Other Form from Code B -->
            <div class="service-form">
                <h2 class="other-form-title" data-key="otherFormTitle">طلب خدمة إضافية</h2>
                <form id="otherForm">
                    <div class="form-group">
                        <label class="label-name" data-key="labelName">اسمك الكامل</label>
                        <input type="text" name="name" required>
                    </div>
                    <div class="form-group">
                        <label class="label-email" data-key="labelEmail">البريد الإلكتروني</label>
                        <input type="email" name="email" required>
                    </div>
                    <div class="form-group">
                        <label class="label-phone" data-key="labelPhone">رقم الاتصال</label>
                        <input type="tel" name="phone" required>
                    </div>

                    <div class="form-group">
                        <label for="other-service-type" class="other-label1" data-key="otherLabel1">فئة
                            الخدمة</label>
                        <select id="other-service-type" name="other-service-type" required>
                            <option value="" class="other-option-select" data-key="otherOptionSelect">اختر فئة
                                الخدمة</option>
                            <option value="legal" class="other-option1" data-key="otherOption1">الخدمات
                                القانونية</option>
                            <option value="translation" class="other-option2" data-key="otherOption2">الترجمة
                                والمصادقة</option>
                            <option value="residency" class="other-option3" data-key="otherOption3">الإقامة
                                والتأمين</option>
                            <option value="transportation" class="other-option4" data-key="otherOption4">خدمات
                                النقل</option>
                            <option value="other" class="other-option5" data-key="otherOption5">خدمة أخرى
                            </option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="other-service-details" class="other-label2" data-key="otherLabel2">مواصفات
                            الخدمة</label>
                        <textarea id="other-service-details" name="other-service-details" data-key="otherServiceDetails"
                            required></textarea>
                    </div>

                    <button type="submit" class="submit-btn other-submit" data-key="otherSubmit">إرسال طلب
                        الخدمة</button>
                </form>
            </div>
            <!-- Latest Other Posts -->
            <div id="latest-other-posts" class="service-latest-posts"></div>
        </div>
        </div>
        </div>
    </section>

    <!-- Login Modal -->
    <div class="modal-overlay" id="loginModal">
        <div class="modal">
            <div class="modal-header">
                <h2 id="login-title" data-key="loginTitle">تسجيل الدخول</h2>
                <button class="modal-close" onclick="hideModal('loginModal')">&times;</button>
            </div>
            <div class="modal-content">
                <form id="loginForm">
                    <div class="form-group">
                        <label for="login-email" data-key="labelEmail">البريد الإلكتروني</label>
                        <input type="email" id="login-email" required>
                    </div>
                    <div class="form-group">
                        <label for="login-password" data-key="labelPassword">كلمة المرور</label>
                        <input type="password" id="login-password" required>
                    </div>
                    <button type="submit" class="submit-btn">
                        <span data-key="loginBtn">تسجيل الدخول</span>
                    </button>
                </form>
            </div>
            <div class="modal-footer">
                <span data-key="noAccount">ليس لديك حساب؟</span>
                <a onclick="showRegisterModal()" id="register-link" data-key="registerLink">سجل الآن</a>
            </div>
        </div>
    </div>

    <!-- Register Modal -->
    <div class="modal-overlay" id="registerModal">
        <div class="modal">
            <div class="modal-header">
                <h2 id="register-title" data-key="registerTitle">إنشاء حساب جديد</h2>
                <button class="modal-close" onclick="hideModal('registerModal')">&times;</button>
            </div>
            <div class="modal-content">
                <form id="registerForm">
                    <div class="form-group">
                        <label for="register-name" data-key="labelName">الاسم الكامل</label>
                        <input type="text" id="register-name" required>
                    </div>
                    <div class="form-group">
                        <label for="register-email" data-key="labelEmail">البريد الإلكتروني</label>
                        <input type="email" id="register-email" required>
                    </div>
                    <div class="form-group">
                        <label for="register-password" data-key="labelPassword">كلمة المرور</label>
                        <input type="password" id="register-password" required minlength="6">
                    </div>

                    <div class="role-selection">
                        <div class="role-option" onclick="selectRole('customer')" id="role-customer">
                            <i class="fas fa-user"></i>
                            <h3 data-key="customerRole">عميل</h3>
                            <p data-key="customerDesc">تصفح الخدمات وأضفها للمفضلة</p>
                        </div>
                        <div class="role-option" onclick="selectRole('business')" id="role-business">
                            <i class="fas fa-briefcase"></i>
                            <h3 data-key="businessRole">مقدم خدمة</h3>
                            <p data-key="businessDesc">أنشر خدماتك وأدرجها في السوق</p>
                        </div>
                    </div>
                    <input type="hidden" id="register-role" value="customer">

                    <button type="submit" class="submit-btn">
                        <span data-key="registerBtn">إنشاء حساب</span>
                    </button>
                </form>
            </div>
            <div class="modal-footer">
                <span data-key="haveAccount">لديك حساب بالفعل؟</span>
                <a onclick="showLoginModal()" id="login-link" data-key="loginLink">تسجيل الدخول</a>
            </div>
        </div>
    </div>

    <!-- Add Product Modal -->
    <div class="modal-overlay" id="addProductModal">
        <div class="modal">
            <div class="modal-header">
                <h2 id="add-product-title" data-key="addProductTitle">إضافة خدمة جديدة</h2>
                <button class="modal-close" onclick="hideModal('addProductModal')">&times;</button>
            </div>
            <div class="modal-content">
                <form id="addProductForm">
                    <div class="form-group">
                        <label for="product-title" data-key="productTitle">عنوان الخدمة</label>
                        <input type="text" id="product-title" required>
                    </div>
                    <div class="form-group">
                        <label for="product-description" data-key="productDescription">وصف الخدمة</label>
                        <textarea id="product-description" rows="4" required></textarea>
                    </div>
                    <div class="form-group">
                        <label for="product-price" data-key="productPrice">السعر ($)</label>
                        <input type="number" id="product-price" required min="0" step="0.01">
                    </div>
                    <div class="form-group">
                        <label for="product-category" data-key="productCategory">الفئة</label>
                        <select id="product-category" required>
                            <option value="real-estate" data-key="option1">العقارات</option>
                            <option value="tourism" data-key="option2">السياحة</option>
                            <option value="student" data-key="option3">الطلابية</option>
                            <option value="medical" data-key="option4">الطبية</option>
                            <option value="business" data-key="option5">الأعمال</option>
                            <option value="other" data-key="option6">خدمات أخرى</option>
                        </select>
                    </div>
                    <div class="file-upload">
                        <label class="file-upload-label" for="product-image">
                            <i class="fas fa-cloud-upload-alt"></i>
                            <span data-key="uploadImage">انقر لرفع صورة</span>
                            <span style="font-size: 0.9rem; color: var(--text-light);" data-key="maxSize">(الحد الأقصى:
                                5MB)</span>
                        </label>
                        <input type="file" id="product-image" accept="image/*" onchange="previewImage(event)">
                        <div class="file-preview" id="file-preview"></div>
                    </div>
                    <button type="submit" class="submit-btn">
                        <span data-key="addProductBtn">إضافة الخدمة</span>
                    </button>
                </form>
            </div>
        </div>
    </div>

    <a href="https://wa.me/905382136214" target="_blank" class="whatsapp-fab" aria-label="اتصل بنا على واتساب">
        <i class="fab fa-whatsapp"></i>
    </a>

    <section id="pending-approval-page" class="service-page">
        <div class="container" style="text-align: center; padding: 6rem 1rem;">
            <div
                style="background: white; padding: 3rem; border-radius: 12px; box-shadow: 0 10px 25px rgba(0,0,0,0.05); max-width: 600px; margin: 0 auto;">
                <i class="fas fa-clock" style="font-size: 4rem; color: #d4af37; margin-bottom: 1.5rem;"></i>
                <h1 style="color: #0f4c81; margin-bottom: 1rem;" data-key="pendingTitle">حسابك قيد المراجعة</h1>
                <p style="color: #64748b; font-size: 1.1rem; line-height: 1.6; margin-bottom: 2rem;"
                    data-key="pendingMessage">
                    شكراً لتسجيلك كشريك أعمال. يقوم فريقنا حالياً بمراجعة طلبك للتأكد من جودة الخدمات المقدمة.
                </p>
                <div style="background: #f8fafc; padding: 1rem; border-radius: 8px; margin-bottom: 2rem;"
                    data-key="pendingTime">
                    وقت المراجعة المتوقع: 24 ساعة
                </div>
                <button onclick="navigateTo('home')" class="auth-btn" style="width: 100%; justify-content: center;"
                    data-key="backToHome">
                    العودة للرئيسية
                </button>
            </div>
        </div>
    </section>

    <section id="admin-dashboard-page" class="dashboard-section" style="background-color: #050b14; min-height: 100vh;">

        <style>
            #admin-dashboard-page {
                font-family: 'Courier New', Courier, monospace;
                /* Tech font */
                --neon-blue: #00f3ff;
                --neon-green: #0aff0a;
                --neon-red: #ff003c;
                --glass-bg: rgba(16, 28, 48, 0.7);
                --card-border: 1px solid rgba(0, 243, 255, 0.2);
            }

            #admin-dashboard-page .admin-header {
                background: linear-gradient(90deg, #000000 0%, #0f172a 100%);
                border-bottom: 2px solid var(--neon-blue);
                padding: 3rem 0;
                position: relative;
                overflow: hidden;
            }

            /* Scanline effect */
            #admin-dashboard-page .admin-header::after {
                content: " ";
                display: block;
                position: absolute;
                top: 0;
                left: 0;
                bottom: 0;
                right: 0;
                background: linear-gradient(rgba(18, 16, 16, 0) 50%, rgba(0, 0, 0, 0.25) 50%), linear-gradient(90deg, rgba(255, 0, 0, 0.06), rgba(0, 255, 0, 0.02), rgba(0, 0, 255, 0.06));
                z-index: 2;
                background-size: 100% 2px, 3px 100%;
                pointer-events: none;
            }

            #admin-dashboard-page h1 {
                color: var(--neon-blue);
                text-transform: uppercase;
                letter-spacing: 4px;
                text-shadow: 0 0 10px var(--neon-blue);
                font-size: 2.5rem;
                margin-bottom: 0.5rem;
            }

            #admin-dashboard-page h2.panel-title {
                color: white;
                border-left: 4px solid var(--neon-blue);
                padding-left: 15px;
                margin: 2rem 0 1.5rem 0;
                text-transform: uppercase;
                letter-spacing: 2px;
                font-size: 1.5rem;
            }

            /* High Tech Cards */
            #admin-dashboard-page .cyber-card {
                background: var(--glass-bg);
                border: var(--card-border);
                border-radius: 4px;
                padding: 1.5rem;
                backdrop-filter: blur(10px);
                transition: all 0.3s ease;
                position: relative;
                box-shadow: 0 0 15px rgba(0, 0, 0, 0.5);
            }

            #admin-dashboard-page .cyber-card:hover {
                transform: translateY(-2px);
                box-shadow: 0 0 20px rgba(0, 243, 255, 0.2);
                border-color: var(--neon-blue);
            }

            /* Neon Buttons */
            #admin-dashboard-page .cyber-btn {
                background: transparent;
                border: 1px solid var(--neon-blue);
                color: var(--neon-blue);
                padding: 8px 20px;
                text-transform: uppercase;
                letter-spacing: 1px;
                font-weight: bold;
                cursor: pointer;
                transition: 0.3s;
                font-family: inherit;
                position: relative;
                overflow: hidden;
            }

            #admin-dashboard-page .cyber-btn:hover {
                background: var(--neon-blue);
                color: black;
                box-shadow: 0 0 15px var(--neon-blue);
            }

            #admin-dashboard-page .cyber-btn.danger {
                border-color: var(--neon-red);
                color: var(--neon-red);
            }

            #admin-dashboard-page .cyber-btn.danger:hover {
                background: var(--neon-red);
                color: black;
                box-shadow: 0 0 15px var(--neon-red);
            }

            #admin-dashboard-page .cyber-btn.success {
                border-color: var(--neon-green);
                color: var(--neon-green);
            }

            #admin-dashboard-page .cyber-btn.success:hover {
                background: var(--neon-green);
                color: black;
                box-shadow: 0 0 15px var(--neon-green);
            }

            /* Grid Overrides */
            #admin-dashboard-page .dashboard-content {
                display: block;
                /* Override default grid */
            }

            #admin-dashboard-page .products-grid {
                display: grid;
                grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
                gap: 20px;
            }

            /* Status Badge */
            .cyber-badge {
                font-size: 0.7rem;
                padding: 2px 8px;
                border: 1px solid currentColor;
                text-transform: uppercase;
                display: inline-block;
                margin-bottom: 10px;
            }
        </style>

        <div class="admin-header">
            <div class="container" style="text-align: center;">
                <h1>System Overwatch</h1>
                <p style="color: #64748b; letter-spacing: 2px;">ADMINISTRATOR LEVEL ACCESS GRANTED</p>
            </div>
        </div>

        <div class="container" style="padding-top: 2rem;">
            <div class="dashboard-content">

                <div class="dashboard-main"
                    style="background: transparent; border: none; box-shadow: none; padding: 0;">
                    <div style="display: flex; justify-content: space-between; align-items: center;">
                        <h2 class="panel-title" style="border-color: var(--neon-green);">
                            <i class="fas fa-users-cog"></i> Access Requests (Pending)
                        </h2>
                        <button onclick="loadAdminDashboard()" class="cyber-btn">
                            <i class="fas fa-sync fa-spin-hover"></i> REFRESH DATA
                        </button>
                    </div>

                    <div id="admin-pending-list" class="products-grid">
                        <div class="cyber-card" style="text-align: center; grid-column: 1/-1;">
                            <i class="fas fa-satellite-dish fa-spin"
                                style="font-size: 2rem; color: var(--neon-blue);"></i>
                            <p style="color: white; margin-top: 10px;">SCANNING DATABASE...</p>
                        </div>
                    </div>
                </div>

                <div class="dashboard-main"
                    style="background: transparent; border: none; box-shadow: none; padding: 0; margin-top: 4rem;">
                    <div
                        style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 1rem;">
                        <h2 class="panel-title" style="border-color: var(--neon-red); margin-top: 0;">
                            <i class="fas fa-shield-virus"></i> Content Moderation Feed
                        </h2>

                        <div style="display: flex; gap: 10px;">
                            <button onclick="loadAllPostsAdmin('active')" class="cyber-btn success"
                                style="font-size: 0.8rem;">
                                ACTIVE ONLY
                            </button>
                            <button onclick="loadAllPostsAdmin('hidden')" class="cyber-btn danger"
                                style="font-size: 0.8rem;">
                                HIDDEN ONLY
                            </button>
                            <button onclick="loadAllPostsAdmin('all')" class="cyber-btn" style="font-size: 0.8rem;">
                                SHOW ALL
                            </button>
                        </div>
                    </div>

                    <div id="admin-posts-feed" class="products-grid">
                    </div>
                </div>
                <div class="dashboard-main"
                    style="background: transparent; border: none; box-shadow: none; padding: 0; margin-top: 4rem;">
                    <div style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap;">
                        <h2 class="panel-title" style="border-color: var(--neon-blue);">
                            <i class="fas fa-user-check"></i> Active Business Units
                        </h2>
                        <button onclick="loadActiveBusinesses()" class="cyber-btn"
                            style="border-color: var(--neon-blue); color: var(--neon-blue);">
                            <i class="fas fa-sync"></i> REFRESH ACTIVE
                        </button>
                    </div>

                    <div id="admin-active-list" class="products-grid">
                    </div>
                </div>

            </div>
        </div>
    </section>


    <script>
        // ============================================
        // FIREBASE CONFIGURATION
        // ============================================
        const firebaseConfig = {
            apiKey: "AIzaSyAGZ1QKi4o_3OqQSQJ9H9sQAsuRtm9PzqM",
            authDomain: "wa-f01de.firebaseapp.com",
            projectId: "wa-f01de",
            storageBucket: "wa-f01de.firebasestorage.app",
            messagingSenderId: "318603019726",
            appId: "1:318603019726:web:dd76e32154fc78e424179f",
            measurementId: "G-3XEW3L87ZD"
        };
        // ============================================

        // Initialize Firebase
        const app = firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const db = firebase.firestore();
        const storage = firebase.storage();

        // Google Sheets Configuration (from Code B)
        const GOOGLE_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbwq-HzbJo1HdXN_2EBO7o53cwL9YBVUtQky9BMbaI9bGZNWTrxns48XWbBg67iUtfC4NQ/exec';

        // Translations object (merged from Code A and Code B)
        const translations = {
            en: {
                // Navigation
                navHome: "Home",
                navServices: "Services",
                navAbout: "About Us",
                navAppointments: "Appointments",
                navContact: "Contact Us",
                langBtn: "العربية",

                // Common Placeholders
                selectCityPlaceholder: "Select City",
                budgetMin: "Min Price",
                budgetMax: "Max Price",
                additionalRq: "Please describe any specific features or requirements...",
                tourismDays: "Number of days",
                studentMajor: "Example: Business Administration, Engineering",
                medicalConditionDesc: "Please describe your medical condition and required treatments...",
                businessServiceType: "Example: Company Registration, Trade License, Feasibility Study",
                businessAdditionalInfo: "Please provide details about your business needs and goals...",
                otherServiceDetails: "Please provide detailed information about the service you need...",

                // Pending Approval
                pendingTitle: "Account Pending Approval",
                pendingMessage: "Thank you for registering. Our team is currently reviewing your application to ensure service quality.",
                pendingTime: "Estimated Review Time: 24 Hours",
                backToHome: "Back to Home",

                // Hero
                heroTitle: "Your Trusted Gateway in Turkey",
                heroSubtitle: "Comprehensive services for real estate, tourism, education, healthcare, and business solutions. Based in Bolu, serving all of Turkey with excellence and reliability.",
                ctaText: "Start Your Journey",

                // Auth
                loginTitle: "Login",
                registerTitle: "Create Account",
                loginBtn: "Login",
                registerBtn: "Create Account",
                noAccount: "Don't have an account?",
                haveAccount: "Already have an account?",
                registerLink: "Register Now",
                loginLink: "Login",

                // User Roles
                customerRole: "Customer",
                businessRole: "Business",
                customerDesc: "Browse services and add to favorites",
                businessDesc: "Publish and manage your services",

                // Dashboard
                dashboardTitle: "Dashboard",
                dashboardSubtitle: "Manage your services and interactions",
                welcomeUser: "Welcome,",
                productsCount: "Published Services",
                favoritesCount: "Favorites",
                addProductBtn: "Add New Service",
                myProductsBtn: "My Published Services",
                myFavoritesBtn: "Favorites List",
                myProducts: "Your Published Services",
                availableServices: "Available Services",
                availablePackages: "Available Packages", // Add these AFTER the existing dashboard translations in 'en' object
                businessDashboardTitle: "Business Dashboard",
                businessDashboardSubtitle: "Manage your services and view statistics",
                customerDashboardTitle: "Customer Dashboard",
                customerDashboardSubtitle: "Browse services and add to favorites",
                totalViews: "Total Views",
                totalFavorites: "Total Favorites",
                businessStatsBtn: "Statistics",
                allServices: "All Services",
                viewedCount: "Viewed Services",
                availableServices: "Available Services",

                // Services
                servicesTitle: "Our Premium Services",
                servicesSubtitle: "Comprehensive solutions tailored to your needs in Turkey",
                service1Title: "Real Estate Services",
                service2Title: "Tourism Services",
                service3Title: "Student Services",
                service4Title: "Medical Services",
                service5Title: "Business Services",
                service6Title: "Additional Services",
                service1Link: "Discover Properties",
                service2Link: "Explore Turkey",
                service3Link: "Start Your Journey",
                service4Link: "Find Treatment",
                service5Link: "Grow Your Business",
                service6Link: "View All Services",
                service1Desc: "Find your dream property in Turkey's most desirable locations. We offer exclusive residential and commercial properties for sale and rent with premium service.",
                service2Desc: "Experience the breathtaking beauty of Turkey with our carefully curated tourism packages. Custom travel plans and luxury accommodations for unforgettable journeys.",
                service3Desc: "Navigate the Turkish education system with expert guidance. From university applications to accommodation arrangements, we ensure your academic journey is smooth and hassle-free.",
                service4Desc: "Access Turkey's world-class healthcare system with our premium medical tourism services. Top hospitals, specialized treatments, and comprehensive care.",
                service5Desc: "Launch or expand your business in Turkey with our professional consultations. Company registration, market analysis, and strategic planning for success.",
                service6Desc: "Comprehensive support including legal services, translation, residence permits, insurance, and transportation to make your life in Turkey hassle-free.",

                // About
                aboutTitle: "Your Trusted Partner in Turkey",
                aboutP1: "Wassl is your premium service provider, headquartered in Bolu with Turkey-wide reach. With years of specialized expertise, we excel at connecting individuals and businesses with the premium services they need across Turkey.",
                aboutP2: "Whether you're looking for real estate investments, planning an unforgettable Turkish vacation, seeking educational opportunities, requiring medical treatments, or expanding your business ventures, we deliver seamless and hassle-free experiences.",
                aboutP3: "Our dedicated team of industry professionals is committed to delivering exceptional service, building lasting relationships, and ensuring your complete satisfaction with every interaction.",
                statText1: "Happy Clients",
                statText2: "Years Experience",
                statText3: "Customer Support",

                // Appointments
                appointmentsTitle: "Schedule Your Consultation",
                appointmentsSubtitle: "Let's discuss how we can help you achieve your goals in Turkey",
                labelName: "Full Name",
                labelEmail: "Email Address",
                labelPhone: "Phone Number",
                labelService: "Service Needed",
                labelDate: "Preferred Date",
                labelMessage: "Your Requirements",
                requirementsPlaceholder: "Tell us more about your specific needs and expectations...",
                labelPassword: "Password",
                optionSelect: "Select a service...",
                option1: "Real Estate Services",
                option2: "Tourism Services",
                option3: "Student Services",
                option4: "Medical Services",
                option5: "Business Services",
                option6: "Other Services",
                btnText: "Request Consultation",
                successText: "Thank you! Your consultation request has been received.",
                errorText: "An error occurred. Please try again.",

                // Contact
                contactTitle: "Get In Touch",
                contactSubtitle: "We're here to answer your questions and help you get started",
                contact1Title: "Our Location",
                contact1Info: "Bolu, Turkey",
                contact2Title: "Call Us",
                contact2Info: "+90 538 213 6214",
                contact3Title: "Email Us",
                contact3Info: "wasslservices@gmail.com",

                // Product Form
                productTitle: "Service Title",
                productDescription: "Service Description",
                productPrice: "Price ($)",
                productCategory: "Category",
                uploadImage: "Click to upload image",
                maxSize: "(Max: 5MB)",

                // Service Pages (from Code B)
                service1Subtitle: "Find your dream property in Turkey with our premium real estate solutions",
                service2Subtitle: "Discover the wonders of Turkey with our expertly crafted travel experiences",
                service3Subtitle: "Comprehensive educational support for international students in Turkey",
                service4Subtitle: "Access Turkey's advanced healthcare system with our comprehensive medical tourism services",
                service5Subtitle: "Professional consulting for establishing and expanding your business in Turkey",
                service6Subtitle: "Comprehensive support services to facilitate your life in Turkey",

                // Real Estate Service Page (from Code B)
                realEstateContentTitle1: "Property Acquisition",
                realEstateContentP1: "We provide comprehensive home purchasing services that assist clients in finding their ideal properties, starting from assessing their specific requirements through to completing the transaction. Our team offers complete support throughout all stages of the process to ensure a successful and seamless experience.",
                realEstateContentTitle2: "Apartment Rentals",
                realEstateContentP2: "Our residential leasing services simplify your search for the perfect home. We offer diverse property options through multiple channels, ensuring choices that align with your specific needs. We connect you with potential sellers while providing essential guidance and consultation, securing optimal pricing for your property investment.",
                realEstateContentTitle3: "Tourist Accommodations",
                realEstateContentP3: "Our holiday rental services offer travelers unique accommodation experiences, allowing them to enjoy home-like comfort with all essential amenities, making their journeys more memorable and authentic.",
                realEstateContentTitle4: "Our Real Estate Expertise",
                realEstateListItem1: "Residential property sales and purchases",
                realEstateListItem2: "Commercial real estate transactions",
                realEstateListItem3: "Long-term and short-term rental agreements",
                realEstateListItem4: "Vacation property management",
                realEstateListItem5: "Property valuation and market analysis",
                realEstateListItem6: "Legal documentation and contract processing",
                realEstateFormTitle: "Real Estate Consultation Request",
                realEstateLabel1: "Property Type",
                realEstateLabel2: "Transaction Type",
                realEstateLabel3: "Preferred Location",
                realEstateLabel4: "Budget Range",
                realEstateLabel5: "Specific Requirements",
                realEstateSubmit: "Submit Request",

                // Real Estate Form Options
                realEstateOptionSelect: "Select property type",
                realEstateOption1: "Apartment",
                realEstateOption2: "Villa",
                realEstateOption3: "Commercial Property",
                realEstateOption4: "Land",
                realEstateOptionSelect2: "Select transaction type",
                realEstateOption5: "Purchase",
                realEstateOption6: "Rental",

                // Tourism Service Page (from Code B)
                tourismContentTitle1: "Custom Travel Experiences",
                tourismContentP1: "We offer exclusive travel packages and personalized itineraries to help you explore Turkey's magnificent cities, historical sites, and natural wonders. Whether you're interested in ancient history, cultural immersion, or scenic beauty, we design the perfect journey tailored to your interests.",
                tourismContentTitle2: "Transportation Solutions",
                tourismContentP2: "We provide comprehensive transportation services, including chauffeur-driven vehicles and self-drive options, ensuring comfortable and convenient travel throughout your Turkish adventure.",
                tourismContentTitle3: "Accommodation Arrangements",
                tourismContentP3: "We handle all accommodation bookings to guarantee comfortable stays during your visit. From luxury resorts to charming boutique hotels, we find the perfect lodging to match your preferences and budget.",
                tourismContentTitle4: "Our Tourism Services Include",
                tourismListItem1: "Customized travel itineraries",
                tourismListItem2: "Hotel and resort reservations",
                tourismListItem3: "Domestic flight arrangements",
                tourismListItem4: "Guided tours with expert local guides",
                tourismListItem5: "Transportation services",
                tourismListItem6: "Special interest tours (historical, culinary, adventure)",
                tourismFormTitle: "Tourism Package Inquiry",
                tourismLabel1: "Package Preference",
                tourismLabel2: "Destination City",
                tourismLabel3: "Duration of Stay",
                tourismLabel4: "Number of Travelers",
                tourismLabel5: "Transportation Preference",
                tourismLabel6: "Accommodation Needs",
                tourismSubmit: "Submit Inquiry",

                // Tourism Form Options
                tourismOptionSelect: "Select package type",
                tourismOption1: "Special Package",
                tourismOption2: "Customized Package",
                tourismOptionSelect2: "Select transportation",
                tourismOption3: "Car with Driver",
                tourismOption4: "Self-Drive Car",
                tourismOptionSelect3: "Select accommodation option",
                tourismOption5: "Require Hotel Booking",
                tourismOption6: "Already Have Accommodation",

                // Student Service Page (from Code B)
                studentContentTitle1: "University Admissions Guidance",
                studentContentP1: "We provide end-to-end support for students pursuing education in Turkey. Our services encompass the complete admission process from initial application through final enrollment at both public and private universities.",
                studentContentTitle2: "Academic Program Selection",
                studentContentP2: "We assist students in identifying the ideal academic programs based on their interests, qualifications, and career aspirations. Our expertise covers institutions across Turkey, ensuring the best fit for each student's educational goals.",
                studentContentTitle3: "Student Accommodation Solutions",
                studentContentP3: "We facilitate finding appropriate student housing, whether on-campus university residences or off-campus apartments, to ensure a comfortable living experience throughout your academic journey.",
                studentContentTitle4: "Our Student Services Include",
                studentListItem1: "University and program selection",
                studentListItem2: "Application preparation and submission",
                studentListItem3: "Scholarship and financial aid guidance",
                studentListItem4: "Student visa assistance",
                studentListItem5: "Accommodation arrangements",
                studentListItem6: "Airport pickup and orientation",
                studentFormTitle: "Student Service Request",
                studentLabel1: "Full Name",
                studentLabel2: "Age",
                studentLabel3: "Gender",
                studentLabel4: "Preferred City",
                studentLabel5: "University Type Preference",
                studentLabel6: "Desired Degree Level",
                studentLabel7: "Intended Field of Study",
                studentSubmit: "Submit Request",

                // Student Form Options
                studentOptionSelect: "Select gender",
                studentOption1: "Male",
                studentOption2: "Female",
                studentOptionSelect2: "Select university type",
                studentOption3: "Public University",
                studentOption4: "Private University",
                studentOptionSelect3: "Select degree level",
                studentOption5: "Vocational Institute",
                studentOption6: "Bachelor's Degree",
                studentOption7: "Master's Degree",
                studentOption8: "PhD",

                // Medical Service Page (from Code B)
                medicalContentTitle1: "Medical Treatments in Turkey",
                medicalContentP1: "Turkey has emerged as a global leader in medical tourism, offering cutting-edge treatments at competitive prices. Our medical services encompass a wide range of specialties and procedures.",
                medicalContentTitle2: "Available Medical Services",
                medicalListItem1: "Women's Health and Obstetrics",
                medicalListItem2: "Surgical Procedures of all specialties",
                medicalListItem3: "Hair Transplantation and Restoration",
                medicalListItem4: "Comprehensive Dental Procedures",
                medicalListItem5: "Orthopedic surgeries and treatments",
                medicalListItem6: "Cardiology and cardiac procedures",
                medicalListItem7: "Oncology and cancer treatments",
                medicalListItem8: "Plastic and reconstructive surgery",
                medicalListItem9: "Fertility treatments and IVF",
                medicalContentTitle3: "Comprehensive Patient Support",
                medicalContentP2: "We provide complete assistance for medical tourists, including treatment coordination, accommodation arrangements, transportation services, and professional interpretation to ensure a comfortable and stress-free healthcare experience.",
                medicalFormTitle: "Medical Service Consultation",
                medicalLabel1: "Gender",
                medicalLabel2: "Nationality",
                medicalLabel3: "Medical Condition Description",
                medicalLabel4: "Required Medical Services",
                medicalLabel5: "Accommodation Requirements",
                medicalLabel6: "Transportation Needs",
                medicalLabel7: "Translation Services",
                medicalSubmit: "Submit Consultation Request",

                // Medical Form Options
                medicalOptionSelect: "Select gender",
                medicalOption1: "Male",
                medicalOption2: "Female",
                medicalOptionSelect2: "Select medical service",
                medicalOption3: "Women's Health and Obstetrics",
                medicalOption4: "Surgical Procedures",
                medicalOption5: "Hair Transplantation",
                medicalOption6: "Dental Procedures",
                medicalOption7: "Other Medical Service",
                medicalOptionSelect3: "Select accommodation option",
                medicalOption8: "Hotel Room",
                medicalOption9: "Serviced Apartment",
                medicalOption10: "Accommodation Not Required",
                medicalOptionSelect4: "Select transportation",
                medicalOption11: "Car with Driver",
                medicalOption12: "Self-Drive Car",
                medicalOption13: "Transportation Not Required",
                medicalOptionSelect5: "Select translation option",
                medicalOption14: "Male Translator Required",
                medicalOption15: "Female Translator Required",
                medicalOption16: "Translation Not Required",

                // Business Service Page (from Code B)
                businessContentTitle1: "Business Establishment and Expansion",
                businessContentP1: "Are you planning to launch a commercial enterprise in Turkey, or do you already operate a company and wish to establish branches and explore new opportunities? We facilitate company formation and manage all government procedures on your behalf.",
                businessContentP2: "Additionally, we supply all necessary information for comprehensive feasibility studies, detailed market analysis, optimal location selection, and strategic timing for your business initiatives.",
                businessContentTitle2: "Our Business Services Portfolio",
                businessListItem1: "Company registration and legal establishment",
                businessListItem2: "Commercial registration and licensing",
                businessListItem3: "Comprehensive feasibility studies",
                businessListItem4: "Market research and analysis",
                businessListItem5: "Strategic location assessment",
                businessListItem6: "Business expansion planning",
                businessListItem7: "Financial modeling and projections",
                businessListItem8: "Partnership and joint venture facilitation",
                businessFormTitle: "Business Service Consultation",
                businessLabel1: "Company Name (if applicable)",
                businessLabel2: "Required Service Type",
                businessLabel3: "Additional Information",
                businessLabel4: "Contact Person Name",
                businessLabel5: "Business Email",
                businessLabel6: "Contact Number",
                businessSubmit: "Submit Business Inquiry",

                // Other Services Page (from Code B)
                otherContentTitle1: "Legal Services",
                otherContentP1: "We deliver comprehensive legal solutions including attorney representation and legal consultations to ensure you receive necessary support and expert advice for protecting your rights and achieving your objectives with complete professionalism.",
                otherContentTitle2: "Translation and Notarization",
                otherContentP2: "Our translation and notarization services facilitate the conversion of official documents into various languages with guaranteed translation accuracy through legal certification. We also provide personal interpreters to assist you in diverse situations and ensure effective communication.",
                otherContentTitle3: "Residency and Insurance Solutions",
                otherContentP3: "Our residency application services include preparation of all required documentation, in addition to health insurance arrangements and population registration services, guaranteeing a straightforward and efficient experience for our clients.",
                otherContentTitle4: "Transportation Services",
                otherContentP4: "We offer comprehensive transportation solutions, including vehicle rentals with or without drivers, in addition to efficient goods transportation and personal item relocation services with exceptional reliability.",
                otherContentTitle5: "Our Additional Services Include",
                otherListItem1: "Legal consultation and representation",
                otherListItem2: "Document translation and notarization",
                otherListItem3: "Residency permit applications",
                otherListItem4: "Health insurance arrangements",
                otherListItem5: "Vehicle rental services",
                otherListItem6: "Personal and commercial transportation",
                otherListItem7: "Document authentication and legalization",
                otherFormTitle: "Additional Service Request",
                otherLabel1: "Service Category",
                otherLabel2: "Service Specifications",
                otherLabel3: "Your Full Name",
                otherLabel4: "Email Address",
                otherLabel5: "Contact Number",
                otherSubmit: "Submit Service Request",

                // Other Services Form Options
                otherOptionSelect: "Select service category",
                otherOption1: "Legal Services",
                otherOption2: "Translation and Notarization",
                otherOption3: "Residency and Insurance",
                otherOption4: "Transportation Services",
                otherOption5: "Other Service"
            },
            ar: {
                // Navigation
                navHome: "الرئيسية",
                navServices: "الخدمات",
                navAbout: "من نحن",
                navAppointments: "المواعيد",
                navContact: "اتصل بنا",
                langBtn: "English",

                // Common Placeholders
                selectCityPlaceholder: "اختر المدينة",
                budgetMin: "أقل سعر",
                budgetMax: "أعلى سعر",
                additionalRq: "يرجى وصف أي ميزات أو متطلبات محددة...",
                tourismDays: "عدد الأيام",
                studentMajor: "مثال: إدارة الأعمال، هندسة",
                medicalConditionDesc: "يرجى وصف حالتك الطبية والعلاجات المطلوبة...",
                businessServiceType: "مثال: تسجيل شركة، ترخيص تجاري، دراسة جدوى",
                businessAdditionalInfo: "يرجى تقديم تفاصيل عن احتياجاتك وأهدافك التجارية...",
                otherServiceDetails: "يرجى تقديم معلومات مفصلة عن الخدمة التي تحتاجها...",

                // Pending Approval
                pendingTitle: "حسابك قيد المراجعة",
                pendingMessage: "شكراً لتسجيلك كشريك أعمال. يقوم فريقنا حالياً بمراجعة طلبك للتأكد من جودة الخدمات المقدمة.",
                pendingTime: "وقت المراجعة المتوقع: 24 ساعة",
                backToHome: "العودة للرئيسية",

                // Hero
                heroTitle: "بوابتك الموثوقة في تركيا",
                heroSubtitle: "خدمات شاملة للعقارات، السياحة، التعليم، الرعاية الصحية، وحلول الأعمال. متمركزون في بولو، نخدم جميع أنحاء تركيا بتميز وموثوقية.",
                ctaText: "ابدأ رحلتك",

                // Auth
                loginTitle: "تسجيل الدخول",
                registerTitle: "إنشاء حساب جديد",
                loginBtn: "تسجيل الدخول",
                registerBtn: "إنشاء حساب",
                noAccount: "ليس لديك حساب؟",
                haveAccount: "لديك حساب بالفعل؟",
                registerLink: "سجل الآن",
                loginLink: "تسجيل الدخول",

                // User Roles
                customerRole: "عميل",
                businessRole: "مقدم خدمة",
                customerDesc: "تصفح الخدمات وأضفها للمفضلة",
                businessDesc: "أنشر خدماتك وأدرجها في السوق",

                // Dashboard
                dashboardTitle: "لوحة التحكم",
                dashboardSubtitle: "إدارة خدماتك وتفاعلاتك",
                welcomeUser: "مرحباً،",
                productsCount: "الخدمات المنشورة",
                favoritesCount: "المفضلة",
                addProductBtn: "إضافة خدمة جديدة",
                myProductsBtn: "خدماتي المنشورة",
                myFavoritesBtn: "قائمة المفضلة",
                myProducts: "خدماتك المنشورة",
                availableServices: "الخدمات المتاحة",
                availablePackages: "الباقات السياحية المتاحة", // Add these AFTER the existing dashboard translations in 'ar' object                
                businessDashboardTitle: "لوحة تحكم مقدم الخدمة",
                businessDashboardSubtitle: "إدارة خدماتك وعرض إحصائياتك",
                customerDashboardTitle: "لوحة تحكم العميل",
                customerDashboardSubtitle: "استعرض الخدمات وأضفها للمفضلة",
                totalViews: "إجمالي المشاهدات",
                totalFavorites: "إجمالي المفضلة",
                businessStatsBtn: "الإحصائيات",
                allServices: "جميع الخدمات",
                viewedCount: "الخدمات المستعرضة",
                availableServices: "الخدمات المتاحة",

                // Services
                servicesTitle: "خدماتنا المتميزة",
                servicesSubtitle: "حلول شاملة مصممة خصيصاً لاحتياجاتك في تركيا",
                service1Title: "الخدمات العقارية",
                service2Title: "الخدمات السياحية",
                service3Title: "الخدمات الطلابية",
                service4Title: "الخدمات العلاجية",
                service5Title: "خدمات الأعمال",
                service6Title: "خدمات إضافية",
                service1Link: "اكتشف العقارات",
                service2Link: "استكشف تركيا",
                service3Link: "ابدأ رحلتك",
                service4Link: "ابحث عن العلاج",
                service5Link: "نَمِ بأعمالك",
                service6Link: "عرض جميع الخدمات",
                service1Desc: "اعثر على عقار أحلامك في أكثر المواقع المرغوبة في تركيا. نقدم عقارات سكنية وتجارية حصرية للبيع والإيجار مع خدمة متميزة.",
                service2Desc: "اختبر جمال تركيا الأخاذ مع باقاتنا السياحية المختارة بعناية. خطط سفر مخصصة وإقامات فاخرة لرحلات لا تُنسى.",
                service3Desc: "تنقل في نظام التعليم التركي بإرشاد خبرائنا. من تقديم طلبات الجامعة إلى ترتيب السكن، نضمن رحلتك الأكاديمية سلسة وبلا متاعب.",
                service4Desc: "الوصول إلى نظام الرعاية الصحية العالمي في تركيا مع خدمات السياحة العلاجية المتميزة لدينا. أفضل المستشفيات، علاجات متخصصة، ورعاية شاملة.",
                service5Desc: "أطلق أو وسع عملك في تركيا مع استشاراتنا المهنية. تسجيل الشركات، تحليل الأسواق، والتخطيط الاستراتيجي للنجاح.",
                service6Desc: "دعم شامل يشمل الخدمات القانونية، الترجمة، تصاريح الإقامة، التأمين، والنقل لجعل حياتك في تركيا خالية من المتاعب.",

                // About
                aboutTitle: "شريكك الموثوق في تركيا",
                aboutP1: "وصل هو مزود الخدمات المتميز الخاص بك، بمقر رئيسي في بولو ووصول على مستوى تركيا. مع سنوات من الخبرة المتخصصة، نتفوق في ربط الأفراد والشركات بالخدمات المتميزة التي يحتاجونها عبر تركيا.",
                aboutP2: "سواء كنت تبحث عن استثمارات عقارية، تخطط لعطلة تركية لا تُنسى، تتطلع إلى فرص تعليمية، تحتاج إلى علاجات طبية، أو توسيع مشاريعك التجارية، نقدم تجارب سلسة وخالية من المتاعب.",
                aboutP3: "فريقنا المتفاني من محترفي الصناعة ملتزم بتقديم خدمة استثنائية، وبناء علاقات دائمة، وضمان رضاك التام مع كل تفاعل.",
                statText1: "عملاء سعداء",
                statText2: "سنوات خبرة",
                statText3: "دعم عملاء",

                // Appointments
                appointmentsTitle: "جدول استشارتك",
                appointmentsSubtitle: "دعنا نناقش كيف يمكننا مساعدتك في تحقيق أهدافك في تركيا",
                labelName: "الاسم الكامل",
                labelEmail: "البريد الإلكتروني",
                labelPhone: "رقم الهاتف",
                labelService: "الخدمة المطلوبة",
                labelDate: "التاريخ المفضل",
                labelMessage: "متطلباتك",
                requirementsPlaceholder: "أخبرنا المزيد عن احتياجاتك وتوقعاتك المحددة...",
                labelPassword: "كلمة المرور",
                optionSelect: "اختر خدمة...",
                option1: "الخدمات العقارية",
                option2: "الخدمات السياحية",
                option3: "الخدمات الطلابية",
                option4: "الخدمات العلاجية",
                option5: "خدمات الأعمال",
                option6: "خدمات أخرى",
                btnText: "طلب استشارة",
                successText: "شكراً لك! تم استلام طلب استشارتك.",
                errorText: "حدث خطأ. يرجى المحاولة مرة أخرى.",

                // Contact
                contactTitle: "تواصل معنا",
                contactSubtitle: "نحن هنا للإجابة على أسئلتك ومساعدتك في البدء",
                contact1Title: "موقعنا",
                contact1Info: "بولو، تركيا",
                contact2Title: "اتصل بنا",
                contact2Info: "+90 538 213 6214",
                contact3Title: "راسلنا",
                contact3Info: "wasslservices@gmail.com",

                // Product Form
                productTitle: "عنوان الخدمة",
                productDescription: "وصف الخدمة",
                productPrice: "السعر ($)",
                productCategory: "الفئة",
                uploadImage: "انقر لرفع صورة",
                maxSize: "(الحد الأقصى: 5MB)",

                // Service Pages (from Code B)
                service1Subtitle: "اعثر على عقار أحلامك في تركيا مع حلولنا العقارية المتميزة",
                service2Subtitle: "اكتشف عجائب تركيا مع تجارب السفر المصممة بخبرة",
                service3Subtitle: "دعم تعليمي شامل للطلاب الدوليين في تركيا",
                service4Subtitle: "الوصول إلى نظام الرعاية الصحية المتقدم في تركيا مع خدمات السياحة العلاجية الشاملة",
                service5Subtitle: "استشارات مهنية لتأسيس وتوسيع عملك في تركيا",
                service6Subtitle: "خدمات دعم شاملة لتسهيل حياتك في تركيا",

                // Real Estate Service Page (from Code B)
                realEstateContentTitle1: "شراء العقارات",
                realEstateContentP1: "نقدم خدمات شراء منازل شاملة تساعد العملاء في العثور على عقاراتهم المثالية، بدءاً من تقييم متطلباتهم المحددة وصولاً إلى إتمام الصفقة. يقدم فريقنا دعماً كاملاً خلال جميع مراحل العملية لضمان تجربة ناجحة وسلسة.",
                realEstateContentTitle2: "إيجار الشقق",
                realEstateContentP2: "تبسط خدمات التأجير السكني لدينا بحثك عن المنزل المثالي. نقدم خيارات عقارية متنوعة عبر قنوات متعددة، مما يضمن خيارات تتماشى مع احتياجاتك المحددة. نربطك بالبائعين المحتملين مع تقديم التوجيه والاستشارة الأساسيين، مؤمنين أسعاراً مثالية لاستثمارك العقاري.",
                realEstateContentTitle3: "الإقامات السياحية",
                realEstateContentP3: "تقدم خدمات التأجير السياحي لدينا للمسافرين تجارب إقامة فريدة، مما يسمح لهم بالاستمتاع براحة المنزل مع جميع وسائل الراحة الأساسية، مما يجعل رحلاتهم أكثر إمتاعاً وأصالة.",
                realEstateContentTitle4: "خبرتنا العقارية",
                realEstateListItem1: "مبيعات وشراء العقارات السكنية",
                realEstateListItem2: "معاملات العقارات التجارية",
                realEstateListItem3: "اتفاقيات الإيجار طويلة وقصيرة الأجل",
                realEstateListItem4: "إدارة العقارات السياحية",
                realEstateListItem5: "تقييم العقارات وتحليل السوق",
                realEstateListItem6: "المستندات القانونية ومعالجة العقود",
                realEstateFormTitle: "طلب استشارة عقارية",
                realEstateLabel1: "نوع العقار",
                realEstateLabel2: "نوع المعاملة",
                realEstateLabel3: "الموقع المفضل",
                realEstateLabel4: "نطاق الميزانية",
                realEstateLabel5: "متطلبات محددة",
                realEstateSubmit: "إرسال الطلب",

                // Real Estate Form Options
                realEstateOptionSelect: "اختر نوع العقار",
                realEstateOption1: "شقة",
                realEstateOption2: "فيلا",
                realEstateOption3: "عقار تجاري",
                realEstateOption4: "أرض",
                realEstateOptionSelect2: "اختر نوع المعاملة",
                realEstateOption5: "شراء",
                realEstateOption6: "إيجار",

                // Tourism Service Page (from Code B)
                tourismContentTitle1: "تجارب سفر مخصصة",
                tourismContentP1: "نقدم باقات سفر حصرية وخطوط سفر مخصصة لمساعدتك في استكشاف مدن تركيا الرائعة، والمواقع التاريخية، والعجائب الطبيعية. سواء كنت مهتماً بالتاريخ القديم، أو الانغماس الثقافي، أو الجمال الطبيعي، نصمم الرحلة المثالية المصممة خصيصاً لاهتماماتك.",
                tourismContentTitle2: "حلول النقل",
                tourismContentP2: "نوفر خدمات نقل شاملة، بما في ذلك مركبات مع سائق ومركبات للقيادة الذاتية، مما يضمن سفراً مريحاً ومريحاً خلال مغامرتك التركية.",
                tourismContentTitle3: "ترتيبات الإقامة",
                tourismContentP3: "نحن نتعامل مع جميع حجوزات الإقامة لضمان إقامة مريحة خلال زيارتك. من المنتجعات الفاخرة إلى الفنادق البوتيكية الساحرة، نجد مكان الإقامة المثالي ليناسب تفضيلاتك وميزانيتك.",
                tourismContentTitle4: "تشمل خدماتنا السياحية",
                tourismListItem1: "خطوط سفر مخصصة",
                tourismListItem2: "حجوزات الفنادق والمنتجعات",
                tourismListItem3: "ترتيبات الرحلات الجوية المحلية",
                tourismListItem4: "جولات إرشادية مع مرشدين محليين خبراء",
                tourismListItem5: "خدمات النقل",
                tourismListItem6: "جولات الاهتمامات الخاصة (تاريخية، طهي، مغامرة)",
                tourismFormTitle: "استفسار عن باقة سياحية",
                tourismLabel1: "تفضيل الباقة",
                tourismLabel2: "مدينة الوجهة",
                tourismLabel3: "مدة الإقامة",
                tourismLabel4: "عدد المسافرين",
                tourismLabel5: "تفضيل النقل",
                tourismLabel6: "احتياجات الإقامة",
                tourismSubmit: "إرسال الاستفسار",

                // Tourism Form Options
                tourismOptionSelect: "اختر نوع الباقة",
                tourismOption1: "باقة خاصة",
                tourismOption2: "باقة مخصصة",
                tourismOptionSelect2: "اختر وسيلة النقل",
                tourismOption3: "سيارة مع سائق",
                tourismOption4: "سيارة ذاتية القيادة",
                tourismOptionSelect3: "اختر خيار الإقامة",
                tourismOption5: "بحاجة لحجز فندق",
                tourismOption6: "لدي سكن مسبقاً",

                // Student Service Page (from Code B)
                studentContentTitle1: "إرشاد القبول الجامعي",
                studentContentP1: "نوفر دعماً شاملاً للطلاب الذين يتابعون التعليم في تركيا. تشمل خدماتنا عملية القبول الكاملة من التقديم الأولي حتى التسجيل النهائي في الجامعات الحكومية والخاصة.",
                studentContentTitle2: "اختيار البرنامج الأكاديمي",
                studentContentP2: "نساعد الطلاب في تحديد البرامج الأكاديمية المثالية بناءً على اهتماماتهم، مؤهلاتهم، وتطلعاتهم المهنية. تغطي خبرتنا المؤسسات عبر تركيا، مما يضمن أفضل ملاءمة لأهداف كل طالب تعليمية.",
                studentContentTitle3: "حلول سكن الطلاب",
                studentContentP3: "نسهل العثور على سكن طلابي مناسب، سواء في مساكن الجامعات داخل الحرم الجامعي أو الشقق خارج الحرم الجامعي، لضمان تجربة معيشة مريحة خلال رحلتك الأكاديمية.",
                studentContentTitle4: "تشمل خدماتنا الطلابية",
                studentListItem1: "اختيار الجامعة والبرنامج",
                studentListItem2: "إعداد الطلب وتقديمه",
                studentListItem3: "إرشاد المنح الدراسية والمساعدات المالية",
                studentListItem4: "مساعدة تأشيرة الطالب",
                studentListItem5: "ترتيبات الإقامة",
                studentListItem6: "الاستقبال في المطار والتوجيه",
                studentFormTitle: "طلب خدمة طلابية",
                studentLabel1: "الاسم الكامل",
                studentLabel2: "العمر",
                studentLabel3: "الجنس",
                studentLabel4: "المدينة المفضلة",
                studentLabel5: "تفضيل نوع الجامعة",
                studentLabel6: "المستوى الدراسي المطلوب",
                studentLabel7: "المجال الدراسي المقصود",
                studentSubmit: "إرسال الطلب",

                // Student Form Options
                studentOptionSelect: "اختر الجنس",
                studentOption1: "ذكر",
                studentOption2: "أنثى",
                studentOptionSelect2: "اختر نوع الجامعة",
                studentOption3: "جامعة حكومية",
                studentOption4: "جامعة خاصة",
                studentOptionSelect3: "اختر المستوى الدراسي",
                studentOption5: "معهد مهني",
                studentOption6: "بكالوريوس",
                studentOption7: "ماجستير",
                studentOption8: "دكتوراه",

                // Medical Service Page (from Code B)
                medicalContentTitle1: "العلاجات الطبية في تركيا",
                medicalContentP1: "برزت تركيا كرائدة عالمية في السياحة العلاجية، تقدم علاجات متطورة بأسعار تنافسية. تشمل خدماتنا الطبية مجموعة واسعة من التخصصات والإجراءات.",
                medicalContentTitle2: "الخدمات الطبية المتاحة",
                medicalListItem1: "صحة المرأة والتوليد",
                medicalListItem2: "الإجراءات الجراحية بجميع التخصصات",
                medicalListItem3: "زراعة الشعر واستعادته",
                medicalListItem4: "الإجراءات السنية الشاملة",
                medicalListItem5: "جراحات وعلاجات العظام",
                medicalListItem6: "أمراض القلب والإجراءات القلبية",
                medicalListItem7: "علاجات الأورام والسرطان",
                medicalListItem8: "جراحة التجميل والتقويم",
                medicalListItem9: "علاجات الخصوبة وأطفال الأنابيب",
                medicalContentTitle3: "دعم المريض الشامل",
                medicalContentP2: "نوفر مساعدة كاملة لسياح العلاج، بما في ذلك تنسيق العلاج، ترتيبات الإقامة، خدمات النقل، والترجمة المهنية لضمان تجربة رعاية صحية مريحة وخالية من التوتر.",
                medicalFormTitle: "استشارة الخدمة الطبية",
                medicalLabel1: "الجنس",
                medicalLabel2: "الجنسية",
                medicalLabel3: "وصف الحالة الطبية",
                medicalLabel4: "الخدمات الطبية المطلوبة",
                medicalLabel5: "متطلبات الإقامة",
                medicalLabel6: "احتياجات النقل",
                medicalLabel7: "خدمات الترجمة",
                medicalSubmit: "إرسال طلب الاستشارة",

                // Medical Form Options
                medicalOptionSelect: "اختر الجنس",
                medicalOption1: "ذكر",
                medicalOption2: "أنثى",
                medicalOptionSelect2: "اختر الخدمة الطبية",
                medicalOption3: "صحة المرأة والتوليد",
                medicalOption4: "الإجراءات الجراحية",
                medicalOption5: "زراعة الشعر",
                medicalOption6: "الإجراءات السنية",
                medicalOption7: "خدمة طبية أخرى",
                medicalOptionSelect3: "اختر خيار الإقامة",
                medicalOption8: "غرفة فندق",
                medicalOption9: "شقة مفروشة",
                medicalOption10: "لا حاجة للإقامة",
                medicalOptionSelect4: "اختر وسيلة النقل",
                medicalOption11: "سيارة مع سائق",
                medicalOption12: "سيارة ذاتية القيادة",
                medicalOption13: "لا حاجة للنقل",
                medicalOptionSelect5: "اختر خيار الترجمة",
                medicalOption14: "مترجم ذكر مطلوب",
                medicalOption15: "مترجمة أنثى مطلوبة",
                medicalOption16: "لا حاجة للترجمة",

                // Business Service Page (from Code B)
                businessContentTitle1: "تأسيس الأعمال والتوسع",
                businessContentP1: "هل تخطط لإطلاق مشروع تجاري في تركيا، أو هل لديك بالفعل شركة وتريد إنشاء فروع واستكشاف فرص جديدة؟ نحن نسهل تشكيل الشركة وندير جميع الإجراءات الحكومية نيابة عنك.",
                businessContentP2: "بالإضافة إلى ذلك، نوفر جميع المعلومات اللازمة لدراسات الجدوى الشاملة، تحليل السوق التفصيلي، اختيار الموقع الأمثل، والتوقيت الاستراتيجي لمبادرات عملك.",
                businessContentTitle2: "محفظة خدماتنا التجارية",
                businessListItem1: "تسجيل الشركة والتأسيس القانوني",
                businessListItem2: "التسجيل التجاري والترخيص",
                businessListItem3: "دراسات الجدوى الشاملة",
                businessListItem4: "بحث السوق والتحليل",
                businessListItem5: "تقييم الموقع الاستراتيجي",
                businessListItem6: "تخطيط التوسع التجاري",
                businessListItem7: "النمذجة المالية والتوقعات",
                businessListItem8: "تسهيل الشراكات والمشاريع المشتركة",
                businessFormTitle: "استشارة الخدمة التجارية",
                businessLabel1: "اسم الشركة (إن وجد)",
                businessLabel2: "نوع الخدمة المطلوبة",
                businessLabel3: "معلومات إضافية",
                businessLabel4: "اسم شخص الاتصال",
                businessLabel5: "البريد الإلكتروني للعمل",
                businessLabel6: "رقم الاتصال",
                businessSubmit: "إرسال استفسار العمل",

                // Other Services Page (from Code B)
                otherContentTitle1: "الخدمات القانونية",
                otherContentP1: "نقدم حلولاً قانونية شاملة بما في ذلك تمثيل المحاماة والاستشارات القانونية لضمان حصولك على الدعم الضروري والنصيحة الخبيرة لحماية حقوقك وتحقيق أهدافك بكامل الاحترافية.",
                otherContentTitle2: "الترجمة والمصادقة",
                otherContentP2: "تسهل خدمات الترجمة والمصادقة لدينا تحويل المستندات الرسمية إلى لغات مختلفة مع ضمان دقة الترجمة من خلال التصديق القانوني. نوفر أيضاً مترجمين شخصيين لمساعدتك في مواقف متنوعة وضمان التواصل الفعال.",
                otherContentTitle3: "حلول الإقامة والتأمين",
                otherContentP3: "تشمل خدمات تقديم طلبات الإقامة لدينا إعداد جميع الوثائق المطلوبة، بالإضافة إلى ترتيبات التأمين الصحي وخدمات التسجيل السكاني، مضمناً تجربة مباشرة وفعالة لعملائنا.",
                otherContentTitle4: "خدمات النقل",
                otherContentP4: "نقدم حلول نقل شاملة، بما في ذلك تأجير المركبات مع أو بدون سائقين، بالإضافة إلى خدمات نقل البضائع الفعالة وخدمات نقل العناصر الشخصية بموثوقية استثنائية.",
                otherContentTitle5: "تشمل خدماتنا الإضافية",
                otherListItem1: "الاستشارة والتمثيل القانوني",
                otherListItem2: "ترجمة المستندات والمصادقة",
                otherListItem3: "طلبات تصريح الإقامة",
                otherListItem4: "ترتيبات التأمين الصحي",
                otherListItem5: "خدمات تأجير المركبات",
                otherListItem6: "النقل الشخصي والتجاري",
                otherListItem7: "مصادقة المستندات وإضفاء الصفة الرسمية",
                otherFormTitle: "طلب خدمة إضافية",
                otherLabel1: "فئة الخدمة",
                otherLabel2: "مواصفات الخدمة",
                otherLabel3: "اسمك الكامل",
                otherLabel4: "البريد الإلكتروني",
                otherLabel5: "رقم الاتصال",
                otherSubmit: "إرسال طلب الخدمة",

                // Other Services Form Options
                otherOptionSelect: "اختر فئة الخدمة",
                otherOption1: "الخدمات القانونية",
                otherOption2: "الترجمة والمصادقة",
                otherOption3: "الإقامة والتأمين",
                otherOption4: "خدمات النقل",
                otherOption5: "خدمة أخرى",

                // Latest Opportunities
                latestOppTitle: "أحدث الفرص",
                latestOppSubtitle: "عروض جديدة مميزة لك",
                seeAllBtn: "عرض الكل"
            },

        };

        // Global variables
        let currentUser = null;
        let userRole = null;
        let currentLang = 'ar';
        let selectedImage = null;

        // DOM Elements
        const authButtons = document.getElementById('authButtons');
        const mobileAuth = document.getElementById('mobileAuth');
        const loginModal = document.getElementById('loginModal');
        const registerModal = document.getElementById('registerModal');
        const addProductModal = document.getElementById('addProductModal');

        // ============================================
        // GOOGLE SHEETS SUBMISSION FUNCTION (from Code B)
        // ============================================
        async function submitToGoogleSheets(formElement, formId) {
            const submitBtn = formElement.querySelector('button[type="submit"]');
            const originalText = submitBtn.innerHTML;

            // 1. UI Loading State
            submitBtn.disabled = true;
            submitBtn.innerHTML = currentLang === 'en' ? 'Sending...' : 'جاري الإرسال...';

            // 2. Automatically grab ALL fields from whichever form was clicked
            const formData = new FormData(formElement);
            const params = new URLSearchParams();
            formData.forEach((value, key) => {
                params.append(key, value);
            });
            params.append('formSource', formId); // Identifies if it's "studentForm", "medicalForm", etc.

            try {
                // 3. Send the data to your Google Script
                await fetch(GOOGLE_SCRIPT_URL, {
                    method: 'POST',
                    body: params,
                    mode: 'no-cors', // Essential for GitHub Pages
                    headers: {
                        'Content-Type': 'application/x-www-form-urlencoded'
                    }
                });

                // 4. Optimistic Success
                if (formId === 'appointmentForm') {
                    document.getElementById('successMessage').style.display = 'block';
                    document.getElementById('errorMessage').style.display = 'none';
                    setTimeout(() => { document.getElementById('successMessage').style.display = 'none'; }, 6000);
                } else {
                    alert(currentLang === 'en' ? 'Thank you! Your request was received.' : 'شكراً لك! تم استلام طلبك بنجاح.');
                }
                formElement.reset();

            } catch (error) {
                console.error('Network Error:', error);
                if (formId === 'appointmentForm') {
                    document.getElementById('errorMessage').style.display = 'block';
                } else {
                    alert(currentLang === 'en' ? 'Connection failed.' : 'فشل الاتصال.');
                }
            } finally {
                submitBtn.disabled = false;
                submitBtn.innerHTML = originalText;
            }
        }

        // UNIVERSAL: Listen to ALL forms on the website
        const allForms = ['appointmentForm', 'realEstateForm', 'tourismForm', 'studentForm', 'medicalForm', 'businessForm', 'otherForm'];

        allForms.forEach(formId => {
            const form = document.getElementById(formId);
            if (form) {
                form.addEventListener('submit', async function (e) {
                    e.preventDefault();
                    await submitToGoogleSheets(this, formId);
                });
            }
        });
        // ============================================
        // END GOOGLE SHEETS SUBMISSION FUNCTION
        // ============================================

        // Global variable to hold the listener (put this right above the init function)
        let userListener = null;

        function init() {
            // 1. Set minimum date for appointment
            const dateInput = document.getElementById('date');
            if (dateInput) dateInput.min = new Date().toISOString().split('T')[0];

            // 2. Set up auth state listener
            auth.onAuthStateChanged(async (user) => {
                if (user) {
                    currentUser = user;

                    // --- SECURITY UPGRADE START ---
                    // If a listener already exists from a previous session, stop it first
                    if (userListener) userListener();

                    // Start a LIVE connection to the user's database document
                    userListener = db.collection('users').doc(user.uid)
                        .onSnapshot((doc) => {
                            if (doc.exists) {
                                const userData = doc.data();
                                userRole = userData.role; // Keep role updated in real-time

                                // THE KILL SWITCH: Check permission every time the DB changes
                                if (userData.role === 'business' && userData.isApproved !== true) {
                                    console.warn("Security Alert: Approval revoked.");

                                    // Force Logout Immediately
                                    auth.signOut().then(() => {
                                        // Show a strict alert (Alerts pause execution, which is good here)
                                        alert(currentLang === 'ar'
                                            ? "تم تعليق حسابك من قبل الإدارة."
                                            : "Your account approval has been revoked by the admin.");

                                        // Redirect to pending page
                                        MapsTo('pending-approval');
                                    });
                                } else {
                                    // If they are safe, update the UI normally
                                    updateAuthUI();
                                }
                            } else {
                                // If the user document was deleted entirely
                                auth.signOut();
                            }
                        }, (error) => {
                            console.error("Real-time listener error:", error);
                        });
                    // --- SECURITY UPGRADE END ---

                } else {
                    // User logged out
                    currentUser = null;
                    userRole = null;

                    // Stop listening to the database to save memory/data
                    if (userListener) {
                        userListener();
                        userListener = null;
                    }

                    // ... inside updateAuthUI ...
                    if (userRole === 'admin') {
                        dashboardTitle = "Admin Console"; // Cool name
                        dashboardAction = "navigateTo('admin-dashboard')";
                    }
                    // ...


                    updateAuthUI();
                }
            });

            // 3. Load language preference
            const savedLang = localStorage.getItem('wassl-lang') || 'ar';
            setLanguage(savedLang);

            // 4. Initialize hash routing
            initHashRouting();

            // 5. Listen for hash changes
            window.addEventListener('hashchange', handleHashChange);

            // 6. Initial load based on current hash
            handleHashChange();
        }

        // ============================================
        // HASH ROUTING SYSTEM
        // ============================================

        function initHashRouting() {
            // Replace all onclick handlers to use navigateTo
            updateOnClickHandlers();
        }

        function updateOnClickHandlers() {
            // Update navigation links
            document.querySelectorAll('[onclick*="showPage"]').forEach(element => {
                const oldOnClick = element.getAttribute('onclick');
                if (oldOnClick.includes("'home'")) {
                    element.setAttribute('onclick', "navigateTo('home')");
                } else if (oldOnClick.includes("'dashboard'")) {
                    element.setAttribute('onclick', "navigateTo('dashboard')");
                }
            });

            // Update service links
            document.querySelectorAll('[onclick*="showServicePage"]').forEach(element => {
                const oldOnClick = element.getAttribute('onclick');
                const match = oldOnClick.match(/'([^']+)'/);
                if (match) {
                    const serviceId = match[1];
                    element.setAttribute('onclick', `navigateTo('${serviceId}')`);
                }
            });

            // Update scrollToSection calls
            document.querySelectorAll('[onclick*="scrollToSection"]').forEach(element => {
                const oldOnClick = element.getAttribute('onclick');
                const match = oldOnClick.match(/'([^']+)'/);
                if (match) {
                    const sectionId = match[1];
                    element.setAttribute('onclick', `navigateTo('home#${sectionId}')`);
                }
            });
        }

        function navigateTo(route) {
            // Fix: If route is 'services', map it to 'home#services' to slide down instead of opening empty hub
            if (route === 'services') {
                route = 'home#services';
            }
            // Update the hash
            window.location.hash = route;

            // Fix: Close mobile menu explicitly
            document.getElementById('navLinks').classList.remove('active');
        }

        // Global alias for compatibility
        window.MapsTo = navigateTo;

        function handleHashChange() {
            const hash = window.location.hash.substring(1); // Remove the #

            // Parse the hash for routes and anchors
            let route = hash;
            let anchor = null;

            if (hash.includes('#')) {
                const parts = hash.split('#');
                route = parts[0];
                anchor = parts[1];
            }

            // If no route specified, default to home
            if (!route) {
                route = 'home';
            }

            // Handle different routes
            if (route === 'home') {
                showPage('home');
                // If there's an anchor, scroll to it after a delay
                if (anchor) {
                    setTimeout(() => {
                        scrollToSection(anchor);
                    }, 300);
                }
            }
            else if (route === 'dashboard') {
                showDashboard(); // Changed from showPage('dashboard')
            }
            // --- NEW LOGIC START ---
            else if (route === 'admin-dashboard') {
                showPage('admin-dashboard');
            }
            else if (route === 'pending-approval') {
                showPage('pending-approval');
            }
            // --- NEW LOGIC END ---
            // Fix: 'services' route should handled by the home#services logic above if re-mapped, 
            // but if it comes through as pure 'services', we redirect to home#services
            else if (route === 'services') {
                showPage('home');
                setTimeout(() => scrollToSection('services'), 300);
            }
            else if (['real-estate', 'tourism', 'student', 'medical', 'business', 'other'].includes(route)) {
                showServicePage(route);
            }
            else {
                // Unknown route, default to home
                showPage('home');
            }

            // Update navigation active state
            updateNavActiveState(route);
        }



        // ============================================
        // END HASH ROUTING SYSTEM
        // ============================================

        // Language functions
        function setLanguage(lang) {
            currentLang = lang;
            localStorage.setItem('wassl-lang', lang);

            // Set direction
            document.documentElement.lang = lang;
            document.documentElement.dir = lang === 'ar' ? 'rtl' : 'ltr';

            // Update all elements with data-key
            document.querySelectorAll('[data-key]').forEach(element => {
                const key = element.getAttribute('data-key');
                if (translations[lang] && translations[lang][key]) {
                    if (element.tagName === 'INPUT' || element.tagName === 'TEXTAREA') {
                        element.placeholder = translations[lang][key];
                    } else {
                        element.textContent = translations[lang][key];
                    }
                }
            });

            // Update auth UI
            updateAuthUI();
        }

        function toggleLanguage() {
            const newLang = currentLang === 'en' ? 'ar' : 'en';
            setLanguage(newLang);
        }

        // Load user role from Firestore
        async function loadUserRole() {
            if (!currentUser) return;

            try {
                const userDoc = await db.collection('users').doc(currentUser.uid).get();
                if (userDoc.exists) {
                    userRole = userDoc.data().role;
                } else {
                    userRole = 'customer';
                }
            } catch (error) {
                console.error('Error loading user role:', error);
                userRole = 'customer';
            }
        }

        // Update authentication UI - FIXED: Both desktop and mobile buttons
        function updateAuthUI() {
            const langData = translations[currentLang];

            if (currentUser) {
                // ============================================================
                // 1. DETERMINE ROLE & BUTTON SETTINGS
                // ============================================================
                let dashboardTitle = langData.customerDashboardTitle;
                let dashboardAction = "showDashboard()";
                let roleLabel = langData.customerRole;
                // Default Badge Style (Blue/Standard)
                let roleStyle = "";

                if (userRole === 'business') {
                    dashboardTitle = langData.businessDashboardTitle;
                    roleLabel = langData.businessRole;
                    // Optional: Green for business
                    roleStyle = "background: #10b981; color: white;";
                }
                else if (userRole === 'admin') {
                    dashboardTitle = "ADMIN CONSOLE";
                    dashboardAction = "navigateTo('admin-dashboard')";
                    roleLabel = "ADMIN";
                    // Special Black & Gold Style for Admin
                    roleStyle = "background: #000; color: #fff; border: 1px solid #d4af37;";
                }

                // ============================================================
                // 2. RENDER DESKTOP MENU
                // ============================================================
                authButtons.innerHTML = `
                <div class="user-menu">
                    <span class="user-greeting">
                        <i class="fas fa-user-circle"></i>
                        ${currentUser.displayName || currentUser.email.split('@')[0]}
                        <span class="user-role-badge" style="${roleStyle}">${roleLabel}</span>
                    </span>
                
                    <button class="auth-btn" onclick="${dashboardAction}">
                        <i class="fas fa-tachometer-alt"></i>
                        <span>${dashboardTitle}</span>
                    </button>
                    
                    <button class="auth-btn secondary" onclick="signOut()">
                        <i class="fas fa-sign-out-alt"></i>
                        <span>${currentLang === 'ar' ? 'تسجيل الخروج' : 'Logout'}</span>
                    </button>
                </div>
            `;

                // ============================================================
                // 3. RENDER MOBILE MENU
                // ============================================================
                mobileAuth.innerHTML = `
                <div class="user-menu" style="flex-direction: column; align-items: flex-start; width: 100%;">
                    <span class="user-greeting" style="margin-bottom: 1rem;">
                        <i class="fas fa-user-circle"></i>
                        ${currentUser.displayName || currentUser.email.split('@')[0]}
                        <span class="user-role-badge" style="${roleStyle}">${roleLabel}</span>
                    </span>
                    
                    <button class="auth-btn" onclick="${dashboardAction}" style="width: 100%; margin-top: 0.5rem;">
                        <i class="fas fa-tachometer-alt"></i>
                        <span>${dashboardTitle}</span>
                    </button>
                    
                    <button class="auth-btn secondary" onclick="signOut(); toggleMenu();" style="width: 100%; margin-top: 0.5rem;">
                        <i class="fas fa-sign-out-alt"></i>
                        <span>${currentLang === 'ar' ? 'تسجيل الخروج' : 'Logout'}</span>
                    </button>
                </div>
            `;

            } else {
                // ============================================================
                // 4. GUEST VIEW (Not Logged In)
                // ============================================================
                const guestHTML = `
                <button class="auth-btn" onclick="showLoginModal(); toggleMenu();" style="${window.innerWidth <= 768 ? 'width: 100%;' : ''}">
                    <i class="fas fa-sign-in-alt"></i>
                    <span>${langData.loginBtn}</span>
                </button>
                <button class="auth-btn secondary" onclick="showRegisterModal(); toggleMenu();" style="${window.innerWidth <= 768 ? 'width: 100%; margin-top: 0.5rem;' : ''}">
                    <i class="fas fa-user-plus"></i>
                    <span>${langData.registerBtn}</span>
                </button>
            `;

                authButtons.innerHTML = guestHTML;
                mobileAuth.innerHTML = guestHTML;
            }
        }



        // Modal functions
        function showModal(modalId) {
            const modal = document.getElementById(modalId);
            modal.classList.add('active');
            document.body.style.overflow = 'hidden';
        }

        function hideModal(modalId) {
            const modal = document.getElementById(modalId);
            modal.classList.remove('active');
            document.body.style.overflow = 'auto';
        }

        function showLoginModal() {
            hideModal('registerModal');
            showModal('loginModal');
        }

        function showRegisterModal() {
            hideModal('loginModal');
            showModal('registerModal');
        }

        function showAddProductModal() {
            showModal('addProductModal');
        }

        // Role selection
        function selectRole(role) {
            document.getElementById('register-role').value = role;

            // Update UI
            document.querySelectorAll('.role-option').forEach(option => {
                option.classList.remove('selected');
            });

            if (role === 'customer') {
                document.getElementById('role-customer').classList.add('selected');
            } else {
                document.getElementById('role-business').classList.add('selected');
            }
        }

        // Image preview
        function previewImage(event) {
            const file = event.target.files[0];
            if (!file) return;

            if (file.size > 5 * 1024 * 1024) { // 5MB limit
                showToast(currentLang === 'ar' ? 'حجم الصورة كبير جداً (الحد الأقصى 5MB)' : 'Image too large (max 5MB)', 'error');
                event.target.value = '';
                return;
            }

            selectedImage = file;
            const reader = new FileReader();

            reader.onload = function (e) {
                const preview = document.getElementById('file-preview');
                preview.innerHTML = `<img src="${e.target.result}" alt="Preview">`;
            }

            reader.readAsDataURL(file);
        }

        // Authentication functions
        async function signUp(name, email, password, role) {
            // 1. Show Loading State
            const btn = document.querySelector('#registerForm button');
            const originalText = btn.innerHTML;
            btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> ' +
                (currentLang === 'ar' ? 'جاري المعالجة...' : 'Processing...');
            btn.disabled = true;

            try {
                // 2. Create Auth User
                const userCredential = await auth.createUserWithEmailAndPassword(email, password);
                const user = userCredential.user;

                // 3. Update Profile Name
                await user.updateProfile({
                    displayName: name
                });

                // 4. Save to Firestore with approval system
                const isApproved = (role === 'customer');

                await db.collection('users').doc(user.uid).set({
                    name: name,
                    email: email,
                    role: role,
                    isApproved: isApproved,
                    createdAt: firebase.firestore.FieldValue.serverTimestamp(),
                    lastLogin: firebase.firestore.FieldValue.serverTimestamp()
                });

                // 5. Handle different user types
                hideModal('registerModal');

                if (role === 'business') {
                    // Business: Sign out and show approval pending message
                    await auth.signOut();

                    const message = currentLang === 'ar'
                        ? "تم إنشاء حسابك التجاري بنجاح! سيتم تفعيله بعد مراجعة الإدارة (خلال 24 ساعة). ستصلك رسالة تأكيد عبر البريد الإلكتروني."
                        : "Business account created successfully! It is pending admin approval (within 24 hours). You'll receive a confirmation email.";

                    showToast(message, 'info');

                    // Optional: Show login modal after delay
                    setTimeout(() => showModal('loginModal'), 3000);

                } else {
                    // Customer: Show success and redirect to dashboard
                    const message = currentLang === 'ar'
                        ? 'تم إنشاء الحساب بنجاح!'
                        : 'Account created successfully!';

                    showToast(message, 'success');

                    // Automatically log in customer and redirect using Hash Routing
                    setTimeout(() => {
                        MapsTo('customer-dashboard'); // Use hash routing instead of window.location.href
                    }, 1500);
                }

            } catch (error) {
                console.error('Signup Error:', error);

                // Enhanced error handling with translations
                let errorMessage = error.message;

                if (currentLang === 'ar') {
                    if (error.code === 'auth/email-already-in-use') {
                        errorMessage = 'البريد الإلكتروني مستخدم بالفعل';
                    } else if (error.code === 'auth/weak-password') {
                        errorMessage = 'كلمة المرور ضعيفة. يجب أن تكون 6 أحرف على الأقل';
                    } else if (error.code === 'auth/invalid-email') {
                        errorMessage = 'بريد إلكتروني غير صالح';
                    } else if (error.code === 'auth/operation-not-allowed') {
                        errorMessage = 'عملية التسجيل غير مسموحة حالياً';
                    } else if (error.code === 'auth/network-request-failed') {
                        errorMessage = 'فشل في الشبكة. يرجى التحقق من اتصال الإنترنت';
                    }
                } else {
                    if (error.code === 'auth/email-already-in-use') {
                        errorMessage = 'Email is already in use';
                    } else if (error.code === 'auth/weak-password') {
                        errorMessage = 'Password is too weak. Must be at least 6 characters';
                    } else if (error.code === 'auth/invalid-email') {
                        errorMessage = 'Invalid email address';
                    }
                }

                showToast(errorMessage, 'error');

            } finally {
                // 6. Reset button state
                btn.innerHTML = originalText;
                btn.disabled = false;
            }
        }

        // Helper function to redirect based on role and approval status using Hash Routing
        function redirectBasedOnRole(role, isApproved) {
            switch (role) {
                case 'customer':
                    MapsTo('customer-dashboard'); // Use hash routing
                    break;

                case 'business':
                    if (isApproved) {
                        MapsTo('business-dashboard'); // Use hash routing
                    } else {
                        // Redirect to pending approval page using hash routing
                        MapsTo('pending-approval');
                    }
                    break;

                case 'admin':
                    MapsTo('admin-dashboard'); // Use hash routing
                    break;

                default:
                    MapsTo('home'); // Use hash routing
            }
        }

        // Optional: Login handler that checks approval status
        async function handleLogin(email, password) {
            try {
                const userCredential = await auth.signInWithEmailAndPassword(email, password);
                const user = userCredential.user;

                // Get user data from Firestore
                const userDoc = await db.collection('users').doc(user.uid).get();

                if (userDoc.exists) {
                    const userData = userDoc.data();

                    // Update last login timestamp
                    await db.collection('users').doc(user.uid).update({
                        lastLogin: firebase.firestore.FieldValue.serverTimestamp()
                    });

                    // Check if business user is approved
                    if (userData.role === 'business' && !userData.isApproved) {
                        // Business not approved - sign them out and show message
                        await auth.signOut();

                        const message = currentLang === 'ar'
                            ? 'حسابك التجاري قيد الانتظار للموافقة. الرجاء الانتظار حتى تتم مراجعته.'
                            : 'Your business account is pending approval. Please wait for review.';

                        showToast(message, 'warning');
                        MapsTo('pending-approval'); // Use hash routing
                        return;
                    }

                    // Successful login - redirect based on role and approval
                    redirectBasedOnRole(userData.role, userData.isApproved || false);

                } else {
                    // User document doesn't exist (edge case)
                    showToast(currentLang === 'ar' ? 'بيانات المستخدم غير موجودة' : 'User data not found', 'error');
                    await auth.signOut();
                }

            } catch (error) {
                console.error('Login Error:', error);

                let errorMessage = error.message;
                if (currentLang === 'ar') {
                    if (error.code === 'auth/user-not-found') {
                        errorMessage = 'المستخدم غير موجود';
                    } else if (error.code === 'auth/wrong-password') {
                        errorMessage = 'كلمة المرور غير صحيحة';
                    } else if (error.code === 'auth/user-disabled') {
                        errorMessage = 'تم تعطيل هذا الحساب';
                    }
                }

                showToast(errorMessage, 'error');
            }
        }

        // Optional: Admin function to approve businesses
        async function approveBusinessUser(userId) {
            try {
                await db.collection('users').doc(userId).update({
                    isApproved: true,
                    approvedAt: firebase.firestore.FieldValue.serverTimestamp(),
                    approvedBy: auth.currentUser.uid // Log which admin approved
                });

                // Optional: Send approval email notification
                const userDoc = await db.collection('users').doc(userId).get();
                const userData = userDoc.data();

                // You could trigger a cloud function here to send email
                console.log(`Business account approved for: ${userData.email}`);

                showToast(currentLang === 'ar' ? 'تمت الموافقة على الحساب التجاري' : 'Business account approved', 'success');

            } catch (error) {
                console.error('Approval Error:', error);
                showToast(error.message, 'error');
            }
        }

        // Optional: Check user status on app load - FIXED for hash routing
        function checkUserStatus() {
            auth.onAuthStateChanged(async (user) => {
                if (user) {
                    const userDoc = await db.collection('users').doc(user.uid).get();

                    if (userDoc.exists) {
                        const userData = userDoc.data();

                        // For business users, check approval status
                        if (userData.role === 'business' && !userData.isApproved) {
                            // Check current hash (remove # if present)
                            const currentHash = window.location.hash.replace('#', '');

                            // Redirect to pending page if not already there
                            if (currentHash !== 'pending-approval') {
                                MapsTo('pending-approval');
                            }
                        }
                    }
                }
            });
        }

        // Enhanced helper: If MapsTo doesn't exist, fall back to window.location.hash
        function ensureMapsToAvailable() {
            if (typeof MapsTo === 'undefined') {
                // Create a simple fallback MapsTo function
                window.MapsTo = function (page) {
                    window.location.hash = page;
                };

                // Also handle initial page load based on hash
                if (window.location.hash) {
                    const initialPage = window.location.hash.replace('#', '');
                    // You might want to load the corresponding content here
                    console.log(`Loading page: ${initialPage}`);
                }
            }
        }

        // Call this on app initialization
        ensureMapsToAvailable();
        // checkUserStatus(); // Uncomment if you want auto-check on load

        // Optional: Listen for hash changes to handle routing
        window.addEventListener('hashchange', function () {
            const page = window.location.hash.replace('#', '') || 'home';
            console.log(`Hash changed to: ${page}`);
            // You can add logic here to load the appropriate content for the page
        });

        // ============================================
        // SECURE LOGIN FUNCTION (Checks Approval)
        // ============================================
        async function signIn(email, password) {
            // 1. Show Loading State on the Button
            const btn = document.querySelector('#loginForm button');
            const originalText = btn.innerHTML;
            btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> ' +
                (currentLang === 'ar' ? 'جاري التحقق...' : 'Checking...');
            btn.disabled = true;

            try {
                // 2. Attempt to Log In
                const userCredential = await auth.signInWithEmailAndPassword(email, password);
                const user = userCredential.user;

                // 3. SECURITY CHECK: Fetch their file from the Database
                const userDoc = await db.collection('users').doc(user.uid).get();

                if (userDoc.exists) {
                    const userData = userDoc.data();

                    // 4. THE GATEKEEPER: Are they an unapproved business?
                    // If they are Business AND isApproved is false (or missing) -> KICK THEM OUT
                    if (userData.role === 'business' && userData.isApproved !== true) {

                        // FORCE LOGOUT IMMEDIATELY
                        await auth.signOut();

                        // Show strict message
                        const message = currentLang === 'ar'
                            ? "عذراً، حسابك لا يزال قيد المراجعة. يرجى الانتظار حتى يتم تفعيله."
                            : "Access Denied. Your account is still pending admin approval.";

                        alert(message); // Alert is better here so they definitely see it

                        // Redirect to the Pending Page
                        hideModal('loginModal');
                        MapsTo('pending-approval');
                        return; // Stop the function here
                    }

                    // 5. If Allowed: Update Last Login Date
                    db.collection('users').doc(user.uid).update({
                        lastLogin: firebase.firestore.FieldValue.serverTimestamp()
                    });

                    // 6. Success! Let them in.
                    hideModal('loginModal');
                    showToast(currentLang === 'ar' ? 'تم تسجيل الدخول بنجاح!' : 'Logged in successfully!', 'success');

                    // Redirect based on who they are
                    if (userData.role === 'business') {
                        MapsTo('business-dashboard');
                    } else if (userData.role === 'customer') {
                        MapsTo('customer-dashboard');
                    } else {
                        MapsTo('home');
                    }
                } else {
                    // Edge case: User exists in Auth but not Database
                    throw new Error(currentLang === 'ar' ? 'بيانات المستخدم غير موجودة' : 'User profile not found');
                }

            } catch (error) {
                console.error("Login Error:", error);
                // Translate common errors
                let msg = error.message;
                if (currentLang === 'ar') {
                    if (error.code === 'auth/wrong-password') msg = 'كلمة المرور غير صحيحة';
                    else if (error.code === 'auth/user-not-found') msg = 'لا يوجد حساب بهذا البريد الإلكتروني';
                }
                showToast(msg, 'error');

                // Ensure they are logged out if an error occurred after auth
                await auth.signOut();

            } finally {
                // Reset Button
                btn.innerHTML = originalText;
                btn.disabled = false;
            }
        }

        async function signOut() {
            try {
                await auth.signOut();
                // Navigate to home if on any dashboard
                if (window.location.hash.includes('dashboard')) {
                    navigateTo('home');
                }
                showToast(currentLang === 'ar' ? 'تم تسجيل الخروج' : 'Logged out', 'success');
            } catch (error) {
                showToast(error.message, 'error');
            }
        }

        // ============================================
        // FIXED: addProduct function with loading spinner
        // ============================================
        async function addProduct(productData) {
            if (!currentUser || userRole !== 'business') {
                showToast(currentLang === 'ar' ? 'يجب أن تكون مقدم خدمة لإضافة منتجات' : 'Must be a business user to add products', 'error');
                return;
            }

            // GET BUTTON AND SHOW LOADING
            const submitBtn = document.querySelector('#addProductForm button[type="submit"]');
            const originalText = submitBtn.innerHTML;
            submitBtn.disabled = true;
            // Set initial loading message even if no image, for consistent feedback
            submitBtn.innerHTML = currentLang === 'ar' ?
                '<i class="fas fa-spinner fa-spin"></i> جاري الرفع...' :
                '<i class="fas fa-spinner fa-spin"></i> Uploading...';

            try {
                let imageUrl = null;

                // 1. Upload Image (If selected)
                if (selectedImage) {
                    // Force connection to the specific bucket found in terminal
                    const storageRef = firebase.storage().refFromURL("gs://wa-f01de.firebasestorage.app");
                    // Added folder structure for better organization
                    const imageRef = storageRef.child(`products/${currentUser.uid}/${Date.now()}_${selectedImage.name}`);

                    // Create the upload task
                    const uploadTask = imageRef.put(selectedImage);

                    // Wrap upload in a Promise to track progress
                    await new Promise((resolve, reject) => {
                        uploadTask.on('state_changed',
                            (snapshot) => {
                                // Calculate percentage
                                const progress = (snapshot.bytesTransferred / snapshot.totalBytes) * 100;
                                // Update button text with percentage
                                submitBtn.innerHTML = `<i class="fas fa-spinner fa-spin"></i> ${Math.round(progress)}%`;
                            },
                            (error) => {
                                // Handle upload errors
                                console.error("Upload error:", error);
                                reject(error);
                            },
                            () => {
                                // Upload complete
                                resolve();
                            }
                        );
                    });

                    // Get the URL after upload finishes
                    imageUrl = await uploadTask.snapshot.ref.getDownloadURL();
                }

                // 2. Save Data to Firestore
                submitBtn.innerHTML = currentLang === 'ar' ? 'جاري الحفظ...' : 'Saving...';

                const product = {
                    ...productData,
                    userId: currentUser.uid,
                    userName: currentUser.displayName || currentUser.email,
                    createdAt: firebase.firestore.FieldValue.serverTimestamp(),
                    imageUrl: imageUrl
                };

                // ============================================
                // FIXED: Removed auto-favorite code (from Code A)
                // ============================================
                await db.collection('products').add(product);

                // 3. Success!
                hideModal('addProductModal');
                showToast(currentLang === 'ar' ? 'تمت إضافة الخدمة بنجاح!' : 'Service added successfully!', 'success');

                // Reset form
                document.getElementById('addProductForm').reset();
                document.getElementById('file-preview').innerHTML = '';
                selectedImage = null;

                // Refresh products (using Code A's precise logic)
                const currentHash = window.location.hash.substring(1);
                if (currentHash === 'dashboard') {
                    loadUserProducts();
                } else if (['real-estate', 'tourism', 'student', 'medical', 'business', 'other'].includes(currentHash)) {
                    loadProductsByCategory(currentHash);
                }

            } catch (error) {
                console.error('Error adding product:', error);
                // Specific error message for Storage permissions (from Code B)
                if (error.code === 'storage/unauthorized') {
                    showToast("Storage permission denied. Check Firebase Console Rules.", 'error');
                } else {
                    showToast(error.message, 'error');
                }
            } finally {
                // RESET BUTTON
                submitBtn.disabled = false;
                submitBtn.innerHTML = originalText;
            }
        }

        async function deleteProduct(productId) {
            if (!confirm(currentLang === 'ar' ? 'هل أنت متأكد من حذف هذه الخدمة؟' : 'Are you sure you want to delete this service?')) return;

            try {
                const productDoc = await db.collection('products').doc(productId).get();
                if (productDoc.exists && productDoc.data().userId === currentUser.uid) {
                    await db.collection('products').doc(productId).delete();
                    showToast(currentLang === 'ar' ? 'تم حذف الخدمة بنجاح' : 'Service deleted successfully', 'success');

                    // Refresh
                    const currentHash = window.location.hash.substring(1);
                    if (currentHash === 'dashboard') {
                        loadUserProducts();
                    } else if (['real-estate', 'tourism', 'student', 'medical', 'business', 'other'].includes(currentHash)) {
                        loadProductsByCategory(currentHash);
                    }
                } else {
                    showToast(currentLang === 'ar' ? 'لا يمكنك حذف هذه الخدمة' : 'You cannot delete this service', 'error');
                }
            } catch (error) {
                showToast(error.message, 'error');
            }
        }

        async function toggleFavorite(productId) {
            if (!currentUser) {
                showToast(currentLang === 'ar' ? 'يجب تسجيل الدخول لإضافة للمفضلة' : 'Please login to add favorites', 'error');
                return;
            }

            try {
                // Check if already favorited
                const favoriteQuery = await db.collection('productFavorites')
                    .where('productId', '==', productId)
                    .where('userId', '==', currentUser.uid)
                    .limit(1)
                    .get();

                if (!favoriteQuery.empty) {
                    // Remove from favorites
                    await db.collection('productFavorites').doc(favoriteQuery.docs[0].id).delete();
                    showToast(currentLang === 'ar' ? 'تمت الإزالة من المفضلة' : 'Removed from favorites', 'success');
                } else {
                    // Add to favorites
                    await db.collection('productFavorites').add({
                        productId: productId,
                        userId: currentUser.uid,
                        createdAt: firebase.firestore.FieldValue.serverTimestamp()
                    });
                    showToast(currentLang === 'ar' ? 'تمت الإضافة إلى المفضلة' : 'Added to favorites', 'success');
                }

                // Refresh
                const currentHash = window.location.hash.substring(1);
                if (currentHash === 'dashboard') {
                    loadUserFavorites();
                } else if (['real-estate', 'tourism', 'student', 'medical', 'business', 'other'].includes(currentHash)) {
                    loadProductsByCategory(currentHash);
                }

            } catch (error) {
                showToast(error.message, 'error');
            }
        }

        // Load products by category
        async function loadProductsByCategory(category) {
            const containerId = `${category}-products`;
            const container = document.getElementById(containerId);
            if (!container) return;

            try {
                // ============================================
                // NOTE: This query may require an index
                // When you see the error in console, click the link to create the index
                // ============================================
                const querySnapshot = await db.collection('products')
                    .where('category', '==', category)
                    .orderBy('createdAt', 'desc')
                    .get();

                if (querySnapshot.empty) {
                    container.innerHTML = `
                        <div class="empty-state">
                            <i class="fas fa-box-open"></i>
                            <h3>${currentLang === 'ar' ? 'لا توجد خدمات متاحة حالياً' : 'No services available yet'}</h3>
                            <p>${currentLang === 'ar' ? 'كن أول من يضيف خدمة في هذه الفئة' : 'Be the first to add a service in this category'}</p>
                        </div>
                    `;
                    return;
                }

                // Get user's favorites
                let userFavorites = [];
                if (currentUser) {
                    const favoritesQuery = await db.collection('productFavorites')
                        .where('userId', '==', currentUser.uid)
                        .get();
                    userFavorites = favoritesQuery.docs.map(doc => doc.data().productId);
                }

                let html = '';
                querySnapshot.forEach((doc) => {
                    const product = doc.data();
                    const isFavorite = userFavorites.includes(doc.id);
                    const isOwner = currentUser && product.userId === currentUser.uid;

                    html += `
                        <div class="product-card">
                            <div class="product-image">
                                ${product.imageUrl ?
                            `<img src="${product.imageUrl}" alt="${product.title}" loading="lazy">` :
                            `<i class="fas fa-image" style="font-size: 3rem; color: var(--text-light);"></i>`
                        }
                            </div>
                            <div class="product-content">
                                <div class="product-header">
                                    <h3 class="product-title">${product.title}</h3>
                                    ${isFavorite ?
                            `<i class="fas fa-heart" style="color: var(--accent);"></i>` : ''}
                                </div>
                                <span class="product-category">${getCategoryName(product.category)}</span>
                                <p class="product-description">${product.description}</p>
                                <div class="product-footer">
                                    <div class="product-price">$${parseFloat(product.price).toFixed(2)}</div>
                                    <div class="product-actions">
                                        ${!isOwner ?
                            `<button class="favorite-btn ${isFavorite ? 'favorited' : ''}" 
                                                onclick="toggleFavorite('${doc.id}')">
                                                <i class="fas fa-heart"></i>
                                            </button>` : ''}
                                        ${isOwner ?
                            `<button class="delete-btn" onclick="deleteProduct('${doc.id}')">
                                                ${currentLang === 'ar' ? 'حذف' : 'Delete'}
                                            </button>` : ''}
                                    </div>
                                </div>
                            </div>
                        </div>
                    `;
                });

                container.innerHTML = html;
            } catch (error) {
                console.error('Error loading products:', error);
                // First time error: Click the link in console to create index
                if (error.code === 'failed-precondition') {
                    container.innerHTML = `
                        <div class="empty-state">
                            <i class="fas fa-exclamation-triangle"></i>
                            <h3>${currentLang === 'ar' ? 'جارٍ إنشاء فهرس قاعدة البيانات' : 'Creating database index...'}</h3>
                            <p>${currentLang === 'ar' ? 'قد يستغرق الأمر دقيقة لأول مرة' : 'May take a minute for the first time'}</p>
                            <p style="font-size: 0.9rem; margin-top: 1rem;">
                                ${currentLang === 'ar' ?
                            'افتح وحدة التحكم في المتصفح (F12) وانقر على رابط إنشاء الفهرس' :
                            'Open browser console (F12) and click the index creation link'}
                            </p>
                        </div>
                    `;
                } else {
                    container.innerHTML = `
                        <div class="empty-state">
                            <i class="fas fa-exclamation-triangle"></i>
                            <h3>${currentLang === 'ar' ? 'حدث خطأ في تحميل الخدمات' : 'Error loading services'}</h3>
                            <p>${currentLang === 'ar' ? 'يرجى المحاولة مرة أخرى لاحقاً' : 'Please try again later'}</p>
                        </div>
                    `;
                }
            }
        }

        // Dashboard functions
        async function loadUserProducts() {
            if (!currentUser || userRole !== 'business') return;

            const container = document.getElementById('dashboard-products');
            if (!container) return;

            try {
                const querySnapshot = await db.collection('products')
                    .where('userId', '==', currentUser.uid)
                    .orderBy('createdAt', 'desc')
                    .get();

                // Update stats
                document.getElementById('products-count').textContent = querySnapshot.size;

                if (querySnapshot.empty) {
                    container.innerHTML = `
                        <div class="empty-state">
                            <i class="fas fa-box-open"></i>
                            <h3>${currentLang === 'ar' ? 'لم تقم بإضافة أي خدمات بعد' : 'You haven\'t added any services yet'}</h3>
                            <p>${currentLang === 'ar' ? 'ابدأ بإضافة خدمتك الأولى الآن' : 'Start by adding your first service'}</p>
                            <button class="auth-btn" onclick="showAddProductModal()" style="margin-top: 1rem;">
                                <i class="fas fa-plus"></i>
                                <span>${currentLang === 'ar' ? 'إضافة خدمة جديدة' : 'Add New Service'}</span>
                            </button>
                        </div>
                    `;
                    return;
                }

                let html = '';
                querySnapshot.forEach((doc) => {
                    const product = doc.data();

                    html += `
                        <div class="product-card">
                            <div class="product-image">
                                ${product.imageUrl ?
                            `<img src="${product.imageUrl}" alt="${product.title}">` :
                            `<i class="fas fa-image" style="font-size: 3rem; color: var(--text-light);"></i>`
                        }
                            </div>
                            <div class="product-content">
                                <div class="product-header">
                                    <h3 class="product-title">${product.title}</h3>
                                </div>
                                <span class="product-category">${getCategoryName(product.category)}</span>
                                <p class="product-description">${product.description}</p>
                                <div class="product-footer">
                                    <div class="product-price">$${parseFloat(product.price).toFixed(2)}</div>
                                    <div class="product-actions">
                                        <button class="delete-btn" onclick="deleteProduct('${doc.id}')">
                                            ${currentLang === 'ar' ? 'حذف' : 'Delete'}
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    `;
                });

                container.innerHTML = html;
            } catch (error) {
                console.error('Error loading user products:', error);
            }
        }

        async function loadUserFavorites() {
            if (!currentUser) return;

            const container = document.getElementById('dashboard-products');
            if (!container) return;

            try {
                // Get user's favorite product IDs
                const favoritesQuery = await db.collection('productFavorites')
                    .where('userId', '==', currentUser.uid)
                    .get();

                const favoriteProductIds = favoritesQuery.docs.map(doc => doc.data().productId);

                // Update stats
                document.getElementById('favorites-count').textContent = favoriteProductIds.length;

                if (favoriteProductIds.length === 0) {
                    container.innerHTML = `
                        <div class="empty-state">
                            <i class="fas fa-heart"></i>
                            <h3>${currentLang === 'ar' ? 'لا توجد خدمات في المفضلة' : 'No services in favorites'}</h3>
                            <p>${currentLang === 'ar' ? 'أضف خدماتك المفضلة لتظهر هنا' : 'Add your favorite services to see them here'}</p>
                        </div>
                    `;
                    return;
                }

                // Get the actual products
                let html = '';
                for (const productId of favoriteProductIds) {
                    const productDoc = await db.collection('products').doc(productId).get();
                    if (productDoc.exists) {
                        const product = productDoc.data();

                        html += `
                            <div class="product-card">
                                <div class="product-image">
                                    ${product.imageUrl ?
                                `<img src="${product.imageUrl}" alt="${product.title}">` :
                                `<i class="fas fa-image" style="font-size: 3rem; color: var(--text-light);"></i>`
                            }
                                </div>
                                <div class="product-content">
                                    <div class="product-header">
                                        <h3 class="product-title">${product.title}</h3>
                                        <i class="fas fa-heart" style="color: var(--accent);"></i>
                                    </div>
                                    <span class="product-category">${getCategoryName(product.category)}</span>
                                    <p class="product-description">${product.description}</p>
                                    <div class="product-footer">
                                        <div class="product-price">$${parseFloat(product.price).toFixed(2)}</div>
                                        <div class="product-actions">
                                            <button class="favorite-btn favorited" onclick="toggleFavorite('${productId}')">
                                                <i class="fas fa-heart"></i>
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        `;
                    }
                }

                container.innerHTML = html;
            } catch (error) {
                console.error('Error loading favorites:', error);
            }
        }

        function showMyProducts() {
            loadUserProducts();
        }

        function showMyFavorites() {
            if (!currentUser) {
                showToast(currentLang === 'ar' ? 'يجب تسجيل الدخول لعرض المفضلة' : 'Please login to view favorites', 'error');
                return;
            }
            loadUserFavorites();
        }

        // Helper functions
        function getCategoryName(category) {
            const categories = {
                'real-estate': currentLang === 'ar' ? 'العقارات' : 'Real Estate',
                'tourism': currentLang === 'ar' ? 'السياحة' : 'Tourism',
                'student': currentLang === 'ar' ? 'الطلابية' : 'Student',
                'medical': currentLang === 'ar' ? 'الطبية' : 'Medical',
                'business': currentLang === 'ar' ? 'الأعمال' : 'Business',
                'other': currentLang === 'ar' ? 'خدمات أخرى' : 'Other Services'
            };
            return categories[category] || category;
        }

        function showToast(message, type = 'info') {
            const toast = document.createElement('div');
            toast.className = `toast ${type}`;
            toast.textContent = message;
            document.body.appendChild(toast);

            setTimeout(() => {
                toast.style.animation = 'slideUp 0.3s ease';
                setTimeout(() => {
                    document.body.removeChild(toast);
                }, 300);
            }, 3000);
        }

        // Page navigation
        function showPage(pageId) {
            // 1. Hide all pages (Existing Logic)
            document.querySelectorAll('.service-page, .dashboard-section').forEach(page => {
                page.classList.remove('active');
            });

            // 2. Show the selected page (Existing Logic)
            const pageElement = document.getElementById(`${pageId}-page`);
            if (pageElement) {
                pageElement.classList.add('active');
            } else {
                // Fallback to home if page not found
                const homePage = document.getElementById('home-page');
                if (homePage) {
                    homePage.classList.add('active');
                }
            }

            // 3. Close mobile menu if open (Existing Logic)
            document.getElementById('navLinks').classList.remove('active');

            // 4. Scroll to top ONLY if navigating to a completely new main page context
            // We prevent this for internal dashboard tabs or sub-sections if handled elsewhere
            if (pageId !== 'home' && !window.location.hash.includes('#')) {
                window.scrollTo(0, 0);
            }

            // 5. Load dashboard data based on role (UPDATED SECTION)
            if (pageId === 'business-dashboard' && currentUser && userRole === 'business') {
                loadBusinessDashboard();
            } else if (pageId === 'customer-dashboard' && currentUser && userRole === 'customer') {
                loadCustomerDashboard();
            }
            // --- NEW ADMIN LOGIC ADDED HERE ---
            else if (pageId === 'admin-dashboard' && currentUser && userRole === 'admin') {
                loadAdminDashboard();
            }
        }



        // Show service page within services hub
        function showServicePage(serviceId) {
            // First, show the services hub page
            showPage('services-hub');

            // Hide all service content divs
            const serviceIds = ['real-estate', 'tourism', 'student', 'medical', 'business', 'other'];
            serviceIds.forEach(id => {
                const servicePage = document.getElementById(`${id}-page`);
                if (servicePage) {
                    servicePage.style.display = 'none';
                }
            });

            // Show the selected service
            const selectedService = document.getElementById(`${serviceId}-page`);
            if (selectedService) {
                selectedService.style.display = 'block';
            }

            // Update tabs active state
            document.querySelectorAll('.service-tab').forEach(tab => {
                tab.classList.remove('active');
            });

            const activeTab = document.querySelector(`.service-tab[onclick="navigateTo('${serviceId}')"]`);
            if (activeTab) {
                activeTab.classList.add('active');
            }

            // Load products for this category (optional - can be removed if not needed)
            // loadProductsByCategory(serviceId);
        }

        // Update navigation active state
        function updateNavActiveState(currentRoute) {
            // Remove active class from all nav links
            document.querySelectorAll('.nav-links a').forEach(link => {
                link.classList.remove('active');
            });

            // Add active class to current page link
            if (currentRoute === 'home' || !currentRoute) {
                document.querySelector('.nav-home').classList.add('active');
            } else if (currentRoute === 'dashboard') {
                document.querySelector('.nav-services').classList.add('active');
            } else if (['real-estate', 'tourism', 'student', 'medical', 'business', 'other', 'services'].includes(currentRoute)) {
                document.querySelector('.nav-services').classList.add('active');
            }
        }

        async function updateDashboardStats() {
            if (!currentUser) return;

            try {
                // Count user's products
                const productsSnapshot = await db.collection('products')
                    .where('userId', '==', currentUser.uid)
                    .get();
                document.getElementById('products-count').textContent = productsSnapshot.size;

                // Count user's favorites
                const favoritesSnapshot = await db.collection('productFavorites')
                    .where('userId', '==', currentUser.uid)
                    .get();
                document.getElementById('favorites-count').textContent = favoritesSnapshot.size;

                // Update welcome message
                document.getElementById('welcome-user').textContent = `${translations[currentLang].welcomeUser} ${currentUser.displayName || currentUser.email.split('@')[0]}`;
                document.getElementById('user-role-badge').textContent = userRole === 'business' ?
                    translations[currentLang].businessRole : translations[currentLang].customerRole;

            } catch (error) {
                console.error('Error updating dashboard stats:', error);
            }
        }

        function scrollToSection(sectionId) {
            const section = document.getElementById(sectionId);
            if (section) {
                section.scrollIntoView({ behavior: 'smooth' });
            }
        }

        function toggleMenu() {
            document.getElementById('navLinks').classList.toggle('active');
        }

        // Header scroll effect
        window.addEventListener('scroll', function () {
            const header = document.getElementById('main-header');
            if (window.scrollY > 50) {
                header.classList.add('scrolled');
            } else {
                header.classList.remove('scrolled');
            }
        });

        // Event Listeners
        document.getElementById('loginForm')?.addEventListener('submit', async (e) => {
            e.preventDefault();
            const email = document.getElementById('login-email').value;
            const password = document.getElementById('login-password').value;
            await signIn(email, password);
        });

        document.getElementById('registerForm')?.addEventListener('submit', async (e) => {
            e.preventDefault();
            const name = document.getElementById('register-name').value;
            const email = document.getElementById('register-email').value;
            const password = document.getElementById('register-password').value;
            const role = document.getElementById('register-role').value;
            await signUp(name, email, password, role);
        });

        document.getElementById('addProductForm')?.addEventListener('submit', async (e) => {
            e.preventDefault();
            const productData = {
                title: document.getElementById('product-title').value,
                description: document.getElementById('product-description').value,
                price: parseFloat(document.getElementById('product-price').value),
                category: document.getElementById('product-category').value
            };
            await addProduct(productData);
        });

        // Initialize the app
        document.addEventListener('DOMContentLoaded', init);

        // ============================================
        // NEW DASHBOARD FUNCTIONS
        // ============================================

        // Function to show appropriate dashboard based on role
        function showDashboard() {
            if (!currentUser) {
                showToast(currentLang === 'ar' ? 'يجب تسجيل الدخول' : 'Please login first', 'error');
                navigateTo('home');
                return;
            }

            if (userRole === 'business') {
                showPage('business-dashboard');
                loadBusinessDashboard();
            } else if (userRole === 'customer') {
                showPage('customer-dashboard');
                loadCustomerDashboard();
            } else {
                // Default to customer if no role
                userRole = 'customer';
                showPage('customer-dashboard');
                loadCustomerDashboard();
            }
        }

        // Business dashboard functions
        async function loadBusinessDashboard() {
            if (!currentUser || userRole !== 'business') return;

            // Update welcome message
            document.getElementById('welcome-business-user').textContent =
                `${translations[currentLang].welcomeUser} ${currentUser.displayName || currentUser.email.split('@')[0]}`;

            // Load business products
            await loadBusinessProducts();
            await updateBusinessStats();
        }

        async function loadBusinessProducts() {
            if (!currentUser || userRole !== 'business') return;

            const container = document.getElementById('business-dashboard-products');
            if (!container) return;

            try {
                const querySnapshot = await db.collection('products')
                    .where('userId', '==', currentUser.uid)
                    .orderBy('createdAt', 'desc')
                    .get();

                // Update products count
                document.getElementById('business-products-count').textContent = querySnapshot.size;

                if (querySnapshot.empty) {
                    container.innerHTML = `
                        <div class="empty-state">
                            <i class="fas fa-box-open"></i>
                            <h3>${currentLang === 'ar' ? 'لم تقم بإضافة أي خدمات بعد' : 'You haven\'t added any services yet'}</h3>
                            <p>${currentLang === 'ar' ? 'ابدأ بإضافة خدمتك الأولى الآن' : 'Start by adding your first service'}</p>
                            <button class="auth-btn" onclick="showAddProductModal()" style="margin-top: 1rem;">
                                <i class="fas fa-plus"></i>
                                <span>${currentLang === 'ar' ? 'إضافة خدمة جديدة' : 'Add New Service'}</span>
                            </button>
                        </div>
                    `;
                    return;
                }

                let html = '';
                let totalViews = 0;
                let totalFavorites = 0;

                for (const doc of querySnapshot.docs) {
                    const product = doc.data();
                    const productId = doc.id;

                    // Get views count for this product
                    const viewsQuery = await db.collection('productViews')
                        .where('productId', '==', productId)
                        .get();
                    const viewsCount = viewsQuery.size;
                    totalViews += viewsCount;

                    // Get favorites count for this product
                    const favoritesQuery = await db.collection('productFavorites')
                        .where('productId', '==', productId)
                        .get();
                    const favoritesCount = favoritesQuery.size;
                    totalFavorites += favoritesCount;

                    html += `
                        <div class="product-card">
                            <div class="product-image">
                                ${product.imageUrl ?
                            `<img src="${product.imageUrl}" alt="${product.title}">` :
                            `<i class="fas fa-image" style="font-size: 3rem; color: var(--text-light);"></i>`
                        }
                            </div>
                            <div class="product-content">
                                <div class="product-header">
                                    <h3 class="product-title">${product.title}</h3>
                                    <div style="display: flex; gap: 10px; align-items: center;">
                                        <span style="font-size: 0.8rem; color: var(--text-light);">
                                            <i class="fas fa-eye"></i> ${viewsCount}
                                        </span>
                                        <span style="font-size: 0.8rem; color: var(--text-light);">
                                            <i class="fas fa-heart"></i> ${favoritesCount}
                                        </span>
                                    </div>
                                </div>
                                <span class="product-category">${getCategoryName(product.category)}</span>
                                <p class="product-description">${product.description}</p>
                                <div class="product-footer">
                                    <div class="product-price">$${parseFloat(product.price).toFixed(2)}</div>
                                    <div class="product-actions">
                                        <button class="delete-btn" onclick="deleteProduct('${doc.id}')">
                                            ${currentLang === 'ar' ? 'حذف' : 'Delete'}
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    `;
                }

                // Update total stats
                document.getElementById('business-total-views').textContent = totalViews;
                document.getElementById('business-favorites-count').textContent = totalFavorites;

                container.innerHTML = html;
            } catch (error) {
                console.error('Error loading business products:', error);
            }
        }

        async function updateBusinessStats() {
            if (!currentUser || userRole !== 'business') return;

            try {
                // Count user's products
                const productsSnapshot = await db.collection('products')
                    .where('userId', '==', currentUser.uid)
                    .get();
                document.getElementById('business-products-count').textContent = productsSnapshot.size;

                // Calculate total views and favorites
                let totalViews = 0;
                let totalFavorites = 0;

                for (const doc of productsSnapshot.docs) {
                    const productId = doc.id;

                    // Get views for this product
                    const viewsQuery = await db.collection('productViews')
                        .where('productId', '==', productId)
                        .get();
                    totalViews += viewsQuery.size;

                    // Get favorites for this product
                    const favoritesQuery = await db.collection('productFavorites')
                        .where('productId', '==', productId)
                        .get();
                    totalFavorites += favoritesQuery.size;
                }

                document.getElementById('business-total-views').textContent = totalViews;
                document.getElementById('business-favorites-count').textContent = totalFavorites;

            } catch (error) {
                console.error('Error updating business stats:', error);
            }
        }

        function showBusinessStats() {
            // You can expand this to show detailed statistics
            alert(currentLang === 'ar' ? 'سيتم عرض إحصائيات مفصلة قريباً' : 'Detailed statistics will be shown soon');
        }

        // Customer dashboard functions
        async function loadCustomerDashboard() {
            if (!currentUser || userRole !== 'customer') return;

            // Update welcome message
            document.getElementById('welcome-customer-user').textContent =
                `${translations[currentLang].welcomeUser} ${currentUser.displayName || currentUser.email.split('@')[0]}`;

            // Load all services for customer
            await loadAllServicesForCustomer();
            await updateCustomerStats();
        }

        async function loadAllServicesForCustomer() {
            if (!currentUser) return;

            const container = document.getElementById('customer-dashboard-products');
            if (!container) return;

            try {
                const querySnapshot = await db.collection('products')
                    .orderBy('createdAt', 'desc')
                    .limit(50) // Limit to 50 services
                    .get();

                if (querySnapshot.empty) {
                    container.innerHTML = `
                        <div class="empty-state">
                            <i class="fas fa-box-open"></i>
                            <h3>${currentLang === 'ar' ? 'لا توجد خدمات متاحة حالياً' : 'No services available yet'}</h3>
                            <p>${currentLang === 'ar' ? 'كن أول من يضيف خدمة' : 'Be the first to add a service'}</p>
                        </div>
                    `;
                    return;
                }

                // Get user's favorites
                let userFavorites = [];
                const favoritesQuery = await db.collection('productFavorites')
                    .where('userId', '==', currentUser.uid)
                    .get();
                userFavorites = favoritesQuery.docs.map(doc => doc.data().productId);

                let html = '';
                let viewedCount = 0;

                for (const doc of querySnapshot.docs) {
                    const product = doc.data();

                    // Fix: Filter out hidden items
                    if (product.status === 'hidden') continue;

                    const productId = doc.id;
                    const isFavorite = userFavorites.includes(productId);

                    // Check if user has viewed this product
                    const viewQuery = await db.collection('productViews')
                        .where('productId', '==', productId)
                        .where('userId', '==', currentUser.uid)
                        .limit(1)
                        .get();

                    if (!viewQuery.empty) {
                        viewedCount++;
                    }

                    html += `
                        <div class="product-card">
                            <div class="product-image">
                                ${product.imageUrl ?
                            `<img src="${product.imageUrl}" alt="${product.title}" loading="lazy">` :
                            `<i class="fas fa-image" style="font-size: 3rem; color: var(--text-light);"></i>`
                        }
                            </div>
                            <div class="product-content">
                                <div class="product-header">
                                    <h3 class="product-title">${product.title}</h3>
                                    ${isFavorite ?
                            `<i class="fas fa-heart" style="color: var(--accent);"></i>` : ''}
                                </div>
                                <span class="product-category">${getCategoryName(product.category)}</span>
                                <p class="product-description">${product.description}</p>
                                <div class="product-footer">
                                    <div class="product-price">$${parseFloat(product.price).toFixed(2)}</div>
                                    <div class="product-actions">
                                        <button class="favorite-btn ${isFavorite ? 'favorited' : ''}" 
                                            onclick="toggleFavorite('${doc.id}')">
                                            <i class="fas fa-heart"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    `;
                }

                // Update viewed count
                document.getElementById('customer-viewed-count').textContent = viewedCount;

                container.innerHTML = html;
            } catch (error) {
                console.error('Error loading all services for customer:', error);
            }
        }

        async function showCategoryForCustomer(category) {
            if (!currentUser) return;

            const container = document.getElementById('customer-dashboard-products');
            if (!container) return;

            try {
                const querySnapshot = await db.collection('products')
                    .where('category', '==', category)
                    .orderBy('createdAt', 'desc')
                    .get();

                // Get user's favorites
                let userFavorites = [];
                const favoritesQuery = await db.collection('productFavorites')
                    .where('userId', '==', currentUser.uid)
                    .get();
                userFavorites = favoritesQuery.docs.map(doc => doc.data().productId);

                if (querySnapshot.empty) {
                    container.innerHTML = `
                        <div class="empty-state">
                            <i class="fas fa-box-open"></i>
                            <h3>${currentLang === 'ar' ? 'لا توجد خدمات في هذه الفئة' : 'No services in this category'}</h3>
                            <p>${currentLang === 'ar' ? 'كن أول من يضيف خدمة في هذه الفئة' : 'Be the first to add a service in this category'}</p>
                        </div>
                    `;
                    return;
                }

                let html = '';
                querySnapshot.forEach((doc) => {
                    const product = doc.data();

                    // Fix: Filter out hidden items
                    if (product.status === 'hidden') return;

                    const isFavorite = userFavorites.includes(doc.id);

                    html += `
                        <div class="product-card">
                            <div class="product-image">
                                ${product.imageUrl ?
                            `<img src="${product.imageUrl}" alt="${product.title}" loading="lazy">` :
                            `<i class="fas fa-image" style="font-size: 3rem; color: var(--text-light);"></i>`
                        }
                            </div>
                            <div class="product-content">
                                <div class="product-header">
                                    <h3 class="product-title">${product.title}</h3>
                                    ${isFavorite ?
                            `<i class="fas fa-heart" style="color: var(--accent);"></i>` : ''}
                                </div>
                                <span class="product-category">${getCategoryName(product.category)}</span>
                                <p class="product-description">${product.description}</p>
                                <div class="product-footer">
                                    <div class="product-price">$${parseFloat(product.price).toFixed(2)}</div>
                                    <div class="product-actions">
                                        <button class="favorite-btn ${isFavorite ? 'favorited' : ''}" 
                                            onclick="toggleFavorite('${doc.id}')">
                                            <i class="fas fa-heart"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    `;
                });

                container.innerHTML = html;

                // Update category buttons active state
                document.querySelectorAll('.service-categories .service-nav-link').forEach(btn => {
                    btn.classList.remove('active');
                });
                event.target.classList.add('active');

                // Update title
                document.getElementById('customer-dashboard-section-title').textContent =
                    getCategoryName(category);

            } catch (error) {
                console.error('Error loading category for customer:', error);
            }
        }

        async function updateCustomerStats() {
            if (!currentUser || userRole !== 'customer') return;

            try {
                // Count user's favorites
                const favoritesSnapshot = await db.collection('productFavorites')
                    .where('userId', '==', currentUser.uid)
                    .get();
                document.getElementById('customer-favorites-count').textContent = favoritesSnapshot.size;

                // Count viewed services (services the customer has viewed)
                const viewsSnapshot = await db.collection('productViews')
                    .where('userId', '==', currentUser.uid)
                    .get();

                // Get unique product views
                const viewedProductIds = [...new Set(viewsSnapshot.docs.map(doc => doc.data().productId))];
                document.getElementById('customer-viewed-count').textContent = viewedProductIds.length;

            } catch (error) {
                console.error('Error updating customer stats:', error);
            }
        }

        // ============================================
        // 🔒 ADMIN GOD MODE LOGIC (Refactored for Premium Design)
        // ============================================

        // 1. Master Loader
        async function loadAdminDashboard() {
            if (!currentUser || userRole !== 'admin') {
                alert("ACCESS DENIED");
                navigateTo('home');
                return;
            }

            // Update Admin Welcome
            const adminName = currentUser.displayName || 'Admin';
            const welcomeEl = document.getElementById('welcome-admin-user');
            if (welcomeEl) welcomeEl.textContent = `Welcome, ${adminName}`;

            // Load Stats
            updateAdminStats();

            // Default to Requests tab
            showAdminSection('requests');
        }

        // 2. Tab Navigation
        function showAdminSection(sectionId) {
            // Hide all sections
            ['requests', 'users', 'content'].forEach(id => {
                const el = document.getElementById(`admin-section-${id}`);
                if (el) el.style.display = 'none';
            });

            // Show selected
            const selected = document.getElementById(`admin-section-${sectionId}`);
            if (selected) selected.style.display = 'block';

            // Load data if needed
            if (sectionId === 'requests') loadPendingApprovals();
            if (sectionId === 'users') loadActiveBusinesses();
            if (sectionId === 'content') loadAllPostsAdmin('all');
        }

        // 3. Admin Stats (Counts)
        async function updateAdminStats() {
            try {
                const usersSnap = await db.collection('users').get();
                const totalEl = document.getElementById('total-users-count');
                if (totalEl) totalEl.textContent = usersSnap.size;

                const pendingSnap = await db.collection('users')
                    .where('role', '==', 'business')
                    .where('isApproved', '==', false)
                    .get();
                const pendingEl = document.getElementById('pending-requests-count');
                if (pendingEl) pendingEl.innerText = pendingSnap.size;
            } catch (e) {
                console.error("Stats Error", e);
            }
        }

        // 4. Load Pending Approvals (Standard UI)
        async function loadPendingApprovals() {
            const container = document.getElementById('admin-pending-list');
            if (!container) return;
            container.innerHTML = '<div class="loading-spinner"><i class="fas fa-spinner fa-spin"></i> Loading requests...</div>';

            try {
                const snapshot = await db.collection('users')
                    .where('role', '==', 'business')
                    .where('isApproved', '==', false)
                    .get();

                if (snapshot.empty) {
                    container.innerHTML = `
                        <div class="empty-state">
                            <i class="fas fa-check-circle" style="color: #10b981;"></i>
                            <h3>All Caught Up</h3>
                            <p>No new business requests.</p>
                        </div>`;
                    return;
                }

                let html = '';
                snapshot.forEach(doc => {
                    const user = doc.data();
                    const date = user.createdAt ? new Date(user.createdAt.toDate()).toLocaleDateString() : 'Just now';

                    html += `
                        <div class="product-card">
                            <div class="product-content">
                                <div class="product-header">
                                    <h3 class="product-title">${user.name || 'Unknown User'}</h3>
                                    <span class="product-category" style="background: var(--text-light); color: white;">PENDING</span>
                                </div>
                                <p class="product-description">
                                    <strong>Email:</strong> ${user.email}<br>
                                    <strong>Applied:</strong> ${date}
                                </p>
                                <div class="product-footer">
                                    <div class="product-actions" style="width: 100%; display: flex; gap: 10px;">
                                        <button onclick="adminAction('${doc.id}', 'approve')" class="auth-btn" style="flex: 1; font-size: 0.9rem;">
                                            <i class="fas fa-check"></i> Approve
                                        </button>
                                        <button onclick="adminAction('${doc.id}', 'reject')" class="auth-btn secondary" style="flex: 1; font-size: 0.9rem; border-color: #ef4444; color: #ef4444;">
                                            <i class="fas fa-times"></i> Reject
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    `;
                });
                container.innerHTML = html;

            } catch (error) {
                container.innerHTML = `<p class="error-text">Error: ${error.message}</p>`;
            }
        }

        // 5. Load Active Users (Standard UI)
        async function loadActiveBusinesses() {
            const container = document.getElementById('admin-active-list');
            if (!container) return;
            container.innerHTML = '<div class="loading-spinner"><i class="fas fa-spinner fa-spin"></i> Loading users...</div>';

            try {
                // Load Business Users first (main use case)
                const snapshot = await db.collection('users')
                    .where('role', '==', 'business')
                    .where('isApproved', '==', true)
                    .get();

                if (snapshot.empty) {
                    container.innerHTML = '<div class="empty-state"><p>No active business partners found.</p></div>';
                    return;
                }

                let html = '';
                snapshot.forEach(doc => {
                    const user = doc.data();
                    html += `
                        <div class="product-card">
                            <div class="product-content">
                                <div class="product-header">
                                    <h3 class="product-title">${user.name}</h3>
                                    <span class="product-category" style="background: var(--accent); color: white;">BUSINESS</span>
                                </div>
                                <p class="product-description">
                                    ${user.email}<br>
                                    <small class="text-muted">ID: ${doc.id}</small>
                                </p>
                                <div class="product-footer">
                                    <button onclick="adminAction('${doc.id}', 'suspend')" class="delete-btn" style="width: 100%;">
                                        <i class="fas fa-ban"></i> Suspend Account
                                    </button>
                                </div>
                            </div>
                        </div>
                    `;
                });
                container.innerHTML = html;

            } catch (error) {
                container.innerHTML = `<p class="error-text">${error.message}</p>`;
            }
        }

        // 6. Content Moderation (Standard UI)
        async function loadAllPostsAdmin(filter = 'all') {
            const container = document.getElementById('admin-posts-feed');
            if (!container) return;
            // Don't clear innerHTML if we want to smooth update, but for now simple loader
            container.innerHTML = '<div class="loading-spinner"><i class="fas fa-spinner fa-spin"></i> Loading content...</div>';

            try {
                let query = db.collection('products').orderBy('createdAt', 'desc').limit(50);

                // Note: 'status' filtering requires composite index for 'status' + 'createdAt'.
                // To avoid index errors for the user, we will filter in memory if needed, 
                // OR simply rely on the 'all' feed and show badges.
                // If the user has indexes, great. If not, we catch the error.

                let snapshot;
                try {
                    if (filter !== 'all') {
                        // Try specific query
                        snapshot = await query.where('status', '==', filter).get();
                    } else {
                        snapshot = await query.get();
                    }
                } catch (idxError) {
                    console.log("Index missing, falling back to client-side filter");
                    snapshot = await db.collection('products').orderBy('createdAt', 'desc').limit(100).get();
                }

                if (snapshot.empty) {
                    container.innerHTML = '<div class="empty-state"><p>No content found.</p></div>';
                    return;
                }

                let html = '';
                snapshot.forEach(doc => {
                    const product = doc.data();

                    // Manual Filter fallback
                    if (filter !== 'all' && product.status !== filter) return;

                    const isHidden = product.status === 'hidden';

                    html += `
                        <div class="product-card" style="${isHidden ? 'opacity: 0.7; border: 1px dashed #999;' : ''}">
                            <div class="product-content">
                                <div class="product-header">
                                    <h3 class="product-title">${product.title}</h3>
                                    ${isHidden ? '<span class="product-category" style="background: #64748b;">HIDDEN</span>' : '<span class="product-category" style="background: #10b981;">ACTIVE</span>'}
                                </div>
                                <p class="product-description">${product.description.substring(0, 100)}...</p>
                                <div class="product-footer">
                                    <div class="product-price">$${product.price}</div>
                                    <div class="product-actions">
                                        ${isHidden
                            ? `<button onclick="togglePostStatus('${doc.id}', 'active')" class="auth-btn" style="padding: 5px 10px; font-size: 0.8rem;"><i class="fas fa-eye"></i> Show</button>`
                            : `<button onclick="togglePostStatus('${doc.id}', 'hidden')" class="auth-btn secondary" style="padding: 5px 10px; font-size: 0.8rem;"><i class="fas fa-eye-slash"></i> Hide</button>`
                        }
                                        <button onclick="deleteProduct('${doc.id}')" class="delete-btn" style="padding: 5px 10px; font-size: 0.8rem; margin-left: 5px;">
                                            <i class="fas fa-trash"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    `;
                });
                container.innerHTML = html || '<p>No items match filter.</p>';

            } catch (error) {
                console.error("Feed Error", error);
                container.innerHTML = `<p class="error-text">Feed Error: ${error.message}</p>`;
            }
        }

        // 7. Actions (Approve/Reject/Suspend)
        async function adminAction(userId, action) {
            const SUPER_ADMINS = ['wasslservices@gmail.com', 'wiilwaal713@gmail.com'];

            if (!confirm(`Are you sure you want to ${action} this user?`)) return;

            try {
                const userRef = db.collection('users').doc(userId);
                const doc = await userRef.get();
                if (doc.exists && SUPER_ADMINS.includes(doc.data().email)) {
                    alert("Cannot modify Super Admin.");
                    return;
                }

                if (action === 'approve') {
                    await userRef.update({ isApproved: true });
                    showToast("User Approved", "success");
                    loadPendingApprovals(); // Refresh
                    updateAdminStats();
                } else if (action === 'reject') {
                    await userRef.delete(); // Actually delete for rejection
                    showToast("User Rejected/Deleted", "info");
                    loadPendingApprovals();
                    updateAdminStats();
                } else if (action === 'suspend') {
                    await userRef.update({ isApproved: false });
                    showToast("User Suspended", "warning");
                    loadActiveBusinesses(); // Refresh list
                    updateAdminStats();
                }

            } catch (e) {
                alert("Action Failed: " + e.message);
            }
        }

        // 8. Toggle Content Status (Hide/Show)
        async function togglePostStatus(postId, newStatus) {
            try {
                await db.collection('products').doc(postId).update({
                    status: newStatus
                });
                showToast(`Product ${newStatus}`, "success");
                // Reload current view
                loadAllPostsAdmin('all');
            } catch (error) {
                alert("Update Failed: " + error.message);
            }
        }

        // Global scope expose
        window.loadAdminDashboard = loadAdminDashboard;
        window.showAdminSection = showAdminSection;
        window.adminAction = adminAction;
        window.togglePostStatus = togglePostStatus;
        window.loadAllPostsAdmin = loadAllPostsAdmin;




        // ============================================
        // PATCH: TURKISH CITIES & FORM ENHANCEMENTS
        // ============================================

        const turkeyCities = [
            "Istanbul (Europe)", "Istanbul (Asia)", "Adana", "Adıyaman", "Afyonkarahisar", "Ağrı", "Aksaray", "Amasya", "Ankara", "Antalya", "Ardahan", "Artvin", "Aydın",
            "Balıkesir", "Bartın", "Batman", "Bayburt", "Bilecik", "Bingöl", "Bitlis", "Bolu", "Burdur", "Bursa", "Çanakkale", "Çankırı", "Çorum", "Denizli", "Diyarbakır",
            "Düzce", "Edirne", "Elazığ", "Erzincan", "Erzurum", "Eskişehir", "Gaziantep", "Giresun", "Gümüşhane", "Hakkâri", "Hatay", "Iğdır", "Isparta", "İzmir",
            "Kahramanmaraş", "Karabük", "Karaman", "Kars", "Kastamonu", "Kayseri", "Kilis", "Kırıkkale", "Kırklareli", "Kırşehir", "Kocaeli", "Konya", "Kütahya",
            "Malatya", "Manisa", "Mardin", "Mersin", "Muğla", "Muş", "Nevşehir", "Niğde", "Ordu", "Osmaniye", "Rize", "Sakarya", "Samsun", "Şanlıurfa", "Siirt",
            "Sinop", "Sivas", "Şırnak", "Tekirdağ", "Tokat", "Trabzon", "Tunceli", "Uşak", "Van", "Yalova", "Yozgat", "Zonguldak"
        ].sort();

        function populateCities() {
            const selects = document.querySelectorAll('.city-select');
            selects.forEach(select => {
                // Keep the placeholder
                const placeholder = select.firstElementChild;
                select.innerHTML = '';
                if (placeholder) select.appendChild(placeholder);

                turkeyCities.forEach(city => {
                    const option = document.createElement('option');
                    option.value = city;
                    option.textContent = city;
                    select.appendChild(option);
                });
            });
        }

        // AUTO-INIT CITIES
        document.addEventListener('DOMContentLoaded', populateCities);
        // Also call now in case DOM is ready
        populateCities();


        // PATCH: SMOOTH NAVIGATION (OVERRIDE)
        window.navigateTo = function (route) {
            // Mobile Menu Fix
            const navLinks = document.getElementById('navLinks');
            if (navLinks) navLinks.classList.remove('active');

            // 1. Home Logic
            if (route === 'home' || route === '') {
                // Determine if we are already on the home page (view)
                // If the hash is empty or just #home, we are fundamentally on home.
                const currentHash = window.location.hash;

                if (!currentHash || currentHash === '#home' || currentHash === '#') {
                    // ALREADY ON HOME: Smooth scroll to top, NO RELOAD/JUMP
                    window.scrollTo({ top: 0, behavior: 'smooth' });
                    return; // Stop here
                } else {
                    // Different page/section -> Go to Home
                    window.location.hash = 'home';
                    // We let handleHashChange ensure we scroll up if needed, 
                    // but showPage('home') usually handles the view switch.
                }
            }
            // 2. Services Logic (Map to Home Anchor)
            else if (route === 'services') {
                window.location.hash = 'home#services';
            }
            // 3. Admin & Others
            else {
                window.location.hash = route;
            }
        };
        // Update Alias
        window.MapsTo = window.navigateTo;


        // PATCH: GOOGLE SHEETS SUBMIT (OVERRIDE FOR BUDGET MERGE)
        window.submitToGoogleSheets = async function (formElement, formId) {
            const submitBtn = formElement.querySelector('button[type="submit"]');
            const originalText = submitBtn.innerHTML;

            submitBtn.disabled = true;
            submitBtn.innerHTML = currentLang === 'en' ? 'Sending...' : 'جاري الإرسال...';

            const formData = new FormData(formElement);
            const params = new URLSearchParams();

            // --- Custom Logic for Min/Max Merge ---
            let minPrice = null;
            let maxPrice = null;

            formData.forEach((value, key) => {
                if (key === 'budget-min') minPrice = value;
                else if (key === 'budget-max') maxPrice = value;
                else params.append(key, value);
            });

            if (minPrice && maxPrice) {
                params.append('budget', `${minPrice} - ${maxPrice} USD`);
            } else if (minPrice) {
                params.append('budget', `Min: ${minPrice}`);
            } else if (maxPrice) {
                params.append('budget', `Max: ${maxPrice}`);
            }
            // ---------------------------------------

            params.append('formSource', formId);

            try {
                await fetch(GOOGLE_SCRIPT_URL, {
                    method: 'POST',
                    body: params,
                    mode: 'no-cors',
                    headers: { 'Content-Type': 'application/x-www-form-urlencoded' }
                });

                if (formId === 'appointmentForm') {
                    document.getElementById('successMessage').style.display = 'block';
                    setTimeout(() => { document.getElementById('successMessage').style.display = 'none'; }, 6000);
                } else {
                    alert(currentLang === 'en' ? 'Thank you! Your request was received.' : 'شكراً لك! تم استلام طلبك بنجاح.');
                }
                formElement.reset();
            } catch (error) {
                console.error('Network Error:', error);
                alert(currentLang === 'en' ? 'Connection failed.' : 'فشل الاتصال.');
            } finally {
                submitBtn.disabled = false;
                submitBtn.innerHTML = originalText;
            }
        };


        // ============================================
        // PATCH 2: LATEST OPPORTUNITIES & NAV REFINEMENT
        // ============================================

        async function loadLatestOpportunities() {
            const container = document.getElementById('latest-opportunities-grid');
            if (!container) return;

            try {
                // Fetch top 2 most recent ACTIVE products
                const snapshot = await db.collection('products')
                    .where('status', '==', 'active')
                    .orderBy('createdAt', 'desc')
                    .limit(2)
                    .get();

                if (snapshot.empty) {
                    document.getElementById('latest-opportunities').style.display = 'none';
                    return;
                }

                let html = '';
                snapshot.forEach(doc => {
                    const product = doc.data();
                    const img = product.imageUrl || 'https://via.placeholder.com/400x300?text=Wassl+Opportunity';

                    html += `
                        <div class="product-card" onclick="navigateTo('real-estate')" style="cursor: pointer; transition: transform 0.3s ease;">
                            <div class="product-image" style="height: 250px;">
                                <img src="${img}" alt="${product.title}" style="width: 100%; height: 100%; object-fit: cover;">
                            </div>
                            <div class="product-content">
                                <span class="product-category" style="position: absolute; top: 1rem; right: 1rem; background: var(--secondary); color: var(--dark);">${getCategoryName(product.category)}</span>
                                <h3 class="product-title">${product.title}</h3>
                                <p class="product-description">${product.description.substring(0, 80)}...</p>
                                <div class="product-footer">
                                    <div class="product-price" style="font-size: 1.2rem; color: var(--primary);">$${product.price}</div>
                                    <span style="color: var(--text-light);"><i class="fas fa-arrow-right"></i></span>
                                </div>
                            </div>
                        </div>
                    `;
                });
                container.innerHTML = html;

            } catch (error) {
                console.error("Latest Opps Error:", error);
                container.innerHTML = `<p style="color: #64748b;">Unable to load opportunities.</p>`;
            }
        }

        // AUTO-INIT OPPORTUNITIES
        document.addEventListener('DOMContentLoaded', loadLatestOpportunities);
        loadLatestOpportunities();

        // RE-PATCH NAVIGATE TO FOR HISTORY PUSHSTATE (NO JUMPS)
        window.mainNavigateTo = window.navigateTo; // Save previous logic if needed

        window.navigateTo = function (route) {
            // Mobile Menu Fix
            const navLinks = document.getElementById('navLinks');
            if (navLinks) navLinks.classList.remove('active');

            // 1. Home Logic
            if (route === 'home' || route === '') {
                // Use PushState to change URL without triggering hashchange jump
                if (window.location.hash !== '#home' && window.location.hash !== '') {
                    history.pushState(null, null, '#home');
                }

                // Show Home Section
                showPage('home'); // Ensure home is visible

                // SMOTH SCROLL TO TOP
                window.scrollTo({
                    top: 0,
                    behavior: 'smooth'
                });
            }
            // 2. Services Logic (Map to Home Anchor)
            else if (route === 'services') {
                history.pushState(null, null, '#home#services');
                showPage('home');
                setTimeout(() => scrollToSection('services'), 100);
            }
            // 3. Admin & Others
            else {
                window.location.hash = route;
            }
        };
        // Update Alias
        window.MapsTo = window.navigateTo;


        // ============================================
        // PATCH 3: FEED PAGE & QUERY FIX (NO INDEX REQUIRED)
        // ============================================

        // 1. ADD NEW TRANSLATIONS DYNAMICALLY
        if (translations.ar) {
            translations.ar.allOppTitle = "جميع الفرص";
            translations.allOppSubtitle = "استكشف أحدث القوائم والعروض لدينا.";
        }
        if (translations.en) {
            translations.en.allOppTitle = "All Opportunities";
            translations.en.allOppSubtitle = "Explore our latest listings and offers.";
            translations.en.latestOppTitle = "Latest Opportunities";
            translations.en.latestOppSubtitle = "Fresh listings just for you";
            translations.en.seeAllBtn = "See All";
        }

        // 2. FIX: LOAD LATEST (CLIENT-SIDE FILTER TO AVOID INDEX ERROR)
        window.loadLatestOpportunities = async function () {
            const container = document.getElementById('latest-opportunities-grid');
            if (!container) return;

            // Re-bind button to correct route
            const seeAllBtn = document.querySelector('[data-key="seeAllBtn"]');
            if (seeAllBtn && seeAllBtn.parentElement) {
                seeAllBtn.parentElement.setAttribute('onclick', "navigateTo('opportunities')");
            }

            try {
                // Fetch top 50 recent items to ensure we find 2 active ones
                const snapshot = await db.collection('products')
                    .orderBy('createdAt', 'desc')
                    .limit(50)
                    .get();

                if (snapshot.empty) {
                    document.getElementById('latest-opportunities').style.display = 'none';
                    return;
                }

                let html = '';
                let count = 0;

                // Client-side Filter for 'active'
                for (const doc of snapshot.docs) {
                    if (count >= 2) break; // We only want 2
                    const product = doc.data();

                    if (product.status === 'active') {
                        const img = product.imageUrl || 'https://via.placeholder.com/400x300?text=Wassl+Opportunity';

                        html += `
                        <div class="product-card" onclick="navigateTo('opportunities')" style="cursor: pointer;">
                            <div class="product-image" style="height: 250px;">
                                <img src="${img}" alt="${product.title}" style="width: 100%; height: 100%; object-fit: cover;">
                            </div>
                            <div class="product-content">
                                <span class="product-category" style="position: absolute; top: 1rem; right: 1rem; background: var(--secondary); color: var(--dark);">${getCategoryName(product.category)}</span>
                                <h3 class="product-title">${product.title}</h3>
                                <p class="product-description">${product.description.substring(0, 80)}...</p>
                                <div class="product-footer">
                                    <div class="product-price" style="font-size: 1.2rem; color: var(--primary);">$${product.price}</div>
                                </div>
                            </div>
                        </div>
                        `;
                        count++;
                    }
                }

                if (count === 0) {
                    // No active items found in top 50
                    const heroSection = document.getElementById('latest-opportunities');
                    if (heroSection) heroSection.style.display = 'none';
                    container.innerHTML = '<p style="color:#64748b">No active opportunities.</p>';
                } else {
                    const heroSection = document.getElementById('latest-opportunities');
                    if (heroSection) heroSection.style.display = 'block';
                    container.innerHTML = html;
                }

            } catch (error) {
                console.error("Latest Opps Error:", error);
                container.innerHTML = `<p style="color: #64748b;">Unable to load opportunities (Network/Auth).</p>`;
            }
        };

        // 3. LOAD ALL OPPORTUNITIES (FEED PAGE)
        window.loadAllOpportunities = async function () {
            const container = document.getElementById('all-opportunities-grid');
            if (!container) return;
            container.innerHTML = '<div class="loading-spinner"><i class="fas fa-spinner fa-spin"></i> Loading all offers...</div>';

            try {
                // Fetch top 50 recent
                const snapshot = await db.collection('products')
                    .orderBy('createdAt', 'desc')
                    .limit(50)
                    .get();

                if (snapshot.empty) {
                    container.innerHTML = '<div class="empty-state"><p>No opportunities found.</p></div>';
                    return;
                }

                let html = '';
                snapshot.docs.forEach(doc => {
                    const product = doc.data();
                    if (product.status === 'active') { // Client-side check
                        const img = product.imageUrl || 'https://via.placeholder.com/400x300?text=Wassl+Opportunity';
                        html += `
                        <div class="product-card">
                            <div class="product-image" style="height: 200px;">
                                <img src="${img}" alt="${product.title}" style="width: 100%; height: 100%; object-fit: cover;">
                            </div>
                            <div class="product-content">
                                <div class="product-header">
                                    <h3 class="product-title">${product.title}</h3>
                                    <span class="product-category">${getCategoryName(product.category)}</span>
                                </div>
                                <p class="product-description">${product.description}</p>
                                <div class="product-footer">
                                    <div class="product-price">$${product.price}</div>
                                    <button class="auth-btn secondary" onclick="showContactModal('${product.title}')" style="font-size: 0.8rem; padding: 0.3rem 0.8rem;">
                                        ${currentLang === 'ar' ? 'تواصل معنا' : 'Contact Us'}
                                    </button>
                                </div>
                            </div>
                        </div>`;
                    }
                });
                container.innerHTML = html || '<p>No active listings.</p>';

            } catch (error) {
                container.innerHTML = `<p class="error-text">Error: ${error.message}</p>`;
            }
        };

        // ============================================
        // FIXED: Navigation & Service Posts
        // ============================================

        window.loadServicePosts = async function (category, containerId) {
            const container = document.getElementById(containerId);
            if (!container) return;

            container.innerHTML = '<div class="loading-spinner"><i class="fas fa-spinner fa-spin"></i> Loading...</div>';

            try {
                // Fetch latest 20 items to ensure we find 4 active ones
                const snapshot = await db.collection('products')
                    .where('category', '==', category)
                    .orderBy('createdAt', 'desc')
                    .limit(20)
                    .get();

                let html = `
                    <div style="display: flex; justify-content: space-between; align-items: flex-end; margin-top: 3rem; margin-bottom: 1.5rem;">
                        <div>
                            <h3 class="section-title" style="font-size: 1.5rem; margin-bottom: 0.5rem;">Latest ${category.charAt(0).toUpperCase() + category.slice(1)} Opportunities</h3>
                        </div>
                        <button onclick="navigateTo('opportunities')" class="auth-btn secondary" style="border-radius: 30px; padding: 0.4rem 1.2rem; font-size: 0.9rem;">
                            See All <i class="fas fa-arrow-right"></i>
                        </button>
                    </div>
                    <div class="products-grid" style="grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));">
                `;

                let count = 0;

                snapshot.forEach(doc => {
                    if (count >= 4) return;

                    const p = doc.data();
                    // Filter for active posts only
                    if (p.status !== 'active') return;

                    count++;
                    const timeAgo = formatTimeAgo(p.createdAt ? p.createdAt.toDate() : new Date());

                    html += `
                        <div class="product-card">
                            <div class="product-image">
                                <span class="product-tag">${p.type || 'Offer'}</span>
                                <img src="${p.imageUrl || 'https://via.placeholder.com/300'}" alt="${p.title}">
                                <button class="favorite-btn" onclick="toggleFavorite('${doc.id}')">
                                    <i class="far fa-heart"></i>
                                </button>
                            </div>
                            <div class="product-details">
                                <div class="product-meta">
                                    <span><i class="far fa-clock"></i> ${timeAgo}</span>
                                    <span><i class="fas fa-tag"></i> ${p.price ? '$' + p.price : 'Contact us'}</span>
                                </div>
                                <h3 class="product-title">${p.title}</h3>
                                <p class="product-description">${p.description ? p.description.substring(0, 80) + '...' : ''}</p>
                                <button onclick="showContactModal('${doc.id}', '${p.whatsapp || ''}')" class="contact-btn">
                                    Contact <i class="fab fa-whatsapp"></i>
                                </button>
                            </div>
                        </div>
                    `;
                });

                html += '</div>';

                if (count === 0) {
                    container.innerHTML = ''; // Hide if no active posts
                } else {
                    container.innerHTML = html;
                }

            } catch (error) {
                console.error(`Error loading posts for ${category}:`, error);
                container.innerHTML = '';
            }
        };

        // Redefine navigateTo completely
        const originalNavigateTo = window.navigateTo || function () { }; // Safety fallback

        window.navigateTo = function (route) {
            console.log('Navigating to:', route);

            // Mobile Menu Fix
            const navLinks = document.getElementById('navLinks');
            if (navLinks) navLinks.classList.remove('active');

            // Handle Dashboard Routes First
            if (route.includes('dashboard') || route === 'pending-approval') {
                document.querySelectorAll('.service-page').forEach(p => p.classList.remove('active'));
                document.querySelectorAll('.dashboard-section').forEach(p => p.style.display = 'none');

                const dashPage = document.getElementById(`${route}-page`) || document.getElementById(route);
                if (dashPage) dashPage.style.display = 'block';
                return;
            }

            // Handle service routes specifically
            const serviceRoutes = ['real-estate', 'tourism', 'student', 'medical', 'business', 'other'];

            if (serviceRoutes.includes(route)) {
                history.pushState(null, null, `#${route}`);

                // 1. Reset everything
                document.querySelectorAll('.service-page').forEach(p => p.classList.remove('active'));
                document.querySelectorAll('.dashboard-section').forEach(p => p.style.display = 'none');

                // 2. Show Services Hub (Parent Container)
                const hub = document.getElementById('services-hub-page');
                if (hub) hub.classList.add('active');

                // 3. Update Service Tabs
                document.querySelectorAll('.service-tab').forEach(tab => {
                    tab.classList.remove('active');
                    if (tab.getAttribute('onclick').includes(route)) {
                        tab.classList.add('active');
                    }
                });

                // 4. Show Specific Service Content & Hide Others
                document.querySelectorAll('.service-content').forEach(p => p.style.display = 'none');

                const targetPage = document.getElementById(`${route}-page`);
                if (targetPage) {
                    targetPage.style.display = 'block';

                    const container = document.getElementById('services-container');
                    if (container) container.style.display = 'block';

                    // 5. Scroll to Top of Service Section
                    setTimeout(() => {
                        const headerOffset = 100; // Adjust for sticky header
                        const elementPosition = targetPage.getBoundingClientRect().top;
                        const offsetPosition = elementPosition + window.pageYOffset - headerOffset;

                        window.scrollTo({
                            top: offsetPosition,
                            behavior: "smooth"
                        });
                    }, 100);

                    // 6. Load Latest Posts for this Service
                    loadServicePosts(route, `latest-${route}-posts`);
                }
                return;
            }

            if (route === 'opportunities') {
                history.pushState(null, null, '#opportunities');

                // 1. Hide Top Level Pages
                document.querySelectorAll('.service-page').forEach(p => p.classList.remove('active'));
                document.querySelectorAll('.dashboard-section').forEach(p => p.style.display = 'none');

                // 2. Show Services Hub (Parent Container)
                const hub = document.getElementById('services-hub-page');
                if (hub) hub.classList.add('active');

                // 3. Hide all specific service contents
                document.querySelectorAll('.service-content').forEach(p => p.style.display = 'none');

                // 4. Show Opportunities Content
                const container = document.getElementById('services-container');
                if (container) container.style.display = 'block';

                const page = document.getElementById('opportunities-page');
                if (page) {
                    page.style.display = 'block';
                    page.classList.add('active');
                    loadAllOpportunities();

                    // Smooth scroll to it
                    setTimeout(() => {
                        window.scrollTo({ top: container.offsetTop - 100, behavior: 'smooth' });
                    }, 100);
                }
                return;
            }

            // 7. Handle Home Anchor Links (e.g. home#appointments)
            if (route.startsWith('home#')) {
                const anchor = route.split('#')[1];

                // Show Home Page
                history.pushState(null, null, `#${anchor}`);
                document.querySelectorAll('.service-page').forEach(p => p.classList.remove('active'));
                document.querySelectorAll('.dashboard-section').forEach(p => p.style.display = 'none');
                document.getElementById('home-page').classList.add('active');

                // Scroll to Anchor
                setTimeout(() => {
                    const el = document.getElementById(anchor);
                    if (el) {
                        const headerOffset = 100;
                        const elementPosition = el.getBoundingClientRect().top;
                        const offsetPosition = elementPosition + window.pageYOffset - headerOffset;
                        window.scrollTo({
                            top: offsetPosition,
                            behavior: "smooth"
                        });
                    }
                }, 100);
                return;
            }

            // Fallback for standard routes (home, etc)
            if (route === 'home') {
                // If we are already on home page (active), just scroll to top smoothly
                const homePage = document.getElementById('home-page');
                if (homePage.classList.contains('active')) {
                    window.scrollTo({ top: 0, behavior: 'smooth' });
                    history.pushState(null, null, ' ');
                    return;
                }

                history.pushState(null, null, ' ');
                document.querySelectorAll('.service-page').forEach(p => p.classList.remove('active'));
                document.querySelectorAll('.dashboard-section').forEach(p => p.style.display = 'none');
                homePage.classList.add('active');
                window.scrollTo(0, 0);
                return;
            }

            if (route === 'services') {
                history.pushState(null, null, '#services');

                // Show Home Page
                document.querySelectorAll('.service-page').forEach(p => p.classList.remove('active'));
                document.querySelectorAll('.dashboard-section').forEach(p => p.style.display = 'none');

                const homePage = document.getElementById('home-page');
                homePage.classList.add('active');

                // Scroll to Services Section on Home Page
                const servicesSection = document.getElementById('services');
                if (servicesSection) {
                    setTimeout(() => {
                        const headerOffset = 100;
                        const elementPosition = servicesSection.getBoundingClientRect().top;
                        const offsetPosition = elementPosition + window.pageYOffset - headerOffset;
                        window.scrollTo({
                            top: offsetPosition,
                            behavior: "smooth"
                        });
                    }, 100);
                }
                return;
            }
        };
        window.MapsTo = window.navigateTo;

        // ============================================
        // FIX: OVERRIDE LEGACY FUNCTIONS TO PREVENT CRASHES
        // ============================================
        window.handleHashChange = function () { console.log("Legacy hash change ignored."); };
        window.showPage = function (p) { navigateTo(p); };
        window.showServicePage = function (p) { navigateTo(p); };
        window.scrollToSection = function (id) { navigateTo('home#' + id); };

        // Force initial route check
        setTimeout(() => {
            const hash = window.location.hash.replace('#', '');
            if (hash) navigateTo(hash);
        }, 100);

        // Force Reload Latest with new Logic
        loadLatestOpportunities();


        // ============================================
        // MISSING FUNCTIONS (MOBILE & DASHBOARD FIX)
        // ============================================
        function toggleMenu() {
            const nav = document.getElementById('navLinks');
            const auth = document.getElementById('mobileAuth');
            if (nav) nav.classList.toggle('active');
            // If we have separate mobile auth container logic, toggle it too
            // But usually just navLinks is enough if CSS is correct
        }

        function showDashboard() {
            if (!currentUser) return;

            if (userRole === 'business') {
                navigateTo('business-dashboard');
            } else if (userRole === 'admin') {
                navigateTo('admin-dashboard');
            } else {
                navigateTo('customer-dashboard');
            }
        }

        // Ensure showContactModal is globally accessible
        window.showContactModal = function (productTitle) {
            // Navigate to appointments
            navigateTo('home#appointments');

            // Pre-fill message after small delay to allow scroll/render
            setTimeout(() => {
                const messageBox = document.getElementById('message');
                if (messageBox) {
                    messageBox.value = `I am interested in: ${productTitle}. Please contact me.`;
                    messageBox.focus();
                }
            }, 500);
        };

        // 6. INITIALIZATION & EVENT LISTENERS
        window.addEventListener('load', function () {
            const hash = window.location.hash.replace('#', '');
            if (hash) {
                navigateTo(hash);
            } else {
                // Default load
                loadLatestOpportunities();
            }
        });

        window.addEventListener('popstate', function () {
            const hash = window.location.hash.replace('#', '');
            if (hash) {
                navigateTo(hash);
            } else {
                navigateTo('home');
            }
        });

    </script>
</body>

</html>
